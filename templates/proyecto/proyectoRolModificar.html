{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Modificar Rol</title>
    <link rel="stylesheet" type="text/css" href="{% static 'css/proyectoRolModificar.css' %}">
</head>
<body>
{{ mensaje }}
    <style> body{background-color: lavender }</style>
    <section>
        <form action="/proyecto/proyectoRol/">
            <input type="submit" value="Atras" />
            <input  type="hidden" value={{proyectoid}} id="proyectoid" name="proyectoid">
        </form>
        <form action="." method="POST">{% csrf_token %}
            {{mensaje}}<br>
           <label for="roles">Seleccione un Rol a Modificar:</label>
           <select id="roles" name="roles">
           {% for r in roles %}
                <option value="{{r.id}}">{{r.nombre}}</option>
           {% endfor %}
           </select><br>
            <br><input  type="hidden" value={{proyectoid}} id="proyectoid" name="proyectoid">
           <input type='submit' name="seleccion" value="Seleccionar Rol" />
        </form>
        {% if select is not None %}

        <form action="." method="post">
            {% csrf_token %}
            <input  type="hidden" value={{proyectoid}} id="proyectoid" name="proyectoid">
            <input  type="hidden" value={{select.id}} id="rolid" name="rolid">
            <label for="Rolname">Nombre del Rol:</label><br>
            <input type="text" id="Rolname" name="nombre" value="{{select.nombre}}" required>
            <h5>Permisos:</h5>
            {%if "add_fase" in permisos%}
                    <input class="form-check-input" type="checkbox" value="1" id="permiso" name="perms" checked>
                    <label class="form-check-label" for="username">Crear Fase.</label>
            {%else%}
                    <input class="form-check-input" type="checkbox" value="1" id="permiso" name="perms">
                    <label class="form-check-label" for="username">Crear Fase.</label>
            {%endif%}<br>
            {%if "change_fase" in permisos%}
                <input class="form-check-input" type="checkbox" value="2" id="permiso" name="perms" checked>
                    <label class="form-check-label" for="username">Modificar Fase.</label>
            {%else%}
                <input class="form-check-input" type="checkbox" value="2" id="permiso" name="perms">
                    <label class="form-check-label" for="username">Modificar Fase.</label>
            {%endif%}<br>
            {%if "delete_fase" in permisos%}
                <input class="form-check-input" type="checkbox" value="3" id="permiso" name="perms" checked>
                    <label class="form-check-label" for="username">Deshabilitar Fase.</label>
            {%else%}
                <input class="form-check-input" type="checkbox" value="3" id="permiso" name="perms">
                    <label class="form-check-label" for="username">Deshabilitar Fase.</label>
            {%endif%}<br>
            {%if "view_fase" in permisos%}
                <input class="form-check-input" type="checkbox" value="4" id="permiso" name="perms" readonly checked onclick="return false;">
                    <label class="form-check-label" for="username">Ver Fase.</label>
            {%else%}
                <input class="form-check-input" type="checkbox" value="4" id="permiso" name="perms" readonly checked onclick="return false;">
                    <label class="form-check-label" for="username">Ver Fase.</label>
            {%endif%}<br>
            {%if "create_item" in permisos%}
                <input class="form-check-input" type="checkbox" value="5" id="permiso" name="perms" checked>
                    <label class="form-check-label" for="username">Crear Item.</label>
            {%else%}
                <input class="form-check-input" type="checkbox" value="5" id="permiso" name="perms">
                    <label class="form-check-label" for="username">Crear Item.</label>
            {%endif%}<br>
            {%if "aprobar_item" in permisos%}
                <input class="form-check-input" type="checkbox" value="6" id="permiso" name="perms" checked>
                    <label class="form-check-label" for="username">Aprobar Item.</label>
            {%else%}
                <input class="form-check-input" type="checkbox" value="6" id="permiso" name="perms" onclick="myFunction2(this);">
                    <label class="form-check-label" for="username">Aprobar Item.</label>
            {%endif%}<br>
            {%if "deshabilitar_item" in permisos%}
                <input class="form-check-input" type="checkbox" value="7" id="permiso" name="perms" checked>
                    <label class="form-check-label" for="username">Deshabilitar Item.</label>
            {%else%}
                <input class="form-check-input" type="checkbox" value="7" id="permiso" name="perms" onclick="myFunction2(this);">
                    <label class="form-check-label" for="username">Deshabilitar Item.</label>
            {%endif%}<br>
            {%if "reversionar_item" in permisos%}
                <input class="form-check-input" type="checkbox" value="8" id="permiso" name="perms" checked>
                    <label class="form-check-label" for="username">Reversionar Item.</label>
            {%else%}
                <input class="form-check-input" type="checkbox" value="8" id="permiso" name="perms" onclick="myFunction2(this);">
                    <label class="form-check-label" for="username">Reversionar Item.</label>
            {%endif%}<br>
            {%if "relacionar_item" in permisos%}
                <input class="form-check-input" type="checkbox" value="9" id="permiso" name="perms" checked>
                    <label class="form-check-label" for="username">Relacionar Item.</label>
            {%else%}
                <input class="form-check-input" type="checkbox" value="9" id="permiso" name="perms" onclick="myFunction2(this);">
                    <label class="form-check-label" for="username">Relacionar Item.</label>
            {%endif%}<br>
            {%if "change_item" in permisos%}
                <input class="form-check-input" type="checkbox" value="10" id="permiso" name="perms" checked>
                    <label class="form-check-label" for="username">Modificar Item.</label>
            {%else%}
                <input class="form-check-input" type="checkbox" value="10" id="permiso" name="perms" onclick="myFunction2(this);">
                    <label class="form-check-label" for="username">Modificar Item.</label>
            {%endif%}<br>
            {%if "establecer_itemPendienteAprob" in permisos%}
                <input class="form-check-input" type="checkbox" value="11" id="permiso" name="perms" checked>
                    <label class="form-check-label" for="username">Establecer Item como pendiente de aprobacion.</label>
            {%else%}
                <input class="form-check-input" type="checkbox" value="11" id="permiso" name="perms" onclick="myFunction2(this);">
                    <label class="form-check-label" for="username">Establecer Item como pendiente de aprobacion.</label>
            {%endif%}<br>
            {%if "establecer_itemDesarrollo" in permisos%}
                <input class="form-check-input" type="checkbox" value="12" id="permiso" name="perms" checked>
                    <label class="form-check-label" for="username">Establecer Item como en Desarrollo.</label>
            {%else%}
                <input class="form-check-input" type="checkbox" value="12" id="permiso" name="perms" onclick="myFunction2(this);">
                    <label class="form-check-label" for="username">Establecer Item como en Desarrollo.</label>
            {%endif%}<br>
            {%if "obtener_trazabilidadItem" in permisos%}
                <input class="form-check-input" type="checkbox" value="13" id="permiso" name="perms" checked>
                    <label class="form-check-label" for="username">Obtener trazabilidad de Item.</label>
            {%else%}
                <input class="form-check-input" type="checkbox" value="13" id="permiso" name="perms" onclick="myFunction2(this);">
                    <label class="form-check-label" for="username">Obtener trazabilidad de Item.</label>
            {%endif%}<br>
            {%if "view_item" in permisos%}
                <input class="form-check-input" type="checkbox" value="14" id="verItem" name="perms" checked onclick="return myFunction3();">
                    <label class="form-check-label" for="username">Ver Item.</label>
            {%else%}
                <input class="form-check-input" type="checkbox" value="14" id="verItem" name="perms" onclick="return myFunction3();">
                    <label class="form-check-label" for="username">Ver Item.</label>
            {%endif%}<br>
            {%if "obtener_calculoImpacto" in permisos%}
                <input class="form-check-input" type="checkbox" value="15" id="permiso" name="perms" checked>
                    <label class="form-check-label" for="username">Obtener calculo de Impacto de Item.</label>
            {%else%}
                <input class="form-check-input" type="checkbox" value="15" id="permiso" name="perms" onclick="myFunction2(this);">
                    <label class="form-check-label" for="username">Obtener calculo de Impacto de Item.</label>
            {%endif%}<br>
            {%if "create_lineaBase" in permisos%}
                <input class="form-check-input" type="checkbox" value="16" id="permiso" name="perms" checked>
                    <label class="form-check-label" for="username">Crear Linea Base.</label>
            {%else%}
                <input class="form-check-input" type="checkbox" value="16" id="permiso" name="perms"">
                    <label class="form-check-label" for="username">Crear Linea Base.</label>
            {%endif%}<br>
            {%if "romper_lineaBase" in permisos%}
                <input class="form-check-input" type="checkbox" value="17" id="permiso" name="perms" checked>
                    <label class="form-check-label" for="username">Romper Linea Base.</label>
            {%else%}
                <input class="form-check-input" type="checkbox" value="17" id="permiso" name="perms">
                    <label class="form-check-label" for="username">Romper Linea Base.</label>
            {%endif%}<br>
            {%if "solicitar_roturaLineaBase" in permisos%}
                <input class="form-check-input" type="checkbox" value="18" id="permiso" name="perms" checked>
                    <label class="form-check-label" for="username">Solicitar Rotura de Linea Base.</label>
            {%else%}
                <input class="form-check-input" type="checkbox" value="18" id="permiso" name="perms">
                    <label class="form-check-label" for="username">Solicitar Rotura de Linea Base.</label>
            {%endif%}<br>
            <br><input type="submit" name="changerol" value="Guardar" onclick="myFunction();">
        </form>
        {%endif%}
    </section>
</body>

<script>
    function myFunction2(obj) {
        var verItem = document.getElementById('verItem')
        if (obj.checked) {
            verItem.checked = true;
        }
    }
</script>
<script>
    function myFunction3() {
        var onclick = true;
        var perms = document.getElementsByTagName('input');
        for(var i = 0; i < perms.length; ++i)
        {
            if(perms[i].type === "checkbox"){
                var valor = parseInt(perms[i].value);
                if(valor > 5 && valor !== 14 && valor < 16){
                    if(perms[i].checked === true){
                        onclick = false;
                    }
                }

            }
        }
         return onclick;
    }
</script>
</html>

