<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html;charset=utf-8">
  <title>views.py</title>
  <link rel="stylesheet" href="pycco.css">
</head>
<body>
<div id='container'>
  <div id="background"></div>
  <div class='section'>
    <div class='docs'><h1>views.py</h1></div>
  </div>
  <div class='clearall'>
  <div class='section' id='section-0'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-0'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">django.shortcuts</span> <span class="kn">import</span> <span class="n">render</span><span class="p">,</span> <span class="n">redirect</span>
<span class="kn">from</span> <span class="nn">proyecto.models</span> <span class="kn">import</span> <span class="n">Proyecto</span><span class="p">,</span> <span class="n">Fase</span><span class="p">,</span> <span class="n">TipodeItem</span><span class="p">,</span> <span class="n">Item</span>
<span class="kn">from</span> <span class="nn">proyecto.views</span> <span class="kn">import</span> <span class="n">proyectoView</span><span class="p">,</span> <span class="n">faseView</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-1'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-1'>#</a>
      </div>
      <p><strong>gestionFase:</strong>
    Vista utilizada para visualizar Gestion de la Fase.
    Solicita que el usuario que realiza el request cuente
    con el permiso para ver la fase correspondiente
    y que (indirectamente) haya iniciado sesion</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">gestionFase</span><span class="p">(</span><span class="n">request</span><span class="p">):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-2'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-2'>#</a>
      </div>
      <p>ID del Proyecto</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-3'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-3'>#</a>
      </div>
      <p>Proyecto para el acceso a Gestion de Fase</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">proyectoid</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;proyectoid&#39;</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-4'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-4'>#</a>
      </div>
      <p>ID de Fase</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">proyecto</span> <span class="o">=</span> <span class="n">Proyecto</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">proyectoid</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-5'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-5'>#</a>
      </div>
      <p>Fase correspondiente</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">faseid</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;faseid&#39;</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-6'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-6'>#</a>
      </div>
      <p>Verificar que el usuario que realiza el request cuente con el 
permiso para ver la fase correspondiente o bien,
sea el gerente del proyecto.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">fase</span> <span class="o">=</span> <span class="n">Fase</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">faseid</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-7'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-7'>#</a>
      </div>
      <p>Al no contar con los permisos, niega el acceso, redirigiendo.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">has_perm</span><span class="p">(</span><span class="s2">&quot;view_fase&quot;</span><span class="p">,</span> <span class="n">fase</span><span class="p">))</span> <span class="ow">and</span> <span class="ow">not</span> <span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">has_perm</span><span class="p">(</span><span class="s2">&quot;is_gerente&quot;</span><span class="p">,</span> <span class="n">proyecto</span><span class="p">)):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-8'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-8'>#</a>
      </div>
      <p>Verifica que el estado del proyecto sea distinto a pedniente.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="k">return</span> <span class="n">redirect</span><span class="p">(</span><span class="s1">&#39;/permissionError/&#39;</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-9'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-9'>#</a>
      </div>
      <p>Si el estado del proyecto es pendiente, no accede a gestion de fase y redirige a la vista del proyecto.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">if</span> <span class="n">proyecto</span><span class="o">.</span><span class="n">estado</span> <span class="o">!=</span> <span class="s2">&quot;pendiente&quot;</span><span class="p">:</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-10'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-10'>#</a>
      </div>
      <p>Template a renderizar: gestionFase.html con parametro -&gt; proyectoid, faseid</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="k">return</span> <span class="n">redirect</span><span class="p">(</span><span class="s1">&#39;proyectoView&#39;</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="n">proyectoid</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-11'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-11'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s1">&#39;fase/gestionFase.html&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;proyectoid&#39;</span><span class="p">:</span> <span class="n">proyectoid</span><span class="p">,</span> <span class="s1">&#39;faseid&#39;</span><span class="p">:</span> <span class="n">faseid</span><span class="p">,</span> <span class="p">})</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-12'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-12'>#</a>
      </div>
      <p><strong>faseCrear:</strong>
    Vista utilizada para crear fases.
    Solicita que el usuario que realiza el
    request sea el gerente del proyecto
     y que (indirectamente) haya iniciado sesion.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">faseCrear</span><span class="p">(</span><span class="n">request</span><span class="p">):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-13'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-13'>#</a>
      </div>
      <p>POST request, captura los datos ingresados por el usuario para crear la fase.
ID del proyecto</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;POST&#39;</span><span class="p">:</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-14'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-14'>#</a>
      </div>
      <p>Proyecto en el cual crear la fase.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="n">proyectoid</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">POST</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;proyectoid&#39;</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-15'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-15'>#</a>
      </div>
      <p>Verificar que el estado del proyecto sea distinto a pendiente.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="n">proyecto</span> <span class="o">=</span> <span class="n">Proyecto</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">proyectoid</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-16'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-16'>#</a>
      </div>
      <p>Si el estado del proyecto es pendiente,
no accede a gestion de fase y redirige
a la vista del proyecto.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="k">if</span> <span class="n">proyecto</span><span class="o">.</span><span class="n">estado</span> <span class="o">!=</span> <span class="s2">&quot;pendiente&quot;</span><span class="p">:</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-17'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-17'>#</a>
      </div>
      <p>Nombre de la Fase</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>            <span class="k">return</span> <span class="n">redirect</span><span class="p">(</span><span class="s1">&#39;proyectoView&#39;</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="n">proyectoid</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-18'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-18'>#</a>
      </div>
      <p>Verificar que no exista otra fase en el 
proyecto con el mismo nombre, excluyendo a
las fases deshabilitadas.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="n">nombre</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">POST</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;nombre&#39;</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-19'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-19'>#</a>
      </div>
      <p>Si existe otra fase con el mismo nombre en el proyecto, 
volver a mostrar el formulario de creacion
de fases, emitiendo un mensaje de error.
Template a renderizar: faseCrear.html con 
parametros -&gt; proyectoid y mensaje de error.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="k">if</span> <span class="n">proyecto</span><span class="o">.</span><span class="n">fases</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">nombre</span><span class="o">=</span><span class="n">nombre</span><span class="p">)</span><span class="o">.</span><span class="n">exclude</span><span class="p">(</span><span class="n">estado</span><span class="o">=</span><span class="s2">&quot;deshabilitada&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-20'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-20'>#</a>
      </div>
      <p>Descripcion de la Fase</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>            <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s1">&#39;fase/faseCrear.html&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;proyectoid&#39;</span><span class="p">:</span> <span class="n">proyectoid</span><span class="p">,</span>
                                                           <span class="s1">&#39;mensaje&#39;</span><span class="p">:</span> <span class="s2">&quot;Lo sentimos, el nombre ya pertenece a otra fase&quot;</span>
                                                                      <span class="s2">&quot;del proyecto&quot;</span><span class="p">,</span> <span class="p">})</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-21'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-21'>#</a>
      </div>
      <p>Creacion de la fase con los datos proveidos por el usuario.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="n">descripcion</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">POST</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;descripcion&#39;</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-22'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-22'>#</a>
      </div>
      <p>Agregar la fase creada al proyecto correspondiente.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="n">fase</span> <span class="o">=</span> <span class="n">Fase</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">nombre</span><span class="o">=</span><span class="n">nombre</span><span class="p">,</span> <span class="n">descripcion</span><span class="o">=</span><span class="n">descripcion</span><span class="p">,</span> <span class="n">estado</span><span class="o">=</span><span class="s2">&quot;abierta&quot;</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-23'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-23'>#</a>
      </div>
      <p>Guardar</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="n">proyecto</span><span class="o">.</span><span class="n">fases</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">fase</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-24'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-24'>#</a>
      </div>
      <p>Redirigir a la vista del proyecto en el cual la fase fue creada.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="n">fase</span><span class="o">.</span><span class="n">save</span><span class="p">()</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-25'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-25'>#</a>
      </div>
      <p>GET request, muestra el template 
correspondiente para crear la fase.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="k">return</span> <span class="n">redirect</span><span class="p">(</span><span class="s1">&#39;proyectoView&#39;</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="n">proyectoid</span><span class="p">)</span>

    <span class="k">else</span><span class="p">:</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-26'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-26'>#</a>
      </div>
      <p>ID del proyecto correspondiente.
Proyecto en el cual crear la fase.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="n">proyectoid</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;proyectoid&#39;</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-27'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-27'>#</a>
      </div>
      <p>Verificar que el usuario sea el gerente del proyecto.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="n">proyecto</span> <span class="o">=</span> <span class="n">Proyecto</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">proyectoid</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-28'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-28'>#</a>
      </div>
      <p>Al no contar con los permisos, niega el acceso, redirigiendo.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">has_perm</span><span class="p">(</span><span class="s2">&quot;is_gerente&quot;</span><span class="p">,</span> <span class="n">proyecto</span><span class="p">)):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-29'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-29'>#</a>
      </div>
      <p>Template a renderizar: faseCrear.html con parametro -&gt; proyectoid</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>            <span class="k">return</span> <span class="n">redirect</span><span class="p">(</span><span class="s1">&#39;/permissionError/&#39;</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-30'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-30'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s1">&#39;fase/faseCrear.html&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;proyectoid&#39;</span><span class="p">:</span> <span class="n">proyectoid</span><span class="p">,</span> <span class="p">})</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-31'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-31'>#</a>
      </div>
      <p><strong>faseModificar:</strong>
    Vista utilizada para visualizar Modificar Fases.
    Solicita que el usuario que realiza el request
    cuente con los permisos para modificar fases o
     de gerente del proyecto y que
     (indirectamente) haya iniciado sesion.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">faseModificar</span><span class="p">(</span><span class="n">request</span><span class="p">):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-32'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-32'>#</a>
      </div>
      <p>GET request, muestra el template correspondiente para modificar la fase.
ID del proyecto</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;GET&#39;</span><span class="p">:</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-33'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-33'>#</a>
      </div>
      <p>Proyecto en el cual se encuentra la fase.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="n">proyectoid</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;proyectoid&#39;</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-34'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-34'>#</a>
      </div>
      <p>ID de la fase correspondiente</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="n">proyecto</span> <span class="o">=</span> <span class="n">Proyecto</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">proyectoid</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-35'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-35'>#</a>
      </div>
      <p>Fase a modificar</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="n">faseid</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;faseid&#39;</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-36'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-36'>#</a>
      </div>
      <p>Verificar que el usuario cuente con los permisos necesarios.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="n">fase</span> <span class="o">=</span> <span class="n">Fase</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">faseid</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-37'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-37'>#</a>
      </div>
      <p>Al no contar con los permisos, niega el acceso, redirigiendo.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">has_perm</span><span class="p">(</span><span class="s2">&quot;change_fase&quot;</span><span class="p">,</span> <span class="n">fase</span><span class="p">))</span> <span class="ow">and</span> <span class="ow">not</span> <span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">has_perm</span><span class="p">(</span><span class="s2">&quot;is_gerente&quot;</span><span class="p">,</span> <span class="n">proyecto</span><span class="p">)):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-38'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-38'>#</a>
      </div>
      <p>Verificar que el estado del proyecto sea distinto a pendiente.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>            <span class="k">return</span> <span class="n">redirect</span><span class="p">(</span><span class="s1">&#39;/permissionError/&#39;</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-39'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-39'>#</a>
      </div>
      <p>Si el estado del proyecto es pendiente,
 no accede al formulario de modificacion de fase 
 y redirige a gestion de Fase.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="k">if</span> <span class="n">proyecto</span><span class="o">.</span><span class="n">estado</span> <span class="o">!=</span> <span class="s2">&quot;pendiente&quot;</span><span class="p">:</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-40'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-40'>#</a>
      </div>
      <p>Template a renderizar: faseModificar con parametro -&gt; fase, proyectoid</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>            <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s1">&#39;fase/gestionFase.html&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;proyectoid&#39;</span><span class="p">:</span> <span class="n">proyectoid</span><span class="p">,</span> <span class="s1">&#39;faseid&#39;</span><span class="p">:</span> <span class="n">faseid</span><span class="p">,</span>
                                                             <span class="s1">&#39;mensaje&#39;</span><span class="p">:</span> <span class="s2">&quot;No se puede modificar la fase, el proyecto&quot;</span>
                                                                        <span class="s2">&quot; no se encuentra en estado pendiente.&quot;</span><span class="p">})</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-41'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-41'>#</a>
      </div>
      <p>POST request, captura la informacion para actualizar los datos de la fase.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s1">&#39;fase/faseModificar.html&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;fase&#39;</span><span class="p">:</span> <span class="n">fase</span><span class="p">,</span> <span class="s1">&#39;proyectoid&#39;</span><span class="p">:</span> <span class="n">proyectoid</span><span class="p">,</span> <span class="p">})</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-42'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-42'>#</a>
      </div>
      <p>Nuevo nombre de fase.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-43'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-43'>#</a>
      </div>
      <p>Nueva descripcion de fase</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">nombre</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">POST</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;nombre&#39;</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-44'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-44'>#</a>
      </div>
      <p>ID del proyecto en el que se encuentra la fase.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">descripcion</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">POST</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;descripcion&#39;</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-45'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-45'>#</a>
      </div>
      <p>Proyecto en el que se enuentra la fase.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">proyectoid</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">POST</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;proyectoid&#39;</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-46'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-46'>#</a>
      </div>
      <p>ID de la fase a modificar</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">proyecto</span> <span class="o">=</span> <span class="n">Proyecto</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">proyectoid</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-47'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-47'>#</a>
      </div>
      <p>Fase a modificar</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">faseid</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">POST</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;faseid&#39;</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-48'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-48'>#</a>
      </div>
      <p>Verificar que no exista otra fase en el proyecto 
con el mismo nombre, excluyendo a
las fases deshabilitadas y a la fase correspondiente a modificar, 
en caso de que el nombre se mantenga.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">fase</span> <span class="o">=</span> <span class="n">Fase</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">faseid</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-49'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-49'>#</a>
      </div>
      <p>Si existe otra fase con el mismo nombre en el proyecto, 
volver a mostrar el formulario de modificacion
de fases, emitiendo un mensaje de error.
Template a renderizar: faseModificar.html 
con parametros -&gt; proyectoid y mensaje de error.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">if</span> <span class="n">proyecto</span><span class="o">.</span><span class="n">fases</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">nombre</span><span class="o">=</span><span class="n">nombre</span><span class="p">)</span><span class="o">.</span><span class="n">exclude</span><span class="p">(</span><span class="n">estado</span><span class="o">=</span><span class="s2">&quot;deshabilitada&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">exclude</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">faseid</span><span class="p">)</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-50'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-50'>#</a>
      </div>
      <p>Actualizar nombre de fase</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s1">&#39;fase/faseModificar.html&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;fase&#39;</span><span class="p">:</span> <span class="n">fase</span><span class="p">,</span> <span class="s1">&#39;proyectoid&#39;</span><span class="p">:</span> <span class="n">proyectoid</span><span class="p">,</span>
                                                           <span class="s1">&#39;mensaje&#39;</span><span class="p">:</span> <span class="s2">&quot;Lo sentimos, el nombre ya pertenece a otra fase&quot;</span>
                                                                      <span class="s2">&quot;del proyecto.&quot;</span><span class="p">,</span> <span class="p">})</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-51'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-51'>#</a>
      </div>
      <p>Actualizar descripcion de fase</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">fase</span><span class="o">.</span><span class="n">nombre</span> <span class="o">=</span> <span class="n">nombre</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-52'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-52'>#</a>
      </div>
      <p>Guardar</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">fase</span><span class="o">.</span><span class="n">descripcion</span> <span class="o">=</span> <span class="n">descripcion</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-53'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-53'>#</a>
      </div>
      <p>Template a renderizar: gestionFase con parametro -&gt; proyectoid, faseid</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">fase</span><span class="o">.</span><span class="n">save</span><span class="p">()</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-54'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-54'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s1">&#39;fase/gestionFase.html&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;proyectoid&#39;</span><span class="p">:</span> <span class="n">proyectoid</span><span class="p">,</span> <span class="s1">&#39;faseid&#39;</span><span class="p">:</span> <span class="n">faseid</span><span class="p">,</span> <span class="p">})</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-55'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-55'>#</a>
      </div>
      <pre><code>   **faseDeshabilitar:**
    Vista utilizada para Deshabilitar Fases.
    Solicita que el usuario que realiza el request
    cuente con los permisos para deshabilitar fases o
     de gerente del proyecto y que
     (indirectamente) haya iniciado sesion.
</code></pre>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">faseDeshabilitar</span><span class="p">(</span><span class="n">request</span><span class="p">):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-56'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-56'>#</a>
      </div>
      <p>ID del proyecto
Proyecto en el cual se encuentra la fase.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">proyectoid</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;proyectoid&#39;</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-57'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-57'>#</a>
      </div>
      <p>ID de fase.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">proyecto</span> <span class="o">=</span> <span class="n">Proyecto</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">proyectoid</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-58'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-58'>#</a>
      </div>
      <p>Fase a deshabilitar.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">faseid</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;faseid&#39;</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-59'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-59'>#</a>
      </div>
      <p>Verificar que el usuario cuente con los permisos necesarios.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">fase</span> <span class="o">=</span> <span class="n">Fase</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">faseid</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-60'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-60'>#</a>
      </div>
      <p>Al no contar con los permisos, niega el acceso, redirigiendo.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">has_perm</span><span class="p">(</span><span class="s2">&quot;delete_fase&quot;</span><span class="p">,</span> <span class="n">fase</span><span class="p">))</span> <span class="ow">and</span> <span class="ow">not</span> <span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">has_perm</span><span class="p">(</span><span class="s2">&quot;is_gerente&quot;</span><span class="p">,</span> <span class="n">proyecto</span><span class="p">)):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-61'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-61'>#</a>
      </div>
      <p>Verificar que el estado del proyecto sea distinto a pendiente.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="k">return</span> <span class="n">redirect</span><span class="p">(</span><span class="s1">&#39;/permissionError/&#39;</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-62'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-62'>#</a>
      </div>
      <p>Si el estado del proyecto es pendiente,
no accede al formulario de modificacion de fase y 
redirige a gestion de Fase.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">if</span> <span class="n">proyecto</span><span class="o">.</span><span class="n">estado</span> <span class="o">!=</span> <span class="s2">&quot;pendiente&quot;</span><span class="p">:</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-63'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-63'>#</a>
      </div>
      <p>Establecer el estado de la fase como deshabilitada.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s1">&#39;fase/gestionFase.html&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;proyectoid&#39;</span><span class="p">:</span> <span class="n">proyectoid</span><span class="p">,</span> <span class="s1">&#39;faseid&#39;</span><span class="p">:</span> <span class="n">faseid</span><span class="p">,</span>
                                                         <span class="s1">&#39;mensaje&#39;</span><span class="p">:</span> <span class="s2">&quot;No se puede deshabilitar la fase,&quot;</span>
                                                                    <span class="s2">&quot; el proyecto no se encuentra en estado pendiente.&quot;</span><span class="p">})</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-64'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-64'>#</a>
      </div>
      <p>Guardar</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">fase</span><span class="o">.</span><span class="n">estado</span> <span class="o">=</span> <span class="s2">&quot;deshabilitada&quot;</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-65'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-65'>#</a>
      </div>
      <p>Redirigir a la vista del proyecto correspondiente.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">fase</span><span class="o">.</span><span class="n">save</span><span class="p">()</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-66'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-66'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">return</span> <span class="n">redirect</span><span class="p">(</span><span class="s1">&#39;proyectoView&#39;</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="n">proyectoid</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-67'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-67'>#</a>
      </div>
      <pre><code>       **itemCrear:**
        Vista utilizada para Crear Items.
        Solicita que el usuario que realiza el request
        cuente con los permisos para crear items o
         de gerente del proyecto y que
         (indirectamente) haya iniciado sesion.
</code></pre>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">itemCrear</span><span class="p">(</span><span class="n">request</span><span class="p">):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-68'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-68'>#</a>
      </div>
      <p>POST request, recibe los datos ingresados por el usuario para la creacion del item.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">seleccion</span><span class="o">=</span> <span class="kc">None</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-69'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-69'>#</a>
      </div>
      <p>Consulta si el post recibido es el de la selecci√≥n de 
un Tipo de Item o el post para crear el item correspondiente.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">method</span><span class="o">==</span><span class="s2">&quot;POST&quot;</span><span class="p">:</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-70'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-70'>#</a>
      </div>
      <p>ID del proyecto en el cual crear el item.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="k">if</span> <span class="s1">&#39;crear&#39;</span> <span class="ow">in</span> <span class="n">request</span><span class="o">.</span><span class="n">POST</span><span class="p">:</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-71'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-71'>#</a>
      </div>
      <p>ID de la fase en la cual crear el item.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>            <span class="n">proyectoid</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">POST</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;proyectoid&#39;</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-72'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-72'>#</a>
      </div>
      <p>Proyecto en el cual crear el item.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>            <span class="n">faseid</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">POST</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;faseid&#39;</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-73'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-73'>#</a>
      </div>
      <p>Fase en la cual crear el item.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>            <span class="n">proyecto</span> <span class="o">=</span> <span class="n">Proyecto</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">proyectoid</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-74'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-74'>#</a>
      </div>
      <p>Recibe el POST con los datos del formulario para la creacion del Item.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>            <span class="n">fase</span> <span class="o">=</span> <span class="n">Fase</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">faseid</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-75'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-75'>#</a>
      </div>
      <p>Tipo de item establecido para el item.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>            <span class="n">dato</span><span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">POST</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-76'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-76'>#</a>
      </div>
      <p>Verifica que no exista otro item con el mismo nombre en la fase, 
excluyendo a los items
 deshabilitados.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>            <span class="n">obj</span> <span class="o">=</span> <span class="n">proyecto</span><span class="o">.</span><span class="n">tipoItem</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">dato</span><span class="p">[</span><span class="s1">&#39;tipodeitem_id&#39;</span><span class="p">])</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-77'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-77'>#</a>
      </div>
      <p>En el caso de que ya exista un item con el mismo nombre
 en la fase, se vuelve a mostrar el
formulario de creacion de item con un mensaje de error.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>            <span class="k">if</span> <span class="n">fase</span><span class="o">.</span><span class="n">items</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">nombre</span><span class="o">=</span><span class="n">dato</span><span class="p">[</span><span class="s1">&#39;nombre&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">exclude</span><span class="p">(</span><span class="n">estado</span><span class="o">=</span><span class="s2">&quot;deshabilitado&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-78'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-78'>#</a>
      </div>
      <p>Se obtiene todos los tios de item del proyecto.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>                <span class="n">tipos</span> <span class="o">=</span> <span class="n">proyecto</span><span class="o">.</span><span class="n">tipoItem</span><span class="o">.</span><span class="n">all</span><span class="p">()</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-79'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-79'>#</a>
      </div>
      <p>Template a renderizar: itemCrear.html 
con parametros -&gt; proyectoid, faseid, tipos de item, 
seleccion de tipo de item y mensaje de error.</p>
<p>Creacion del item con los datos proveidos por el usuario.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>                <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s2">&quot;item/itemCrear.html&quot;</span><span class="p">,</span>
                              <span class="p">{</span><span class="s1">&#39;proyectoid&#39;</span><span class="p">:</span> <span class="n">proyectoid</span><span class="p">,</span> <span class="s1">&#39;faseid&#39;</span><span class="p">:</span> <span class="n">faseid</span><span class="p">,</span> <span class="s1">&#39;tipos&#39;</span><span class="p">:</span> <span class="n">tipos</span><span class="p">,</span> <span class="s1">&#39;select&#39;</span><span class="p">:</span> <span class="n">seleccion</span><span class="p">,</span>
                               <span class="s1">&#39;mensaje&#39;</span><span class="p">:</span> <span class="s2">&quot;Lo sentimos, el nombre ya pertenece a otro item en la fase.&quot;</span><span class="p">})</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-80'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-80'>#</a>
      </div>
      <p>Estado del item predefinido en la creacion igual a en desarrollo.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>            <span class="n">item</span> <span class="o">=</span> <span class="n">Item</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">tipoItem</span><span class="o">=</span><span class="n">obj</span><span class="p">,</span> <span class="n">nombre</span><span class="o">=</span><span class="n">dato</span><span class="p">[</span><span class="s1">&#39;nombre&#39;</span><span class="p">],</span> <span class="n">fecha</span><span class="o">=</span><span class="n">dato</span><span class="p">[</span><span class="s1">&#39;fecha&#39;</span><span class="p">],</span>
                                       <span class="n">observacion</span><span class="o">=</span><span class="n">dato</span><span class="p">[</span><span class="s1">&#39;observacion&#39;</span><span class="p">],</span> <span class="n">costo</span><span class="o">=</span><span class="n">dato</span><span class="p">[</span><span class="s1">&#39;costo&#39;</span><span class="p">])</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-81'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-81'>#</a>
      </div>
      <p>Almacenar la informacion de cada campo extra proveido por el usuario.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>            <span class="n">item</span><span class="o">.</span><span class="n">estado</span> <span class="o">=</span> <span class="s2">&quot;en desarrollo&quot;</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-82'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-82'>#</a>
      </div>
      <p>Guardar.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>            <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">obj</span><span class="o">.</span><span class="n">campo_extra</span><span class="p">:</span>
                <span class="n">item</span><span class="o">.</span><span class="n">campo_extra_valores</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dato</span><span class="p">[</span><span class="n">c</span><span class="p">])</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-83'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-83'>#</a>
      </div>
      <p>Agregar item a fase.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>            <span class="n">item</span><span class="o">.</span><span class="n">save</span><span class="p">()</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-84'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-84'>#</a>
      </div>
      <p>Redirigir a la vista de la fase correspondiente.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>            <span class="n">fase</span><span class="o">.</span><span class="n">items</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">item</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-85'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-85'>#</a>
      </div>
      <p>POST para seleccionar tipo de item</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>            <span class="k">return</span> <span class="n">redirect</span><span class="p">(</span><span class="s1">&#39;proyectoView&#39;</span><span class="p">,</span><span class="nb">id</span><span class="o">=</span><span class="n">proyectoid</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-86'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-86'>#</a>
      </div>
      <p>ID del proyecto correspondiente.
ID de fase correspondiente.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>            <span class="n">proyectoid</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">POST</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;proyectoid&#39;</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-87'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-87'>#</a>
      </div>
      <p>Proyeto en el cual crear el item.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>            <span class="n">faseid</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">POST</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;faseid&#39;</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-88'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-88'>#</a>
      </div>
      <p>Se asigna a la variable &ldquo;tipos&rdquo; todos los Tipos de Item 
con los que cuenta el proyecto en el cual se encuentra el usuario</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>            <span class="n">proyecto</span> <span class="o">=</span> <span class="n">Proyecto</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">proyectoid</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-89'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-89'>#</a>
      </div>
      <p>Guarda en la variable seleccion el tipo de Item seleccionado por el usuario.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>            <span class="n">tipos</span> <span class="o">=</span> <span class="n">proyecto</span><span class="o">.</span><span class="n">tipoItem</span><span class="o">.</span><span class="n">all</span><span class="p">()</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-90'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-90'>#</a>
      </div>
      <p>Template a renderizar: itemCrear.html 
con parametros -&gt; proyectoid, 
faseid, tipos de item, 
seleccion de tipo de item.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>            <span class="n">seleccion</span> <span class="o">=</span> <span class="n">TipodeItem</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">POST</span><span class="p">[</span><span class="s1">&#39;tipo&#39;</span><span class="p">])</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-91'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-91'>#</a>
      </div>
      <p>GET request, muestra el template correspondiente para la creacion de items.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>            <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s2">&quot;item/itemCrear.html&quot;</span><span class="p">,</span>
                          <span class="p">{</span><span class="s1">&#39;proyectoid&#39;</span><span class="p">:</span> <span class="n">proyectoid</span><span class="p">,</span> <span class="s1">&#39;faseid&#39;</span><span class="p">:</span> <span class="n">faseid</span><span class="p">,</span> <span class="s1">&#39;tipos&#39;</span><span class="p">:</span> <span class="n">tipos</span><span class="p">,</span> <span class="s1">&#39;select&#39;</span><span class="p">:</span> <span class="n">seleccion</span><span class="p">})</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-92'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-92'>#</a>
      </div>
      <p>ID del proyecto correspondiente.
ID de fase correspondiente.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">proyectoid</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;proyectoid&#39;</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-93'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-93'>#</a>
      </div>
      <p>Proyecto en el cual crear el item.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">faseid</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;faseid&#39;</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-94'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-94'>#</a>
      </div>
      <p>Fase en la cual crear el item.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">proyecto</span> <span class="o">=</span> <span class="n">Proyecto</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">proyectoid</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-95'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-95'>#</a>
      </div>
      <p>Verificar que el usuario cuente 
con los permisos necesarios.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">fase</span> <span class="o">=</span> <span class="n">Fase</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">faseid</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-96'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-96'>#</a>
      </div>
      <p>Al no contar con los permisos, niega el acceso, redirigiendo.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">has_perm</span><span class="p">(</span><span class="s2">&quot;create_item&quot;</span><span class="p">,</span> <span class="n">fase</span><span class="p">))</span> <span class="ow">and</span> <span class="ow">not</span> <span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">has_perm</span><span class="p">(</span><span class="s2">&quot;is_gerente&quot;</span><span class="p">,</span> <span class="n">proyecto</span><span class="p">)):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-97'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-97'>#</a>
      </div>
      <p>Verificar que el estado del proyecto sea inicializado.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="k">return</span> <span class="n">redirect</span><span class="p">(</span><span class="s1">&#39;/permissionError/&#39;</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-98'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-98'>#</a>
      </div>
      <p>En caso contrario, no permite la creacion de items y redirige a la vista de fase.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">if</span> <span class="n">proyecto</span><span class="o">.</span><span class="n">estado</span> <span class="o">!=</span> <span class="s2">&quot;inicializado&quot;</span><span class="p">:</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-99'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-99'>#</a>
      </div>
      <p>Se asigna a la variable &ldquo;tipos&rdquo; todos los Tipos de Item
con los que cuenta el proyecto en el 
cual se encuentra el usuario</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="k">return</span> <span class="n">redirect</span><span class="p">(</span><span class="s1">&#39;faseView&#39;</span><span class="p">,</span> <span class="n">faseid</span><span class="o">=</span><span class="n">faseid</span><span class="p">,</span> <span class="n">proyectoid</span><span class="o">=</span><span class="n">proyectoid</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-100'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-100'>#</a>
      </div>
      <p>Template a renderizar: itemCrear.html c
on parametros -&gt; proyectoid, faseid, tipos de item, 
seleccion de tipo de item.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">tipos</span> <span class="o">=</span> <span class="n">proyecto</span><span class="o">.</span><span class="n">tipoItem</span><span class="o">.</span><span class="n">all</span><span class="p">()</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-101'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-101'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s2">&quot;item/itemCrear.html&quot;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;proyectoid&#39;</span><span class="p">:</span> <span class="n">proyectoid</span><span class="p">,</span> <span class="s1">&#39;faseid&#39;</span><span class="p">:</span> <span class="n">faseid</span><span class="p">,</span>
                                                   <span class="s1">&#39;tipos&#39;</span><span class="p">:</span> <span class="n">tipos</span><span class="p">,</span> <span class="s1">&#39;select&#39;</span><span class="p">:</span> <span class="n">seleccion</span><span class="p">})</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-102'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-102'>#</a>
      </div>
      <p><strong>itemView:</strong>
    Vista utilizada para visualizar items.
    Solicita que el usuario que realiza el request
    cuente con el permiso para ver items en la fase
    correspondiente, o bien, sea el gerente del
    proyecto. Recibe el id de la fase y del proyecto
     en el que se encuentra ademas del id del item a ver.
    Tambien solicita que (indirectamente) el usuario
    haya iniciado sesion.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">itemView</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">itemid</span><span class="p">,</span> <span class="n">faseid</span><span class="p">,</span> <span class="n">proyectoid</span><span class="p">):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-103'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-103'>#</a>
      </div>
      <p>Fase en el cual se encuentra el item.
Proyecto en el cual se encuentra el item.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">fase</span> <span class="o">=</span> <span class="n">Fase</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">faseid</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-104'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-104'>#</a>
      </div>
      <p>Item a visualizar.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">proyecto</span> <span class="o">=</span> <span class="n">Proyecto</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">proyectoid</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-105'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-105'>#</a>
      </div>
      <p>Verificar que el usuario cuente con los permisos necesarios.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">item</span> <span class="o">=</span> <span class="n">Item</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">itemid</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-106'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-106'>#</a>
      </div>
      <p>Al no contar con los permisos, niega el acceso, redirigiendo.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">has_perm</span><span class="p">(</span><span class="s2">&quot;ver_item&quot;</span><span class="p">,</span> <span class="n">fase</span><span class="p">))</span> <span class="ow">and</span> <span class="ow">not</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">has_perm</span><span class="p">(</span><span class="s2">&quot;is_gerente&quot;</span><span class="p">,</span> <span class="n">proyecto</span><span class="p">)):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-107'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-107'>#</a>
      </div>
      <p>Template a renderizar: item.html con parametros -&gt; faseid, 
proyectoid, item, proyecto, campos extra de item,
permiso para establecer item como pendiente de aprobacion, 
permiso para establecer item como parobado y choices
con los distintos estados del item.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="k">return</span> <span class="n">redirect</span><span class="p">(</span><span class="s1">&#39;/permissionError/&#39;</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-108'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-108'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s1">&#39;item/item.html&#39;</span><span class="p">,</span>
                        <span class="p">{</span><span class="s1">&#39;faseid&#39;</span><span class="p">:</span> <span class="n">faseid</span><span class="p">,</span> <span class="s1">&#39;proyectoid&#39;</span><span class="p">:</span> <span class="n">proyectoid</span><span class="p">,</span> <span class="s1">&#39;item&#39;</span><span class="p">:</span> <span class="n">item</span><span class="p">,</span> <span class="s1">&#39;proyecto&#39;</span><span class="p">:</span> <span class="n">proyecto</span><span class="p">,</span>
                                    <span class="s1">&#39;campos&#39;</span><span class="p">:</span> <span class="nb">zip</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">tipoItem</span><span class="o">.</span><span class="n">campo_extra</span><span class="p">,</span> <span class="n">item</span><span class="o">.</span><span class="n">campo_extra_valores</span><span class="p">),</span>
                                    <span class="s1">&#39;pendientePermiso&#39;</span><span class="p">:</span> <span class="n">request</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">has_perm</span><span class="p">(</span><span class="s2">&quot;establecer_itemPendienteAprob&quot;</span><span class="p">,</span><span class="n">fase</span><span class="p">),</span>
                                    <span class="s1">&#39;aprobadoPermiso&#39;</span><span class="p">:</span> <span class="n">request</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">has_perm</span><span class="p">(</span><span class="s2">&quot;aprove_item&quot;</span><span class="p">,</span> <span class="n">fase</span><span class="p">),</span>
                                    <span class="s1">&#39;choices&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;en desarrollo&#39;</span><span class="p">,</span> <span class="s1">&#39;pendiente de aprobacion&#39;</span><span class="p">,</span> <span class="s1">&#39;aprobado&#39;</span><span class="p">,</span> <span class="p">],</span> <span class="p">})</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-109'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-109'>#</a>
      </div>
      <p><strong>gestionItem:</strong>
    Vista utilizada para visualizar Gestion del Item.
    Solicita que el usuario que realiza el request cuente
    con los permisos necesarios para ver el item correspondiente,
    o bien, los de gerente del proyecto y que (indirectamente)
     haya iniciado sesion.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">gestionItem</span><span class="p">(</span><span class="n">request</span><span class="p">):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-110'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-110'>#</a>
      </div>
      <p>ID del Proyecto</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-111'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-111'>#</a>
      </div>
      <p>Proyecto para el acceso a Gestion de Item</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">proyectoid</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;proyectoid&#39;</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-112'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-112'>#</a>
      </div>
      <p>ID de fase.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">proyecto</span> <span class="o">=</span> <span class="n">Proyecto</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">proyectoid</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-113'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-113'>#</a>
      </div>
      <p>Fase correspindiente.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">faseid</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;faseid&#39;</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-114'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-114'>#</a>
      </div>
      <p>Verificar que el usuario cuente con los permisos necesarios.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">fase</span> <span class="o">=</span> <span class="n">Fase</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">faseid</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-115'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-115'>#</a>
      </div>
      <p>Al no contar con los permisos, niega el acceso, redirigiendo.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">has_perm</span><span class="p">(</span><span class="s2">&quot;ver_item&quot;</span><span class="p">,</span> <span class="n">fase</span><span class="p">))</span> <span class="ow">and</span> <span class="ow">not</span> <span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">has_perm</span><span class="p">(</span><span class="s2">&quot;is_gerente&quot;</span><span class="p">,</span> <span class="n">proyecto</span><span class="p">)):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-116'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-116'>#</a>
      </div>
      <p>Verificar que el estado del proyecto sea inicializado.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="k">return</span> <span class="n">redirect</span><span class="p">(</span><span class="s1">&#39;/permissionError/&#39;</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-117'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-117'>#</a>
      </div>
      <p>En caso contrario, no permite la acceder a 
gestion de item y redirige a la vista de fase.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">if</span> <span class="n">proyecto</span><span class="o">.</span><span class="n">estado</span> <span class="o">!=</span> <span class="s2">&quot;inicializado&quot;</span><span class="p">:</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-118'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-118'>#</a>
      </div>
      <p>ID de item correspondiente.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="k">return</span> <span class="n">redirect</span><span class="p">(</span><span class="s1">&#39;faseView&#39;</span><span class="p">,</span> <span class="n">faseid</span><span class="o">=</span><span class="n">faseid</span><span class="p">,</span> <span class="n">proyectoid</span><span class="o">=</span><span class="n">proyectoid</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-119'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-119'>#</a>
      </div>
      <p>Template a renderizar: gestionItem.html 
con parametro -&gt; proyectoid, faseid, itemid</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">itemid</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;itemid&#39;</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-120'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-120'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s1">&#39;item/gestionItem.html&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;proyectoid&#39;</span><span class="p">:</span> <span class="n">proyectoid</span><span class="p">,</span> <span class="s1">&#39;faseid&#39;</span><span class="p">:</span> <span class="n">faseid</span><span class="p">,</span> <span class="s1">&#39;itemid&#39;</span><span class="p">:</span> <span class="n">itemid</span><span class="p">,</span> <span class="p">})</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-121'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-121'>#</a>
      </div>
      <pre><code>   **itemModificar:**
    Vista utilizada para modificar Item.
    Solicita que el usuario que realiza el request
    cuente con los permisos para modificar items de
     fase, o bien, de gerente del proyecto
    y que (indirectamente) haya iniciado sesion.
</code></pre>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">itemModificar</span><span class="p">(</span><span class="n">request</span><span class="p">):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-122'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-122'>#</a>
      </div>
      <p>GET request, muestra el template correspondiente para modificar el item
ID del proyecto</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;GET&#39;</span><span class="p">:</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-123'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-123'>#</a>
      </div>
      <p>Proyecto en el cual se encuentra el item</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="n">proyectoid</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;proyectoid&#39;</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-124'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-124'>#</a>
      </div>
      <p>ID de fase</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="n">proyecto</span> <span class="o">=</span> <span class="n">Proyecto</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">proyectoid</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-125'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-125'>#</a>
      </div>
      <p>ID del item</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="n">faseid</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;faseid&#39;</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-126'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-126'>#</a>
      </div>
      <p>Item a modificar.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="n">itemid</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;itemid&#39;</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-127'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-127'>#</a>
      </div>
      <p>Fase en la cual se encuentra el iten a modificar.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="n">item</span> <span class="o">=</span> <span class="n">Item</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">itemid</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-128'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-128'>#</a>
      </div>
      <p>Verificar que el usuario cuente con los permisos necesarios.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="n">fase</span> <span class="o">=</span> <span class="n">Fase</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">faseid</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-129'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-129'>#</a>
      </div>
      <p>Al no contar con los permisos, niega el acceso, redirigiendo.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">has_perm</span><span class="p">(</span><span class="s2">&quot;modify_item&quot;</span><span class="p">,</span> <span class="n">fase</span><span class="p">))</span> <span class="ow">and</span> <span class="ow">not</span> <span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">has_perm</span><span class="p">(</span><span class="s2">&quot;is_gerente&quot;</span><span class="p">,</span> <span class="n">proyecto</span><span class="p">)):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-130'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-130'>#</a>
      </div>
      <p>Verificar que el estado del proyecto sea inicializado.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>            <span class="k">return</span> <span class="n">redirect</span><span class="p">(</span><span class="s1">&#39;/permissionError/&#39;</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-131'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-131'>#</a>
      </div>
      <p>En caso contrario, no permite modificar el item y redirige a la vista de fase.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="k">if</span> <span class="n">proyecto</span><span class="o">.</span><span class="n">estado</span> <span class="o">!=</span> <span class="s2">&quot;inicializado&quot;</span><span class="p">:</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-132'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-132'>#</a>
      </div>
      <p>Verificar que el estado del item se 
encuentre en desarrollo, permitiendo modificaciones.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>            <span class="k">return</span> <span class="n">redirect</span><span class="p">(</span><span class="s1">&#39;proyectoView&#39;</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="n">proyectoid</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-133'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-133'>#</a>
      </div>
      <p>En caso contrario, no permite la modificacion del item y 
vuelve a gestion de Item con mensaje de error.
Template a renderizar: gestionItem.html con 
parametros -&gt; proyectoid, faseid, itemid y mensaje de error.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="k">if</span> <span class="n">item</span><span class="o">.</span><span class="n">estado</span> <span class="o">==</span> <span class="s2">&quot;pendiente de aprobacion&quot;</span> <span class="ow">or</span> <span class="n">item</span><span class="o">.</span><span class="n">estado</span> <span class="o">==</span> <span class="s2">&quot;aprobado&quot;</span><span class="p">:</span>
            <span class="n">mensaje</span> <span class="o">=</span> <span class="s2">&quot;El estado actual del item no permite la modificacion del mismo.&quot;</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-134'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-134'>#</a>
      </div>
      <p>Template a renderizar: itemModificar 
con parametros -&gt; proyectoid, faseid, item y campos extra.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>            <span class="k">return</span> <span class="n">redirect</span><span class="p">(</span><span class="s1">&#39;proyectoView&#39;</span><span class="p">,</span><span class="nb">id</span><span class="o">=</span><span class="n">proyectoid</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-135'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-135'>#</a>
      </div>
      <p>POST request, captura la informacion para actualizar los datos del item</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s1">&#39;item/itemModificar.html&#39;</span><span class="p">,</span>
                      <span class="p">{</span><span class="s1">&#39;faseid&#39;</span><span class="p">:</span> <span class="n">faseid</span><span class="p">,</span> <span class="s1">&#39;proyectoid&#39;</span><span class="p">:</span> <span class="n">proyectoid</span><span class="p">,</span> <span class="s1">&#39;item&#39;</span><span class="p">:</span> <span class="n">item</span><span class="p">,</span>
                       <span class="s1">&#39;campos&#39;</span><span class="p">:</span> <span class="nb">zip</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">tipoItem</span><span class="o">.</span><span class="n">campo_extra</span><span class="p">,</span> <span class="n">item</span><span class="o">.</span><span class="n">campo_extra_valores</span><span class="p">),</span> <span class="p">})</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-136'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-136'>#</a>
      </div>
      <p>Captura toda la informacion proveida por el usuario.
Item a modificar.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">dato</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">POST</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-137'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-137'>#</a>
      </div>
      <p>Fase en el que sed encuentra el item.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">item</span> <span class="o">=</span> <span class="n">Item</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">dato</span><span class="p">[</span><span class="s1">&#39;itemid&#39;</span><span class="p">])</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-138'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-138'>#</a>
      </div>
      <p>Verifica que no exista otro item con el 
mismo nombre en la fase, excluyendo a los items
deshabilitados y al item a modificar en
caso de que el nombre se mantenga.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">fase</span> <span class="o">=</span> <span class="n">Fase</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">dato</span><span class="p">[</span><span class="s1">&#39;faseid&#39;</span><span class="p">])</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-139'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-139'>#</a>
      </div>
      <p>En el caso de que ya exista un item con el 
mismo nombre en la fase, se vuelve a mostrar el
formulario de modificacion de item con un mensaje de error.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">if</span> <span class="n">fase</span><span class="o">.</span><span class="n">items</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">nombre</span><span class="o">=</span><span class="n">dato</span><span class="p">[</span><span class="s1">&#39;nombre&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">exclude</span><span class="p">(</span><span class="n">estado</span><span class="o">=</span><span class="s2">&quot;deshabilitado&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">exclude</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">dato</span><span class="p">[</span><span class="s1">&#39;itemid&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-140'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-140'>#</a>
      </div>
      <p>Template a renderizar: itemModificar con 
parametros -&gt; proyectoid, faseid, item, campos extra
y mensaje de error.</p>
<p>Actualizar nombre del item.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="k">return</span> <span class="n">redirect</span><span class="p">(</span><span class="s1">&#39;proyectoView&#39;</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="n">dato</span><span class="p">[</span><span class="s1">&#39;proyectoid&#39;</span><span class="p">])</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-141'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-141'>#</a>
      </div>
      <p>Actualizar fecha del item.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">item</span><span class="o">.</span><span class="n">nombre</span> <span class="o">=</span> <span class="n">dato</span><span class="p">[</span><span class="s1">&#39;nombre&#39;</span><span class="p">]</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-142'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-142'>#</a>
      </div>
      <p>Actualizar observacion del item.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">item</span><span class="o">.</span><span class="n">fecha</span> <span class="o">=</span> <span class="n">dato</span><span class="p">[</span><span class="s1">&#39;fecha&#39;</span><span class="p">]</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-143'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-143'>#</a>
      </div>
      <p>Actualizar costo del item.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">item</span><span class="o">.</span><span class="n">observacion</span> <span class="o">=</span> <span class="n">dato</span><span class="p">[</span><span class="s1">&#39;observacion&#39;</span><span class="p">]</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-144'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-144'>#</a>
      </div>
      <p>Actualizar campos extra del item.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">item</span><span class="o">.</span><span class="n">costo</span> <span class="o">=</span> <span class="n">dato</span><span class="p">[</span><span class="s1">&#39;costo&#39;</span><span class="p">]</span>

    <span class="n">cont</span> <span class="o">=</span> <span class="mi">0</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-145'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-145'>#</a>
      </div>
      <p>Guardar</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">item</span><span class="o">.</span><span class="n">tipoItem</span><span class="o">.</span><span class="n">campo_extra</span><span class="p">:</span>
        <span class="n">item</span><span class="o">.</span><span class="n">campo_extra_valores</span><span class="p">[</span><span class="n">cont</span><span class="p">]</span><span class="o">=</span><span class="n">dato</span><span class="p">[</span><span class="n">c</span><span class="p">]</span>
        <span class="n">cont</span> <span class="o">=</span> <span class="n">cont</span><span class="o">+</span><span class="mi">1</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-146'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-146'>#</a>
      </div>
      <p>Template a renderizar: gestionItem con 
parametro -&gt; proyectoid, faseid, itemid</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">item</span><span class="o">.</span><span class="n">save</span><span class="p">()</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-147'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-147'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">return</span> <span class="n">redirect</span><span class="p">(</span><span class="s1">&#39;proyectoView&#39;</span><span class="p">,</span><span class="nb">id</span><span class="o">=</span><span class="n">dato</span><span class="p">[</span><span class="s1">&#39;proyectoid&#39;</span><span class="p">])</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-148'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-148'>#</a>
      </div>
      <pre><code>       **itemCambiarEstado:**
        Vista utilizada para modificar el estado del Item.
        Solicita que el usuario que realiza el request
        cuente con los permisos para asignar el estado deseado
        a los item de fase, o bien, los de gerente del proyecto
        y que (indirectamente) haya iniciado sesion.
</code></pre>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">itemCambiarEstado</span><span class="p">(</span><span class="n">request</span><span class="p">):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-149'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-149'>#</a>
      </div>
      <p>Capturar datos proveidos por el usuario.
Fase en el que se encuentra el item.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">dato</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">GET</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-150'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-150'>#</a>
      </div>
      <p>Proyecto en e que se encuentra el item.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">fase</span> <span class="o">=</span> <span class="n">Fase</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">dato</span><span class="p">[</span><span class="s1">&#39;faseid&#39;</span><span class="p">])</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-151'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-151'>#</a>
      </div>
      <p>Item al cual modificar el estado.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">proyecto</span> <span class="o">=</span> <span class="n">Proyecto</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">dato</span><span class="p">[</span><span class="s1">&#39;proyectoid&#39;</span><span class="p">])</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-152'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-152'>#</a>
      </div>
      <p>Verificar que el estado no sea el mismo que ya poseia.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">item</span> <span class="o">=</span> <span class="n">Item</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">dato</span><span class="p">[</span><span class="s1">&#39;itemid&#39;</span><span class="p">])</span>

    <span class="n">mensaje</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-153'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-153'>#</a>
      </div>
      <p>Si el nuevo estado es pendiente de aprobacion.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">if</span> <span class="n">item</span><span class="o">.</span><span class="n">estado</span> <span class="o">!=</span> <span class="n">dato</span><span class="p">[</span><span class="s1">&#39;estado&#39;</span><span class="p">]:</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-154'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-154'>#</a>
      </div>
      <p>Verificar que el usuario cuente con los permisos para asignar ese estado.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="k">if</span> <span class="n">dato</span><span class="p">[</span><span class="s1">&#39;estado&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;pendiente de aprobacion&quot;</span><span class="p">:</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-155'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-155'>#</a>
      </div>
      <p>Al no contar con los permisos, niega el acceso, redirigiendo.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>            <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">has_perm</span><span class="p">(</span><span class="s2">&quot;establecer_itemPendienteAprob&quot;</span><span class="p">,</span> <span class="n">fase</span><span class="p">))</span> <span class="ow">and</span> <span class="ow">not</span> <span class="p">(</span>
                    <span class="n">request</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">has_perm</span><span class="p">(</span><span class="s2">&quot;is_gerente&quot;</span><span class="p">,</span> <span class="n">proyecto</span><span class="p">)):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-156'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-156'>#</a>
      </div>
      <p>Si el nuevo estado es aprobado.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>                <span class="k">return</span> <span class="n">redirect</span><span class="p">(</span><span class="s1">&#39;/permissionError/&#39;</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-157'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-157'>#</a>
      </div>
      <p>Verificar que el usuario cuente con los permisos para asignar ese estado.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="k">if</span> <span class="n">dato</span><span class="p">[</span><span class="s1">&#39;estado&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;aprobado&quot;</span><span class="p">:</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-158'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-158'>#</a>
      </div>
      <p>Al no contar con los permisos, niega el acceso, redirigiendo.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>            <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">has_perm</span><span class="p">(</span><span class="s2">&quot;aprove_item&quot;</span><span class="p">,</span> <span class="n">fase</span><span class="p">))</span> <span class="ow">and</span> <span class="ow">not</span> <span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">has_perm</span><span class="p">(</span><span class="s2">&quot;is_gerente&quot;</span><span class="p">,</span> <span class="n">proyecto</span><span class="p">)):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-159'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-159'>#</a>
      </div>
      <p>Verificar que el estado del proyecto sea inicializado.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>                <span class="k">return</span> <span class="n">redirect</span><span class="p">(</span><span class="s1">&#39;/permissionError/&#39;</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-160'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-160'>#</a>
      </div>
      <p>En caso contrario, no permite cambiar el estado del item y redirige a la vista de fase.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="k">if</span> <span class="n">proyecto</span><span class="o">.</span><span class="n">estado</span> <span class="o">!=</span> <span class="s2">&quot;inicializado&quot;</span><span class="p">:</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-161'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-161'>#</a>
      </div>
      <p>Acgtualiza estado del item.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>            <span class="k">return</span> <span class="n">redirect</span><span class="p">(</span><span class="s1">&#39;faseView&#39;</span><span class="p">,</span> <span class="n">faseid</span><span class="o">=</span><span class="n">dato</span><span class="p">[</span><span class="s1">&#39;faseid&#39;</span><span class="p">],</span> <span class="n">proyectoid</span><span class="o">=</span><span class="n">dato</span><span class="p">[</span><span class="s1">&#39;proyectoid&#39;</span><span class="p">])</span>

        <span class="n">mensaje</span> <span class="o">=</span> <span class="s2">&quot;Estado actualizado correctamente.&quot;</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-162'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-162'>#</a>
      </div>
      <p>Guardar.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="n">item</span><span class="o">.</span><span class="n">estado</span> <span class="o">=</span> <span class="n">dato</span><span class="p">[</span><span class="s1">&#39;estado&#39;</span><span class="p">]</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-163'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-163'>#</a>
      </div>
      <p>Template a renderizar: item.html 
con parametros -&gt; faseid, proyectoid, item, proyecto, campos extra de item,
permiso para establecer item como pendiente de aprobacion, 
permiso para establecer item como parobado, choices
con los distintos estados del item y el mensaje correspondiente.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="n">item</span><span class="o">.</span><span class="n">save</span><span class="p">()</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-164'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-164'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s1">&#39;item/item.html&#39;</span><span class="p">,</span>
                  <span class="p">{</span><span class="s1">&#39;faseid&#39;</span><span class="p">:</span> <span class="n">dato</span><span class="p">[</span><span class="s1">&#39;faseid&#39;</span><span class="p">],</span> <span class="s1">&#39;proyectoid&#39;</span><span class="p">:</span> <span class="n">dato</span><span class="p">[</span><span class="s1">&#39;proyectoid&#39;</span><span class="p">],</span> <span class="s1">&#39;item&#39;</span><span class="p">:</span> <span class="n">item</span><span class="p">,</span>
                   <span class="s1">&#39;campos&#39;</span><span class="p">:</span> <span class="nb">zip</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">tipoItem</span><span class="o">.</span><span class="n">campo_extra</span><span class="p">,</span> <span class="n">item</span><span class="o">.</span><span class="n">campo_extra_valores</span><span class="p">),</span>
                   <span class="s1">&#39;pendientePermiso&#39;</span><span class="p">:</span> <span class="n">request</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">has_perm</span><span class="p">(</span><span class="s2">&quot;establecer_itemPendienteAprob&quot;</span><span class="p">,</span> <span class="n">fase</span><span class="p">),</span>
                   <span class="s1">&#39;aprobadoPermiso&#39;</span><span class="p">:</span> <span class="n">request</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">has_perm</span><span class="p">(</span><span class="s2">&quot;aprove_item&quot;</span><span class="p">,</span> <span class="n">fase</span><span class="p">),</span>
                   <span class="s1">&#39;choices&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;en desarrollo&#39;</span><span class="p">,</span> <span class="s1">&#39;pendiente de aprobacion&#39;</span><span class="p">,</span> <span class="s1">&#39;aprobado&#39;</span><span class="p">,</span> <span class="p">],</span>
                   <span class="s1">&#39;mensaje&#39;</span><span class="p">:</span> <span class="n">mensaje</span><span class="p">,</span> <span class="p">})</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-165'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-165'>#</a>
      </div>
      <pre><code>**itemDeshabilitar:**
 Vista utilizada para deshabilitar Item.
  Solicita que el usuario que realiza el request
   cuente con los permisos para deshabilitar los
    items de fase, o bien, los permisos de gerente del proyecto
    y que (indirectamente) haya iniciado sesion.
</code></pre>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">itemDeshabilitar</span><span class="p">(</span><span class="n">request</span><span class="p">):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-166'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-166'>#</a>
      </div>
      <p>ID del proyecto
Proyecto en el cual se encuentra el item.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">proyectoid</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;proyectoid&#39;</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-167'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-167'>#</a>
      </div>
      <p>ID de fase.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">proyecto</span> <span class="o">=</span> <span class="n">Proyecto</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">proyectoid</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-168'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-168'>#</a>
      </div>
      <p>Fase en la cual se encuentra el item.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">faseid</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;faseid&#39;</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-169'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-169'>#</a>
      </div>
      <p>ID de item.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">fase</span> <span class="o">=</span> <span class="n">Fase</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">faseid</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-170'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-170'>#</a>
      </div>
      <p>Item a deshabilitar.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">itemid</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;itemid&#39;</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-171'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-171'>#</a>
      </div>
      <p>Verificar que el usuario cuente con los permisos necesarios.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">item</span> <span class="o">=</span> <span class="n">Item</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">itemid</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-172'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-172'>#</a>
      </div>
      <p>Al no contar con los permisos, niega el acceso, redirigiendo.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">has_perm</span><span class="p">(</span><span class="s2">&quot;unable_item&quot;</span><span class="p">,</span> <span class="n">fase</span><span class="p">))</span> <span class="ow">and</span> <span class="ow">not</span> <span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">has_perm</span><span class="p">(</span><span class="s2">&quot;is_gerente&quot;</span><span class="p">,</span> <span class="n">proyecto</span><span class="p">)):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-173'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-173'>#</a>
      </div>
      <p>Verificar que el estado del proyecto sea inicializado.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="k">return</span> <span class="n">redirect</span><span class="p">(</span><span class="s1">&#39;/permissionError/&#39;</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-174'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-174'>#</a>
      </div>
      <p>En caso contrario, no permite deshabilitar el item y redirige a la vista de fase.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">if</span> <span class="n">proyecto</span><span class="o">.</span><span class="n">estado</span> <span class="o">!=</span> <span class="s2">&quot;inicializado&quot;</span><span class="p">:</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-175'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-175'>#</a>
      </div>
      <p>Verificar que el estado del item sea en desarrollo.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="k">return</span> <span class="n">redirect</span><span class="p">(</span><span class="s1">&#39;proyectoView&#39;</span><span class="p">,</span><span class="nb">id</span><span class="o">=</span><span class="n">proyectoid</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-176'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-176'>#</a>
      </div>
      <p>En caso contrario niega la deshabilitacion del mismo y 
vuelve a gestion de item mostrando un mensaje de error.
Template a renderizar gestionItem.html con parametros -&gt; proyectoid, faseid, itemid y mensaje de error.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">if</span> <span class="n">item</span><span class="o">.</span><span class="n">estado</span> <span class="o">==</span> <span class="s2">&quot;pendiente de aprobacion&quot;</span> <span class="ow">or</span> <span class="n">item</span><span class="o">.</span><span class="n">estado</span> <span class="o">==</span> <span class="s2">&quot;aprobado&quot;</span><span class="p">:</span>
        <span class="n">mensaje</span> <span class="o">=</span> <span class="s2">&quot;El estado actual del item no permite la deshabilitacion del mismo.&quot;</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-177'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-177'>#</a>
      </div>
      <p>Establece estado de item como deshabilitado.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s1">&#39;item/gestionItem.html&#39;</span><span class="p">,</span>
                      <span class="p">{</span><span class="s1">&#39;proyectoid&#39;</span><span class="p">:</span> <span class="n">proyectoid</span><span class="p">,</span> <span class="s1">&#39;faseid&#39;</span><span class="p">:</span> <span class="n">faseid</span><span class="p">,</span> <span class="s1">&#39;itemid&#39;</span><span class="p">:</span> <span class="n">itemid</span><span class="p">,</span> <span class="s1">&#39;mensaje&#39;</span><span class="p">:</span> <span class="n">mensaje</span><span class="p">,</span> <span class="p">})</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-178'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-178'>#</a>
      </div>
      <p>Guardar.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">item</span><span class="o">.</span><span class="n">estado</span> <span class="o">=</span> <span class="s2">&quot;deshabilitado&quot;</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-179'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-179'>#</a>
      </div>
      <p>Redirige a la vista de la fase correspondiente.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">item</span><span class="o">.</span><span class="n">save</span><span class="p">()</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-180'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-180'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">return</span> <span class="n">redirect</span><span class="p">(</span><span class="s1">&#39;proyectoView&#39;</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="n">proyectoid</span><span class="p">)</span>

</pre></div>
    </div>
  </div>
  <div class='clearall'></div>
</div>
</body>
