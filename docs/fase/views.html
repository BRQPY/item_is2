<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html;charset=utf-8">
  <title>views.py</title>
  <link rel="stylesheet" href="../pycco.css">
</head>
<body>
<div id='container'>
  <div id="background"></div>
  <div class='section'>
    <div class='docs'><h1>views.py</h1></div>
  </div>
  <div class='clearall'>
  <div class='section' id='section-0'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-0'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">django.shortcuts</span> <span class="kn">import</span> <span class="n">render</span><span class="p">,</span> <span class="n">redirect</span>

<span class="kn">from</span> <span class="nn">proyecto.models</span> <span class="kn">import</span> <span class="n">Proyecto</span><span class="p">,</span> <span class="n">Fase</span><span class="p">,</span> <span class="n">TipodeItem</span><span class="p">,</span> <span class="n">Item</span><span class="p">,</span> <span class="n">FaseUser</span><span class="p">,</span> <span class="n">User</span><span class="p">,</span> <span class="n">Rol</span><span class="p">,</span> <span class="n">Relacion</span><span class="p">,</span> <span class="n">LineaBase</span><span class="p">,</span> <span class="n">Files</span>
<span class="kn">from</span> <span class="nn">guardian.shortcuts</span> <span class="kn">import</span> <span class="n">assign_perm</span><span class="p">,</span> <span class="n">remove_perm</span>
<span class="kn">from</span> <span class="nn">proyecto.views</span> <span class="kn">import</span> <span class="n">proyectoView</span><span class="p">,</span> <span class="n">faseView</span>
<span class="kn">import</span> <span class="nn">boto3</span>

<span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span>

<span class="kn">from</span> <span class="nn">django.db.models</span> <span class="kn">import</span> <span class="n">Q</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">deque</span>
<span class="kn">from</span> <span class="nn">django.conf</span> <span class="kn">import</span> <span class="n">settings</span>
<span class="kn">from</span> <span class="nn">django.contrib</span> <span class="kn">import</span> <span class="n">messages</span>
<span class="kn">from</span> <span class="nn">django.template.loader</span> <span class="kn">import</span> <span class="n">get_template</span>
<span class="kn">from</span> <span class="nn">django.core.mail</span> <span class="kn">import</span>  <span class="n">EmailMultiAlternatives</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-1'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-1'>#</a>
      </div>
      <p><strong>gestionFase:</strong>
    Vista utilizada para visualizar Gestion de la Fase.
    Solicita que el usuario que realiza el request cuente
    con el permiso para ver la fase correspondiente
    y que (indirectamente) haya iniciado sesion</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">gestionFase</span><span class="p">(</span><span class="n">request</span><span class="p">):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-2'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-2'>#</a>
      </div>
      <p>ID del Proyecto</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-3'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-3'>#</a>
      </div>
      <p>Proyecto para el acceso a Gestion de Fase</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">proyectoid</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;proyectoid&#39;</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-4'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-4'>#</a>
      </div>
      <p>ID de Fase</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">proyecto</span> <span class="o">=</span> <span class="n">Proyecto</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">proyectoid</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-5'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-5'>#</a>
      </div>
      <p>Fase correspondiente</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">faseid</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;faseid&#39;</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-6'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-6'>#</a>
      </div>
      <p>Verificar que el usuario que realiza el request cuente con el 
permiso para ver la fase correspondiente o bien,
sea el gerente del proyecto.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">fase</span> <span class="o">=</span> <span class="n">Fase</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">faseid</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-7'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-7'>#</a>
      </div>
      <p>Al no contar con los permisos, niega el acceso, redirigiendo.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">has_perm</span><span class="p">(</span><span class="s2">&quot;view_fase&quot;</span><span class="p">,</span> <span class="n">fase</span><span class="p">))</span> <span class="ow">and</span> <span class="ow">not</span> <span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">has_perm</span><span class="p">(</span><span class="s2">&quot;is_gerente&quot;</span><span class="p">,</span> <span class="n">proyecto</span><span class="p">)):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-8'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-8'>#</a>
      </div>
      <p>Verifica que el estado del proyecto sea distinto a pedniente.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="k">return</span> <span class="n">redirect</span><span class="p">(</span><span class="s1">&#39;/permissionError/&#39;</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-9'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-9'>#</a>
      </div>
      <p>Si el estado del proyecto es pendiente, no accede a gestion de fase y redirige a la vista del proyecto.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">if</span> <span class="n">proyecto</span><span class="o">.</span><span class="n">estado</span> <span class="o">!=</span> <span class="s2">&quot;pendiente&quot;</span><span class="p">:</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-10'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-10'>#</a>
      </div>
      <p>Template a renderizar: gestionFase.html con parametro -&gt; proyectoid, faseid</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="k">return</span> <span class="n">redirect</span><span class="p">(</span><span class="s1">&#39;proyectoView&#39;</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="n">proyectoid</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-11'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-11'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s1">&#39;fase/gestionFase.html&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;proyectoid&#39;</span><span class="p">:</span> <span class="n">proyectoid</span><span class="p">,</span> <span class="s1">&#39;faseid&#39;</span><span class="p">:</span> <span class="n">faseid</span><span class="p">,</span> <span class="p">})</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-12'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-12'>#</a>
      </div>
      <p><strong>faseCrear:</strong>
    Vista utilizada para crear fases.
    Solicita que el usuario que realiza el
    request sea el gerente del proyecto
     y que (indirectamente) haya iniciado sesion.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">faseCrear</span><span class="p">(</span><span class="n">request</span><span class="p">):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-13'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-13'>#</a>
      </div>
      <p>POST request, captura los datos ingresados por el usuario para crear la fase.
ID del proyecto</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;POST&#39;</span><span class="p">:</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-14'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-14'>#</a>
      </div>
      <p>Proyecto en el cual crear la fase.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="n">proyectoid</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">POST</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;proyectoid&#39;</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-15'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-15'>#</a>
      </div>
      <p>Verificar que el estado del proyecto sea distinto a pendiente.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="n">proyecto</span> <span class="o">=</span> <span class="n">Proyecto</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">proyectoid</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-16'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-16'>#</a>
      </div>
      <p>Si el estado del proyecto es pendiente,
no accede a gestion de fase y redirige
a la vista del proyecto.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="k">if</span> <span class="n">proyecto</span><span class="o">.</span><span class="n">estado</span> <span class="o">!=</span> <span class="s2">&quot;pendiente&quot;</span><span class="p">:</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-17'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-17'>#</a>
      </div>
      <p>Nombre de la Fase</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>            <span class="k">return</span> <span class="n">redirect</span><span class="p">(</span><span class="s1">&#39;proyectoView&#39;</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="n">proyectoid</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-18'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-18'>#</a>
      </div>
      <p>Verificar que no exista otra fase en el 
proyecto con el mismo nombre, excluyendo a
las fases deshabilitadas.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="n">nombre</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">POST</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;nombre&#39;</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-19'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-19'>#</a>
      </div>
      <p>Si existe otra fase con el mismo nombre en el proyecto, 
volver a mostrar el formulario de creacion
de fases, emitiendo un mensaje de error.
Template a renderizar: faseCrear.html con 
parametros -&gt; proyectoid y mensaje de error.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="k">if</span> <span class="n">proyecto</span><span class="o">.</span><span class="n">fases</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">nombre</span><span class="o">=</span><span class="n">nombre</span><span class="p">)</span><span class="o">.</span><span class="n">exclude</span><span class="p">(</span><span class="n">estado</span><span class="o">=</span><span class="s2">&quot;deshabilitada&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-20'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-20'>#</a>
      </div>
      <p>Descripcion de la Fase</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>            <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s1">&#39;fase/faseCrear.html&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;proyectoid&#39;</span><span class="p">:</span> <span class="n">proyectoid</span><span class="p">,</span>
                                                           <span class="s1">&#39;mensaje&#39;</span><span class="p">:</span> <span class="s2">&quot;Lo sentimos, el nombre ya pertenece a otra fase&quot;</span>
                                                                      <span class="s2">&quot;del proyecto&quot;</span><span class="p">,</span> <span class="p">})</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-21'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-21'>#</a>
      </div>
      <p>Creacion de la fase con los datos proveidos por el usuario.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="n">descripcion</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">POST</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;descripcion&#39;</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-22'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-22'>#</a>
      </div>
      <p>Agregar la fase creada al proyecto correspondiente.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="n">fase</span> <span class="o">=</span> <span class="n">Fase</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">nombre</span><span class="o">=</span><span class="n">nombre</span><span class="p">,</span> <span class="n">descripcion</span><span class="o">=</span><span class="n">descripcion</span><span class="p">,</span> <span class="n">estado</span><span class="o">=</span><span class="s2">&quot;abierta&quot;</span> <span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-23'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-23'>#</a>
      </div>
      <p>Guardar</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="n">proyecto</span><span class="o">.</span><span class="n">fases</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">fase</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-24'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-24'>#</a>
      </div>
      <p>Redirigir a la vista del proyecto correspondiente.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="n">fase</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
        <span class="n">fases</span> <span class="o">=</span> <span class="n">proyecto</span><span class="o">.</span><span class="n">fases</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
        <span class="n">fasesUser</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">fases</span><span class="p">:</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">has_perm</span><span class="p">(</span><span class="s2">&quot;view_fase&quot;</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span> <span class="ow">or</span> <span class="n">request</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">has_perm</span><span class="p">(</span><span class="s2">&quot;is_gerente&quot;</span><span class="p">,</span> <span class="n">proyecto</span><span class="p">)):</span>
                <span class="n">fasesUser</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">f</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-25'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-25'>#</a>
      </div>
      <p>GET request, muestra el template 
correspondiente para crear la fase.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s1">&#39;proyecto/proyectoListarFases.html&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;proyecto&#39;</span><span class="p">:</span> <span class="n">proyecto</span><span class="p">,</span> <span class="s1">&#39;fases&#39;</span><span class="p">:</span> <span class="n">fases</span><span class="p">,</span>
                                                                     <span class="s1">&#39;fasesUser&#39;</span><span class="p">:</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">fasesUser</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
                                                                                         <span class="n">reverse</span><span class="o">=</span><span class="kc">False</span><span class="p">),</span> <span class="p">})</span>
    <span class="k">else</span><span class="p">:</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-26'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-26'>#</a>
      </div>
      <p>ID del proyecto correspondiente.
Proyecto en el cual crear la fase.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="n">proyectoid</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;proyectoid&#39;</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-27'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-27'>#</a>
      </div>
      <p>Verificar que el usuario sea el gerente del proyecto.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="n">proyecto</span> <span class="o">=</span> <span class="n">Proyecto</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">proyectoid</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-28'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-28'>#</a>
      </div>
      <p>Al no contar con los permisos, niega el acceso, redirigiendo.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">has_perm</span><span class="p">(</span><span class="s2">&quot;is_gerente&quot;</span><span class="p">,</span> <span class="n">proyecto</span><span class="p">)):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-29'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-29'>#</a>
      </div>
      <p>Template a renderizar: faseCrear.html con parametro -&gt; proyectoid</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>            <span class="k">return</span> <span class="n">redirect</span><span class="p">(</span><span class="s1">&#39;/permissionError/&#39;</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-30'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-30'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s1">&#39;fase/faseCrear.html&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;proyectoid&#39;</span><span class="p">:</span> <span class="n">proyectoid</span><span class="p">,</span> <span class="p">})</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-31'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-31'>#</a>
      </div>
      <p>Proyecto en el cual crear la fase.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">faseVerProyectoInicializado</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">faseid</span><span class="p">,</span> <span class="n">proyectoid</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;GET&#39;</span><span class="p">:</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-32'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-32'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="n">proyecto</span> <span class="o">=</span> <span class="n">Proyecto</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">proyectoid</span><span class="p">)</span>
        <span class="n">fase</span> <span class="o">=</span> <span class="n">Fase</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">faseid</span><span class="p">)</span>
        <span class="n">items</span> <span class="o">=</span> <span class="n">fase</span><span class="o">.</span><span class="n">items</span><span class="o">.</span><span class="n">exclude</span><span class="p">(</span><span class="n">estado</span><span class="o">=</span><span class="s2">&quot;deshabilitado&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">order_by</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">)</span>
        <span class="n">tipos</span> <span class="o">=</span> <span class="n">fase</span><span class="o">.</span><span class="n">tipoItem</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s1">&#39;fase/FaseProyectoInicializado.html&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;proyecto&#39;</span><span class="p">:</span> <span class="n">proyecto</span><span class="p">,</span> <span class="s1">&#39;fase&#39;</span><span class="p">:</span> <span class="n">fase</span><span class="p">,</span>
                                                                      <span class="s1">&#39;items&#39;</span><span class="p">:</span> <span class="n">items</span><span class="p">,</span> <span class="s1">&#39;tipos&#39;</span><span class="p">:</span><span class="n">tipos</span><span class="p">,</span>
                                                                      <span class="p">})</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-33'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-33'>#</a>
      </div>
      <p>Proyecto en el cual se encuentra la fase.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">faseUsers</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">faseid</span><span class="p">,</span> <span class="n">proyectoid</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;GET&#39;</span><span class="p">:</span>
        <span class="n">fase</span> <span class="o">=</span> <span class="n">Fase</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">faseid</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-34'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-34'>#</a>
      </div>
      <p>Verificar permiso necesario en el proyecto correspondiente</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="n">proyecto</span> <span class="o">=</span> <span class="n">Proyecto</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">proyectoid</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-35'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-35'>#</a>
      </div>
      <p>Al no contar con los permisos, niega el acceso, redirigiendo.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">has_perm</span><span class="p">(</span><span class="s2">&quot;view_fase&quot;</span><span class="p">,</span> <span class="n">fase</span><span class="p">))</span> <span class="ow">and</span> <span class="ow">not</span> <span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">has_perm</span><span class="p">(</span><span class="s2">&quot;is_gerente&quot;</span><span class="p">,</span> <span class="n">proyecto</span><span class="p">)):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-36'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-36'>#</a>
      </div>
      <p>Verificar si se puede ser agregando usuarios a la fase. Debe tomar en cuenta la cantidad de usuarios en el proyecto</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>            <span class="k">return</span> <span class="n">redirect</span><span class="p">(</span><span class="s1">&#39;/permissionError/&#39;</span><span class="p">)</span>

        <span class="n">roles</span> <span class="o">=</span> <span class="n">proyecto</span><span class="o">.</span><span class="n">roles</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
        <span class="n">usuarios</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">rolesUser</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">roles</span><span class="p">:</span>
            <span class="n">fasesUser</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">faseUser</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">fasesUser</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">f</span><span class="o">.</span><span class="n">fase</span> <span class="o">==</span> <span class="n">fase</span><span class="p">:</span>
                    <span class="n">usuarios</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">user</span><span class="p">)</span>
                    <span class="n">rolesUser</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>

        <span class="n">cant_roles_proyecto</span> <span class="o">=</span> <span class="n">roles</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
        <span class="n">user_sin_repetidos</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">roles_por_user</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">cant_roles_por_user</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">contador_roles_por_user</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">u</span><span class="p">,</span> <span class="n">r</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">usuarios</span><span class="p">,</span> <span class="n">rolesUser</span><span class="p">):</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">u</span> <span class="ow">in</span> <span class="n">user_sin_repetidos</span><span class="p">:</span>
                <span class="n">user_sin_repetidos</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">u</span><span class="p">)</span>
                <span class="n">cadena</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
                <span class="k">for</span> <span class="n">uu</span><span class="p">,</span> <span class="n">rr</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">usuarios</span><span class="p">,</span> <span class="n">rolesUser</span><span class="p">):</span>
                    <span class="k">if</span> <span class="n">u</span> <span class="o">==</span> <span class="n">uu</span><span class="p">:</span>
                        <span class="n">cadena</span> <span class="o">=</span> <span class="n">cadena</span> <span class="o">+</span> <span class="n">rr</span><span class="o">.</span><span class="n">nombre</span> <span class="o">+</span> <span class="s1">&#39;, &#39;</span>
                        <span class="n">contador_roles_por_user</span> <span class="o">=</span> <span class="n">contador_roles_por_user</span> <span class="o">+</span> <span class="mi">1</span>
                <span class="n">cadena</span> <span class="o">=</span> <span class="n">cadena</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
                <span class="n">roles_por_user</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cadena</span><span class="p">)</span>
                <span class="n">cant_roles_por_user</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">contador_roles_por_user</span><span class="p">)</span>
                <span class="n">contador_roles_por_user</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">cant_user</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">user_sin_repetidos</span><span class="p">)</span>
        <span class="n">cant_usuarios_proyecto</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">proyecto</span><span class="o">.</span><span class="n">usuarios</span><span class="o">.</span><span class="n">all</span><span class="p">())</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-37'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-37'>#</a>
      </div>
      <p>Template a renderizar: fase.html con parametros -&gt; fase, proyecto, items de fase.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="k">if</span> <span class="n">cant_user</span> <span class="o">==</span> <span class="n">cant_usuarios_proyecto</span><span class="p">:</span>
            <span class="n">agregar_mas_users</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">agregar_mas_users</span> <span class="o">=</span> <span class="kc">True</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-38'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-38'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s1">&#39;fase/faseUsers.html&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;fase&#39;</span><span class="p">:</span> <span class="n">fase</span><span class="p">,</span> <span class="s1">&#39;proyecto&#39;</span><span class="p">:</span> <span class="n">proyecto</span><span class="p">,</span>
                                                       <span class="s1">&#39;userRol&#39;</span><span class="p">:</span> <span class="nb">zip</span><span class="p">(</span><span class="n">user_sin_repetidos</span><span class="p">,</span> <span class="n">roles_por_user</span><span class="p">,</span>
                                                                      <span class="n">cant_roles_por_user</span><span class="p">),</span>
                                                       <span class="s1">&#39;cant_user&#39;</span><span class="p">:</span> <span class="n">cant_user</span><span class="p">,</span>
                                                       <span class="s1">&#39;cant_roles_proyecto&#39;</span><span class="p">:</span> <span class="n">cant_roles_proyecto</span><span class="p">,</span>
                                                       <span class="s1">&#39;agregar_mas_users&#39;</span><span class="p">:</span> <span class="n">agregar_mas_users</span><span class="p">})</span>
    <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s2">&quot;fase/faseUsers.html&quot;</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-39'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-39'>#</a>
      </div>
      <p><strong>faseModificar:</strong>
    Vista utilizada para visualizar Modificar Fases.
    Solicita que el usuario que realiza el request
    cuente con los permisos para modificar fases o
     de gerente del proyecto y que
     (indirectamente) haya iniciado sesion.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">faseModificar</span><span class="p">(</span><span class="n">request</span><span class="p">):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-40'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-40'>#</a>
      </div>
      <p>GET request, muestra el template correspondiente para modificar la fase.
ID del proyecto</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;GET&#39;</span><span class="p">:</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-41'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-41'>#</a>
      </div>
      <p>Proyecto en el cual se encuentra la fase.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="n">proyectoid</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;proyectoid&#39;</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-42'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-42'>#</a>
      </div>
      <p>ID de la fase correspondiente</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="n">proyecto</span> <span class="o">=</span> <span class="n">Proyecto</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">proyectoid</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-43'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-43'>#</a>
      </div>
      <p>Fase a modificar</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="n">faseid</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;faseid&#39;</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-44'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-44'>#</a>
      </div>
      <p>Verificar que el usuario cuente con los permisos necesarios.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="n">fase</span> <span class="o">=</span> <span class="n">Fase</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">faseid</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-45'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-45'>#</a>
      </div>
      <p>Al no contar con los permisos, niega el acceso, redirigiendo.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">has_perm</span><span class="p">(</span><span class="s2">&quot;change_fase&quot;</span><span class="p">,</span> <span class="n">fase</span><span class="p">))</span> <span class="ow">and</span> <span class="ow">not</span> <span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">has_perm</span><span class="p">(</span><span class="s2">&quot;is_gerente&quot;</span><span class="p">,</span> <span class="n">proyecto</span><span class="p">)):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-46'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-46'>#</a>
      </div>
      <p>Verificar que el estado del proyecto sea distinto a pendiente.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>            <span class="k">return</span> <span class="n">redirect</span><span class="p">(</span><span class="s1">&#39;/permissionError/&#39;</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-47'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-47'>#</a>
      </div>
      <p>Si el estado del proyecto es pendiente,
 no accede al formulario de modificacion de fase 
 y redirige a gestion de Fase.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="k">if</span> <span class="n">proyecto</span><span class="o">.</span><span class="n">estado</span> <span class="o">!=</span> <span class="s2">&quot;pendiente&quot;</span><span class="p">:</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-48'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-48'>#</a>
      </div>
      <p>Template a renderizar: faseModificar con parametro -&gt; fase, proyectoid</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>            <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s1">&#39;home.html&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;proyectoid&#39;</span><span class="p">:</span> <span class="n">proyectoid</span><span class="p">,</span> <span class="s1">&#39;faseid&#39;</span><span class="p">:</span> <span class="n">faseid</span><span class="p">,</span>
                                                             <span class="s1">&#39;mensaje&#39;</span><span class="p">:</span> <span class="s2">&quot;No se puede modificar la fase, el proyecto&quot;</span>
                                                                        <span class="s2">&quot; no se encuentra en estado pendiente.&quot;</span><span class="p">})</span>
        <span class="k">if</span> <span class="n">fase</span><span class="o">.</span><span class="n">estado</span> <span class="o">==</span> <span class="s2">&quot;deshabilitada&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">redirect</span><span class="p">(</span><span class="s1">&#39;proyectoFase&#39;</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="n">proyectoid</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-49'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-49'>#</a>
      </div>
      <p>POST request, captura la informacion para actualizar los datos de la fase.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s1">&#39;fase/faseModificar.html&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;fase&#39;</span><span class="p">:</span> <span class="n">fase</span><span class="p">,</span> <span class="s1">&#39;proyecto&#39;</span><span class="p">:</span> <span class="n">proyecto</span><span class="p">,</span> <span class="p">})</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-50'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-50'>#</a>
      </div>
      <p>Nuevo nombre de fase.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-51'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-51'>#</a>
      </div>
      <p>Nueva descripcion de fase</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">nombre</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">POST</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;nombre&#39;</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-52'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-52'>#</a>
      </div>
      <p>ID del proyecto en el que se encuentra la fase.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">descripcion</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">POST</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;descripcion&#39;</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-53'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-53'>#</a>
      </div>
      <p>Proyecto en el que se enuentra la fase.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">proyectoid</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">POST</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;proyectoid&#39;</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-54'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-54'>#</a>
      </div>
      <p>ID de la fase a modificar</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">proyecto</span> <span class="o">=</span> <span class="n">Proyecto</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">proyectoid</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-55'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-55'>#</a>
      </div>
      <p>Fase a modificar</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">faseid</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">POST</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;faseid&#39;</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-56'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-56'>#</a>
      </div>
      <p>Verificar que no exista otra fase en el proyecto 
con el mismo nombre, excluyendo a
las fases deshabilitadas y a la fase correspondiente a modificar, 
en caso de que el nombre se mantenga.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">fase</span> <span class="o">=</span> <span class="n">Fase</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">faseid</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-57'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-57'>#</a>
      </div>
      <p>Si existe otra fase con el mismo nombre en el proyecto, 
volver a mostrar el formulario de modificacion
de fases, emitiendo un mensaje de error.
Template a renderizar: faseModificar.html 
con parametros -&gt; proyectoid y mensaje de error.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">if</span> <span class="n">proyecto</span><span class="o">.</span><span class="n">fases</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">nombre</span><span class="o">=</span><span class="n">nombre</span><span class="p">)</span><span class="o">.</span><span class="n">exclude</span><span class="p">(</span><span class="n">estado</span><span class="o">=</span><span class="s2">&quot;deshabilitada&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">exclude</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">faseid</span><span class="p">)</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-58'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-58'>#</a>
      </div>
      <p>Actualizar nombre de fase</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s1">&#39;fase/faseModificar.html&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;fase&#39;</span><span class="p">:</span> <span class="n">fase</span><span class="p">,</span> <span class="s1">&#39;proyectoid&#39;</span><span class="p">:</span> <span class="n">proyectoid</span><span class="p">,</span>
                                                           <span class="s1">&#39;mensaje&#39;</span><span class="p">:</span> <span class="s2">&quot;Lo sentimos, el nombre ya pertenece a otra fase&quot;</span>
                                                                      <span class="s2">&quot;del proyecto.&quot;</span><span class="p">,</span> <span class="p">})</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-59'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-59'>#</a>
      </div>
      <p>Actualizar descripcion de fase</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">fase</span><span class="o">.</span><span class="n">nombre</span> <span class="o">=</span> <span class="n">nombre</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-60'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-60'>#</a>
      </div>
      <p>Guardar</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">fase</span><span class="o">.</span><span class="n">descripcion</span> <span class="o">=</span> <span class="n">descripcion</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-61'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-61'>#</a>
      </div>
      <p>Template a renderizar: gestionFase con parametro -&gt; proyectoid, faseid</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">fase</span><span class="o">.</span><span class="n">_history_date</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
    <span class="n">fase</span><span class="o">.</span><span class="n">save</span><span class="p">()</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-62'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-62'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s1">&#39;fase/fase.html&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;proyecto&#39;</span><span class="p">:</span> <span class="n">proyecto</span><span class="p">,</span> <span class="s1">&#39;fase&#39;</span><span class="p">:</span> <span class="n">fase</span><span class="p">,</span> <span class="p">})</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-63'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-63'>#</a>
      </div>
      <pre><code>   **faseDeshabilitar:**
    Vista utilizada para Deshabilitar Fases.
    Solicita que el usuario que realiza el request
    cuente con los permisos para deshabilitar fases o
     de gerente del proyecto y que
     (indirectamente) haya iniciado sesion.
</code></pre>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">faseDeshabilitar</span><span class="p">(</span><span class="n">request</span><span class="p">):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-64'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-64'>#</a>
      </div>
      <p>ID del proyecto
Proyecto en el cual se encuentra la fase.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">proyectoid</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;proyectoid&#39;</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-65'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-65'>#</a>
      </div>
      <p>ID de fase.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">proyecto</span> <span class="o">=</span> <span class="n">Proyecto</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">proyectoid</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-66'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-66'>#</a>
      </div>
      <p>Fase a deshabilitar.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">faseid</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;faseid&#39;</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-67'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-67'>#</a>
      </div>
      <p>Verificar que el usuario cuente con los permisos necesarios.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">fase</span> <span class="o">=</span> <span class="n">Fase</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">faseid</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-68'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-68'>#</a>
      </div>
      <p>Al no contar con los permisos, niega el acceso, redirigiendo.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">has_perm</span><span class="p">(</span><span class="s2">&quot;delete_fase&quot;</span><span class="p">,</span> <span class="n">fase</span><span class="p">))</span> <span class="ow">and</span> <span class="ow">not</span> <span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">has_perm</span><span class="p">(</span><span class="s2">&quot;is_gerente&quot;</span><span class="p">,</span> <span class="n">proyecto</span><span class="p">)):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-69'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-69'>#</a>
      </div>
      <p>Verificar que el estado del proyecto sea distinto a pendiente.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="k">return</span> <span class="n">redirect</span><span class="p">(</span><span class="s1">&#39;/permissionError/&#39;</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-70'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-70'>#</a>
      </div>
      <p>Si el estado del proyecto es pendiente,
no accede al formulario de modificacion de fase y 
redirige a gestion de Fase.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">if</span> <span class="n">proyecto</span><span class="o">.</span><span class="n">estado</span> <span class="o">!=</span> <span class="s2">&quot;pendiente&quot;</span><span class="p">:</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-71'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-71'>#</a>
      </div>
      <p>Establecer el estado de la fase como deshabilitada.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s1">&#39;home.html&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;proyectoid&#39;</span><span class="p">:</span> <span class="n">proyectoid</span><span class="p">,</span> <span class="s1">&#39;faseid&#39;</span><span class="p">:</span> <span class="n">faseid</span><span class="p">,</span>
                                                         <span class="s1">&#39;mensaje&#39;</span><span class="p">:</span> <span class="s2">&quot;No se puede deshabilitar la fase,&quot;</span>
                                                                    <span class="s2">&quot; el proyecto no se encuentra en estado pendiente.&quot;</span><span class="p">})</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-72'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-72'>#</a>
      </div>
      <p>Guardar</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">fase</span><span class="o">.</span><span class="n">estado</span> <span class="o">=</span> <span class="s2">&quot;deshabilitada&quot;</span>
    <span class="n">fase</span><span class="o">.</span><span class="n">_history_date</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-73'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-73'>#</a>
      </div>
      <p>Redirigir a la vista del proyecto correspondiente.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">fase</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
    <span class="n">fases</span> <span class="o">=</span> <span class="n">proyecto</span><span class="o">.</span><span class="n">fases</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
    <span class="n">fasesUser</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">fases</span><span class="p">:</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">has_perm</span><span class="p">(</span><span class="s2">&quot;view_fase&quot;</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span> <span class="ow">or</span> <span class="n">request</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">has_perm</span><span class="p">(</span><span class="s2">&quot;is_gerente&quot;</span><span class="p">,</span> <span class="n">proyecto</span><span class="p">)):</span>
            <span class="n">fasesUser</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">f</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-74'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-74'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s1">&#39;proyecto/proyectoListarFases.html&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;proyecto&#39;</span><span class="p">:</span> <span class="n">proyecto</span><span class="p">,</span> <span class="s1">&#39;fases&#39;</span><span class="p">:</span> <span class="n">fases</span><span class="p">,</span>
                                                                 <span class="s1">&#39;fasesUser&#39;</span><span class="p">:</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">fasesUser</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
                                                                                     <span class="n">reverse</span><span class="o">=</span><span class="kc">False</span><span class="p">),</span> <span class="p">})</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-75'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-75'>#</a>
      </div>
      <p>Fase a visualizar.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">FaseConfigInicializada</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">proyectoid</span><span class="p">,</span> <span class="n">faseid</span><span class="p">):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-76'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-76'>#</a>
      </div>
      <p>Proyecto en el cual crear la fase.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-77'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-77'>#</a>
      </div>
      <p>Verificar permiso necesario en el proyecto correspondiente</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">proyecto</span> <span class="o">=</span> <span class="n">Proyecto</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">proyectoid</span><span class="p">)</span>

    <span class="n">fase</span> <span class="o">=</span> <span class="n">Fase</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">faseid</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-78'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-78'>#</a>
      </div>
      <p>Al no contar con los permisos, niega el acceso, redirigiendo.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">has_perm</span><span class="p">(</span><span class="s2">&quot;view_fase&quot;</span><span class="p">,</span> <span class="n">fase</span><span class="p">))</span> <span class="ow">and</span> <span class="ow">not</span> <span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">has_perm</span><span class="p">(</span><span class="s2">&quot;is_gerente&quot;</span><span class="p">,</span> <span class="n">proyecto</span><span class="p">)):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-79'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-79'>#</a>
      </div>
      <p>Obtiene todos los items de la fase, exclyendo a los deshabilitados, ordenados por id.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="k">return</span> <span class="n">redirect</span><span class="p">(</span><span class="s1">&#39;/permissionError/&#39;</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-80'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-80'>#</a>
      </div>
      <p>Template a renderizar: fase.html con parametros -&gt; fase, proyecto, items de fase.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">items</span> <span class="o">=</span> <span class="n">fase</span><span class="o">.</span><span class="n">items</span><span class="o">.</span><span class="n">exclude</span><span class="p">(</span><span class="n">estado</span><span class="o">=</span><span class="s2">&quot;deshabilitado&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">order_by</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">)</span>

    <span class="n">roles</span> <span class="o">=</span> <span class="n">proyecto</span><span class="o">.</span><span class="n">roles</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
    <span class="n">usuarios</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">rolesUser</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">roles</span><span class="p">:</span>
        <span class="n">fasesUser</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">faseUser</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">fasesUser</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">f</span><span class="o">.</span><span class="n">fase</span> <span class="o">==</span> <span class="n">fase</span><span class="p">:</span>
                <span class="n">usuarios</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">user</span><span class="p">)</span>
                <span class="n">rolesUser</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
    <span class="n">user_sin_repetidos</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">roles_por_user</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">u</span><span class="p">,</span> <span class="n">r</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">usuarios</span><span class="p">,</span> <span class="n">rolesUser</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">u</span> <span class="ow">in</span> <span class="n">user_sin_repetidos</span><span class="p">:</span>
            <span class="n">user_sin_repetidos</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">u</span><span class="p">)</span>
            <span class="n">cadena</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
            <span class="k">for</span> <span class="n">uu</span><span class="p">,</span> <span class="n">rr</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">usuarios</span><span class="p">,</span> <span class="n">rolesUser</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">u</span> <span class="o">==</span> <span class="n">uu</span><span class="p">:</span>
                    <span class="n">cadena</span> <span class="o">=</span> <span class="n">cadena</span> <span class="o">+</span> <span class="n">rr</span><span class="o">.</span><span class="n">nombre</span> <span class="o">+</span> <span class="s1">&#39;, &#39;</span>
            <span class="n">cadena</span> <span class="o">=</span> <span class="n">cadena</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
            <span class="n">roles_por_user</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cadena</span><span class="p">)</span>
    <span class="n">cant_user</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">user_sin_repetidos</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-81'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-81'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s1">&#39;fase/faseConfiguracionInicializada.html&#39;</span><span class="p">,</span>
                  <span class="p">{</span><span class="s1">&#39;fase&#39;</span><span class="p">:</span> <span class="n">fase</span><span class="p">,</span> <span class="s1">&#39;proyecto&#39;</span><span class="p">:</span> <span class="n">proyecto</span><span class="p">,</span> <span class="s1">&#39;items&#39;</span><span class="p">:</span> <span class="n">items</span><span class="p">,</span>
                   <span class="s1">&#39;userRol&#39;</span><span class="p">:</span> <span class="nb">zip</span><span class="p">(</span><span class="n">user_sin_repetidos</span><span class="p">,</span> <span class="n">roles_por_user</span><span class="p">),</span>
                   <span class="s1">&#39;cant_user&#39;</span><span class="p">:</span> <span class="n">cant_user</span><span class="p">,</span>
                   <span class="p">})</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-82'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-82'>#</a>
      </div>
      <p>Proyecto en el cual se encuentra la fase.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">FaseAddUser</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;GET&#39;</span><span class="p">:</span>
        <span class="n">proyectoid</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;proyectoid&#39;</span><span class="p">)</span>
        <span class="n">faseid</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;faseid&#39;</span><span class="p">)</span>
        <span class="n">fase</span> <span class="o">=</span> <span class="n">Fase</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">faseid</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-83'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-83'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="n">proyecto</span> <span class="o">=</span> <span class="n">Proyecto</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">proyectoid</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">has_perm</span><span class="p">(</span><span class="s2">&quot;is_gerente&quot;</span><span class="p">,</span> <span class="n">proyecto</span><span class="p">)):</span>
            <span class="k">return</span> <span class="n">redirect</span><span class="p">(</span><span class="s1">&#39;/permissionError/&#39;</span><span class="p">)</span>
        <span class="n">usuarios</span> <span class="o">=</span> <span class="n">proyecto</span><span class="o">.</span><span class="n">usuarios</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
        <span class="n">usuarios</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">usuarios</span><span class="p">)</span>
        <span class="n">fasesUsers</span> <span class="o">=</span> <span class="n">FaseUser</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">fu</span> <span class="ow">in</span> <span class="n">fasesUsers</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">fu</span><span class="o">.</span><span class="n">fase</span> <span class="o">==</span> <span class="n">fase</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">fu</span><span class="o">.</span><span class="n">user</span> <span class="ow">in</span> <span class="n">usuarios</span><span class="p">:</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-84'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-84'>#</a>
      </div>
      <p>Removemos los usuarios que ya forman parte de la fase
Proyecto en el cual se encuentra la fase.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>                    <span class="n">usuarios</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">fu</span><span class="o">.</span><span class="n">user</span><span class="p">)</span>
        <span class="n">roles</span> <span class="o">=</span> <span class="n">proyecto</span><span class="o">.</span><span class="n">roles</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s1">&#39;fase/faseAddUser.html&#39;</span><span class="p">,</span>
                      <span class="p">{</span><span class="s1">&#39;usuarios&#39;</span><span class="p">:</span> <span class="n">usuarios</span><span class="p">,</span> <span class="s1">&#39;roles&#39;</span><span class="p">:</span> <span class="n">roles</span><span class="p">,</span> <span class="s1">&#39;fase&#39;</span><span class="p">:</span> <span class="n">fase</span><span class="p">,</span> <span class="s1">&#39;proyecto&#39;</span><span class="p">:</span> <span class="n">proyecto</span><span class="p">})</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">proyectoid</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">POST</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;proyectoid&#39;</span><span class="p">)</span>
        <span class="n">faseid</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">POST</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;faseid&#39;</span><span class="p">)</span>
        <span class="n">fase</span> <span class="o">=</span> <span class="n">Fase</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">faseid</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-85'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-85'>#</a>
      </div>
      <p>POST request, captura el usuario, el rol y las fases para asignar el mismo</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="n">proyecto</span> <span class="o">=</span> <span class="n">Proyecto</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">proyectoid</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-86'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-86'>#</a>
      </div>
      <p>ID User
ID rol</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="n">userid</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">POST</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;users&#39;</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-87'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-87'>#</a>
      </div>
      <p>Usuario a ser asignado el rol</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="n">rolid</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">POST</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;roles&#39;</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-88'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-88'>#</a>
      </div>
      <p>Rol a ser asignado</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="n">user</span> <span class="o">=</span> <span class="n">User</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">userid</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-89'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-89'>#</a>
      </div>
      <p>Permisos del rol</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="n">rol</span> <span class="o">=</span> <span class="n">Rol</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">rolid</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-90'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-90'>#</a>
      </div>
      <p>Crear asociacion entre fase y usuario</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="n">grupo</span> <span class="o">=</span> <span class="n">rol</span><span class="o">.</span><span class="n">perms</span>
        <span class="n">permisos</span> <span class="o">=</span> <span class="n">grupo</span><span class="o">.</span><span class="n">permissions</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
        <span class="n">codenames</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">permisos</span><span class="p">:</span>
            <span class="n">codenames</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">codename</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-91'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-91'>#</a>
      </div>
      <p>Asignar los permisos del rol al grupo, en la fase correspondiente</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="n">faseUser</span> <span class="o">=</span> <span class="n">FaseUser</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">user</span><span class="o">=</span><span class="n">user</span><span class="p">,</span> <span class="n">fase</span><span class="o">=</span><span class="n">fase</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">codenames</span><span class="p">:</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-92'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-92'>#</a>
      </div>
      <p>Asignar el grupo al usuario</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>            <span class="n">assign_perm</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">grupo</span><span class="p">,</span> <span class="n">fase</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-93'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-93'>#</a>
      </div>
      <p>Agregar asociacion al rol</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>            <span class="n">user</span><span class="o">.</span><span class="n">groups</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">grupo</span><span class="p">)</span>
            <span class="n">user</span><span class="o">.</span><span class="n">save</span><span class="p">()</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-94'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-94'>#</a>
      </div>
      <p>Template a renderizar: ProyectoInicializadoConfig.html con parametro -&gt; proyectoid</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="n">rol</span><span class="o">.</span><span class="n">faseUser</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">faseUser</span><span class="p">)</span>
        <span class="n">rol</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">proyecto</span><span class="o">.</span><span class="n">estado</span> <span class="o">==</span> <span class="s2">&quot;pendiente&quot;</span><span class="p">:</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-95'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-95'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>            <span class="k">return</span> <span class="n">redirect</span><span class="p">(</span><span class="s1">&#39;faseUsers&#39;</span><span class="p">,</span> <span class="n">faseid</span><span class="o">=</span><span class="n">faseid</span><span class="p">,</span> <span class="n">proyectoid</span><span class="o">=</span><span class="n">proyectoid</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">proyecto</span><span class="o">.</span><span class="n">estado</span> <span class="o">==</span> <span class="s2">&quot;inicializado&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">redirect</span><span class="p">(</span><span class="s1">&#39;faseUsers&#39;</span><span class="p">,</span> <span class="n">faseid</span><span class="o">=</span><span class="n">faseid</span><span class="p">,</span> <span class="n">proyectoid</span><span class="o">=</span><span class="n">proyectoid</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-96'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-96'>#</a>
      </div>
      <p>Proyecto en el cual se encuentra la fase.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">FaseRemoveUser</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">proyectoid</span><span class="p">,</span> <span class="n">faseid</span><span class="p">,</span> <span class="n">userid</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;GET&#39;</span><span class="p">:</span>

        <span class="n">fase</span> <span class="o">=</span> <span class="n">Fase</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">faseid</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-97'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-97'>#</a>
      </div>
      <p>Eliminar asociacion entre fase y usuario</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="n">proyecto</span> <span class="o">=</span> <span class="n">Proyecto</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">proyectoid</span><span class="p">)</span>
        <span class="n">usuario</span> <span class="o">=</span> <span class="n">User</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">userid</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">has_perm</span><span class="p">(</span><span class="s2">&quot;is_gerente&quot;</span><span class="p">,</span> <span class="n">proyecto</span><span class="p">)):</span>
            <span class="k">return</span> <span class="n">redirect</span><span class="p">(</span><span class="s1">&#39;/permissionError/&#39;</span><span class="p">)</span>
        <span class="n">roles</span> <span class="o">=</span> <span class="n">proyecto</span><span class="o">.</span><span class="n">roles</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
        <span class="n">roles_del_user</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">roles</span><span class="p">:</span>
            <span class="n">fasesUser_rol</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">faseUser</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">fu</span> <span class="ow">in</span> <span class="n">fasesUser_rol</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">fu</span><span class="o">.</span><span class="n">fase</span> <span class="o">==</span> <span class="n">fase</span> <span class="ow">and</span> <span class="n">fu</span><span class="o">.</span><span class="n">user</span> <span class="o">==</span> <span class="n">usuario</span><span class="p">:</span>
                    <span class="n">roles_del_user</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">ru</span> <span class="ow">in</span> <span class="n">roles_del_user</span><span class="p">:</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-98'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-98'>#</a>
      </div>
      <p>Permisos del rol</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>            <span class="n">ru</span><span class="o">.</span><span class="n">faseUser</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">user</span><span class="o">=</span><span class="n">usuario</span><span class="p">,</span> <span class="n">fase</span><span class="o">=</span><span class="n">fase</span><span class="p">)</span><span class="o">.</span><span class="n">delete</span><span class="p">()</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-99'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-99'>#</a>
      </div>
      <p>Asignar los permisos del rol al grupo, en la fase correspondiente</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>            <span class="n">grupo</span> <span class="o">=</span> <span class="n">ru</span><span class="o">.</span><span class="n">perms</span>
            <span class="n">permisos</span> <span class="o">=</span> <span class="n">grupo</span><span class="o">.</span><span class="n">permissions</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
            <span class="n">codenames</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">permisos</span><span class="p">:</span>
                <span class="n">codenames</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">codename</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">codenames</span><span class="p">:</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-100'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-100'>#</a>
      </div>
      <p>Template a renderizar: ProyectoInicializadoConfig.html con parametro -&gt; proyectoid</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>                <span class="n">remove_perm</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">usuario</span><span class="p">,</span> <span class="n">fase</span><span class="p">)</span>

        <span class="n">usuario</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">proyecto</span><span class="o">.</span><span class="n">estado</span> <span class="o">==</span> <span class="s2">&quot;pendiente&quot;</span><span class="p">:</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-101'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-101'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>            <span class="k">return</span> <span class="n">redirect</span><span class="p">(</span><span class="s1">&#39;faseUsers&#39;</span><span class="p">,</span> <span class="n">faseid</span><span class="o">=</span><span class="n">faseid</span><span class="p">,</span> <span class="n">proyectoid</span><span class="o">=</span><span class="n">proyectoid</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">proyecto</span><span class="o">.</span><span class="n">estado</span> <span class="o">==</span> <span class="s2">&quot;inicializado&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">redirect</span><span class="p">(</span><span class="s1">&#39;faseUsers&#39;</span><span class="p">,</span> <span class="n">faseid</span><span class="o">=</span><span class="n">faseid</span><span class="p">,</span> <span class="n">proyectoid</span><span class="o">=</span><span class="n">proyectoid</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-102'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-102'>#</a>
      </div>
      <p><strong>faseRolAsignar:</strong>
    Vista utilizada para asignar roles del proyecto a usuarios.
    Solicita que el usuario que realiza el request
    cuente con los permisos de gerente del proyecto
    y que (indirectamente) haya iniciado sesion</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">faseRolAsignar</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">proyectoid</span><span class="p">,</span> <span class="n">faseid</span><span class="p">,</span> <span class="n">userid</span><span class="p">):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-103'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-103'>#</a>
      </div>
      <p>GET request, muestra el template correspondiente para asignar roles del proyecto dento de la fase
Proyecto ID</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;GET&#39;</span><span class="p">:</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-104'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-104'>#</a>
      </div>
      <p>proyectoid = request.GET.get(&lsquo;proyectoid&rsquo;)
Proyecto correspondiente
Verificar permiso necesario en el proyecto correspondiente</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="n">proyecto</span> <span class="o">=</span> <span class="n">Proyecto</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">proyectoid</span><span class="p">)</span>
        <span class="n">fase</span> <span class="o">=</span> <span class="n">Fase</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">faseid</span><span class="p">)</span>
        <span class="n">usuario</span> <span class="o">=</span> <span class="n">User</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">userid</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-105'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-105'>#</a>
      </div>
      <p>Lista de roles del proyecto</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">has_perm</span><span class="p">(</span><span class="s2">&quot;is_gerente&quot;</span><span class="p">,</span> <span class="n">proyecto</span><span class="p">)):</span>
            <span class="k">return</span> <span class="n">redirect</span><span class="p">(</span><span class="s1">&#39;/permissionError/&#39;</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-106'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-106'>#</a>
      </div>
      <p>Template a renderizar: faseRolAsignar.html con parametros -&gt; roles
,usuarios y fases del proyecto,
 ademas de proyectoid</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="n">roles</span> <span class="o">=</span> <span class="n">proyecto</span><span class="o">.</span><span class="n">roles</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
        <span class="n">roles_disponibles</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">roles</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">roles</span><span class="p">:</span>
            <span class="n">fasesUser_rol</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">faseUser</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">fu</span> <span class="ow">in</span> <span class="n">fasesUser_rol</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">fu</span><span class="o">.</span><span class="n">fase</span> <span class="o">==</span> <span class="n">fase</span> <span class="ow">and</span> <span class="n">fu</span><span class="o">.</span><span class="n">user</span> <span class="o">==</span> <span class="n">usuario</span><span class="p">:</span>
                    <span class="n">roles_disponibles</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">r</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-107'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-107'>#</a>
      </div>
      <p>Proyecto en el cual se encuentra la fase.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s2">&quot;fase/faseRolAsignar.html&quot;</span><span class="p">,</span>
                      <span class="p">{</span><span class="s1">&#39;fase&#39;</span><span class="p">:</span> <span class="n">fase</span><span class="p">,</span> <span class="s1">&#39;usuario&#39;</span><span class="p">:</span> <span class="n">usuario</span><span class="p">,</span> <span class="s1">&#39;roles&#39;</span><span class="p">:</span> <span class="n">roles_disponibles</span><span class="p">,</span> <span class="s1">&#39;proyecto&#39;</span><span class="p">:</span> <span class="n">proyecto</span><span class="p">,</span> <span class="p">})</span>

    <span class="n">fase</span> <span class="o">=</span> <span class="n">Fase</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">faseid</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-108'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-108'>#</a>
      </div>
      <p>POST request, captura el usuario, el rol y las fases para asignar el mismo</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">proyecto</span> <span class="o">=</span> <span class="n">Proyecto</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">proyectoid</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-109'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-109'>#</a>
      </div>
      <p>ID rol
Usuario a ser asignado el rol</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">rolid</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">POST</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;rol&#39;</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-110'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-110'>#</a>
      </div>
      <p>Rol a ser asignado</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">user</span> <span class="o">=</span> <span class="n">User</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">userid</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-111'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-111'>#</a>
      </div>
      <p>Permisos del rol</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">rol</span> <span class="o">=</span> <span class="n">Rol</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">rolid</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-112'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-112'>#</a>
      </div>
      <p>Crear asociacion entre fase y usuario</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">grupo</span> <span class="o">=</span> <span class="n">rol</span><span class="o">.</span><span class="n">perms</span>
    <span class="n">permisos</span> <span class="o">=</span> <span class="n">grupo</span><span class="o">.</span><span class="n">permissions</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
    <span class="n">codenames</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">permisos</span><span class="p">:</span>
        <span class="n">codenames</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">codename</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-113'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-113'>#</a>
      </div>
      <p>Asignar los permisos del rol al grupo, en la fase correspondiente</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">faseUser</span> <span class="o">=</span> <span class="n">FaseUser</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">user</span><span class="o">=</span><span class="n">user</span><span class="p">,</span> <span class="n">fase</span><span class="o">=</span><span class="n">fase</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">codenames</span><span class="p">:</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-114'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-114'>#</a>
      </div>
      <p>Asignar el grupo al usuario</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="n">assign_perm</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">user</span><span class="p">,</span> <span class="n">fase</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-115'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-115'>#</a>
      </div>
      <p>Agregar asociacion al rol</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">user</span><span class="o">.</span><span class="n">save</span><span class="p">()</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-116'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-116'>#</a>
      </div>
      <p>Template a renderizar: ProyectoInicializadoConfig.html con parametro -&gt; proyectoid</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">rol</span><span class="o">.</span><span class="n">faseUser</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">faseUser</span><span class="p">)</span>
    <span class="n">rol</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">proyecto</span><span class="o">.</span><span class="n">estado</span> <span class="o">==</span> <span class="s2">&quot;pendiente&quot;</span><span class="p">:</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-117'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-117'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="k">return</span> <span class="n">redirect</span><span class="p">(</span><span class="s1">&#39;faseUsers&#39;</span><span class="p">,</span> <span class="n">faseid</span><span class="o">=</span><span class="n">faseid</span><span class="p">,</span> <span class="n">proyectoid</span><span class="o">=</span><span class="n">proyectoid</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">proyecto</span><span class="o">.</span><span class="n">estado</span> <span class="o">==</span> <span class="s2">&quot;inicializado&quot;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">redirect</span><span class="p">(</span><span class="s1">&#39;faseViewInicializado&#39;</span><span class="p">,</span> <span class="n">faseid</span><span class="o">=</span><span class="n">faseid</span><span class="p">,</span> <span class="n">proyectoid</span><span class="o">=</span><span class="n">proyectoid</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-118'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-118'>#</a>
      </div>
      <p><strong> proyectoRolRemover:</strong>
    Vista utilizada para remover roles del proyecto de usuarios.
    Solicita que el usuario que realiza el request
    cuente con los permisos de gerente del proyecto
    y que (indirectamente) haya iniciado sesion</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">faseRolRemover</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">proyectoid</span><span class="p">,</span> <span class="n">faseid</span><span class="p">,</span> <span class="n">userid</span><span class="p">):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-119'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-119'>#</a>
      </div>
      <p>GET request, muestra el template correspondiente para remover roles del proyecto
Proyecto ID</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;GET&#39;</span><span class="p">:</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-120'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-120'>#</a>
      </div>
      <p>proyectoid = request.GET.get(&lsquo;proyectoid&rsquo;)
Proyecto correspondiente
Verificar permiso necesario en el proyecto correspondiente</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="n">proyecto</span> <span class="o">=</span> <span class="n">Proyecto</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">proyectoid</span><span class="p">)</span>
        <span class="n">fase</span> <span class="o">=</span> <span class="n">Fase</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">faseid</span><span class="p">)</span>
        <span class="n">usuario</span> <span class="o">=</span> <span class="n">User</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">userid</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-121'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-121'>#</a>
      </div>
      <p>Lista de roles del proyecto</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">has_perm</span><span class="p">(</span><span class="s2">&quot;is_gerente&quot;</span><span class="p">,</span> <span class="n">proyecto</span><span class="p">)):</span>
            <span class="k">return</span> <span class="n">redirect</span><span class="p">(</span><span class="s1">&#39;/permissionError/&#39;</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-122'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-122'>#</a>
      </div>
      <p>Template a renderizar: faseRolAsignar.html con parametros -&gt; roles
,usuarios y fases del proyecto,
 ademas de proyectoid</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="n">roles</span> <span class="o">=</span> <span class="n">proyecto</span><span class="o">.</span><span class="n">roles</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
        <span class="n">roles_del_user</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">roles</span><span class="p">:</span>
            <span class="n">fasesUser_rol</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">faseUser</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">fu</span> <span class="ow">in</span> <span class="n">fasesUser_rol</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">fu</span><span class="o">.</span><span class="n">fase</span> <span class="o">==</span> <span class="n">fase</span> <span class="ow">and</span> <span class="n">fu</span><span class="o">.</span><span class="n">user</span> <span class="o">==</span> <span class="n">usuario</span><span class="p">:</span>
                    <span class="n">roles_del_user</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">r</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-123'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-123'>#</a>
      </div>
      <p>POST request, captura el usuario, el rol y las fases para remover</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="n">cantidad_roles</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">roles_del_user</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s2">&quot;fase/faseRolRemover.html&quot;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;fase&#39;</span><span class="p">:</span> <span class="n">fase</span><span class="p">,</span> <span class="s1">&#39;usuario&#39;</span><span class="p">:</span> <span class="n">usuario</span><span class="p">,</span> <span class="s1">&#39;roles&#39;</span><span class="p">:</span> <span class="n">roles_del_user</span><span class="p">,</span>
                                                            <span class="s1">&#39;proyecto&#39;</span><span class="p">:</span> <span class="n">proyecto</span><span class="p">,</span> <span class="s1">&#39;cant_roles&#39;</span><span class="p">:</span> <span class="n">cantidad_roles</span><span class="p">})</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-124'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-124'>#</a>
      </div>
      <p>Rol a remover</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">proyecto</span> <span class="o">=</span> <span class="n">Proyecto</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">proyectoid</span><span class="p">)</span>
    <span class="n">fase</span> <span class="o">=</span> <span class="n">Fase</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">faseid</span><span class="p">)</span>
    <span class="n">usuario</span> <span class="o">=</span> <span class="n">User</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">userid</span><span class="p">)</span>
    <span class="n">rolid</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">POST</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;rol&#39;</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-125'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-125'>#</a>
      </div>
      <p>Eliminar asociacion entre fase y usuario</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">rol</span> <span class="o">=</span> <span class="n">Rol</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">rolid</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-126'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-126'>#</a>
      </div>
      <p>Permisos del rol</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">rol</span><span class="o">.</span><span class="n">faseUser</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">user</span><span class="o">=</span><span class="n">usuario</span><span class="p">,</span> <span class="n">fase</span><span class="o">=</span><span class="n">fase</span><span class="p">)</span><span class="o">.</span><span class="n">delete</span><span class="p">()</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-127'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-127'>#</a>
      </div>
      <p>Asignar los permisos del rol al grupo, en la fase correspondiente</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">grupo</span> <span class="o">=</span> <span class="n">rol</span><span class="o">.</span><span class="n">perms</span>
    <span class="n">permisos</span> <span class="o">=</span> <span class="n">grupo</span><span class="o">.</span><span class="n">permissions</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
    <span class="n">codenames</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">permisos</span><span class="p">:</span>
        <span class="n">codenames</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">codename</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">codenames</span><span class="p">:</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-128'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-128'>#</a>
      </div>
      <p>Se le asigna el permiso para ver la fase ya que el usuario posee otro rol</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="n">remove_perm</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">usuario</span><span class="p">,</span> <span class="n">fase</span><span class="p">)</span>

    <span class="n">usuario</span><span class="o">.</span><span class="n">save</span><span class="p">()</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-129'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-129'>#</a>
      </div>
      <p>Porque no deja remover el ultimo rol &ndash;&gt; se debe eliminar al usuario de la fase</p>
<p>Template a renderizar: ProyectoInicializadoConfig.html con parametro -&gt; proyectoid</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">assign_perm</span><span class="p">(</span><span class="s2">&quot;view_fase&quot;</span><span class="p">,</span> <span class="n">usuario</span><span class="p">,</span> <span class="n">fase</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">proyecto</span><span class="o">.</span><span class="n">estado</span> <span class="o">==</span> <span class="s2">&quot;pendiente&quot;</span><span class="p">:</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-130'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-130'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="k">return</span> <span class="n">redirect</span><span class="p">(</span><span class="s1">&#39;faseTipoItem&#39;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">proyecto</span><span class="o">.</span><span class="n">estado</span> <span class="o">==</span> <span class="s2">&quot;inicializado&quot;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">redirect</span><span class="p">(</span><span class="s1">&#39;faseViewInicializado&#39;</span><span class="p">,</span> <span class="n">faseid</span><span class="o">=</span><span class="n">faseid</span><span class="p">,</span> <span class="n">proyectoid</span><span class="o">=</span><span class="n">proyectoid</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-131'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-131'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">FaseGestionTipoItem</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">faseid</span><span class="p">,</span> <span class="n">proyectoid</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;GET&#39;</span><span class="p">:</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-132'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-132'>#</a>
      </div>
      <p>proyectoid = request.GET.get(&lsquo;proyectoid&rsquo;)
faseid = request.GET.get(&lsquo;faseid&rsquo;)
No se puede agregar ms tipos a la fase</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="n">fase</span> <span class="o">=</span> <span class="n">Fase</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">faseid</span><span class="p">)</span>
        <span class="n">proyecto</span> <span class="o">=</span> <span class="n">Proyecto</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">proyectoid</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">has_perm</span><span class="p">(</span><span class="s2">&quot;is_gerente&quot;</span><span class="p">,</span> <span class="n">proyecto</span><span class="p">)):</span>
            <span class="k">return</span> <span class="n">redirect</span><span class="p">(</span><span class="s1">&#39;/permissionError/&#39;</span><span class="p">)</span>
        <span class="n">tipos</span> <span class="o">=</span> <span class="n">fase</span><span class="o">.</span><span class="n">tipoItem</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
        <span class="n">tipos_enel_proyecto</span> <span class="o">=</span> <span class="n">proyecto</span><span class="o">.</span><span class="n">tipoItem</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">tipos</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">tipos_enel_proyecto</span><span class="p">):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-133'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-133'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>            <span class="n">add_tipo</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">add_tipo</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">tipos_removible</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">tipos</span><span class="p">)</span>
        <span class="n">tipos_no_removible</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">itemsFase</span> <span class="o">=</span> <span class="n">fase</span><span class="o">.</span><span class="n">items</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">tipos</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">itemsFase</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">i</span><span class="o">.</span><span class="n">tipoItem</span> <span class="o">==</span> <span class="n">t</span> <span class="ow">and</span> <span class="n">i</span><span class="o">.</span><span class="n">estado</span> <span class="o">!=</span> <span class="s2">&quot;deshabilitado&quot;</span><span class="p">:</span>
                    <span class="n">tipos_removible</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
                    <span class="n">tipos_no_removible</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
                    <span class="k">break</span>

        <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s2">&quot;fase/faseGestionTipoItem.html&quot;</span><span class="p">,</span>
                      <span class="p">{</span><span class="s1">&#39;fase&#39;</span><span class="p">:</span> <span class="n">fase</span><span class="p">,</span> <span class="s1">&#39;proyecto&#39;</span><span class="p">:</span> <span class="n">proyecto</span><span class="p">,</span> <span class="s1">&#39;tipos_removible&#39;</span><span class="p">:</span> <span class="n">tipos_removible</span><span class="p">,</span>
                       <span class="s1">&#39;tipos_no_removible&#39;</span><span class="p">:</span> <span class="n">tipos_no_removible</span><span class="p">,</span> <span class="s1">&#39;add_tipo&#39;</span><span class="p">:</span> <span class="n">add_tipo</span><span class="p">})</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-134'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-134'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">FaseAddTipoItem</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;GET&#39;</span><span class="p">:</span>
        <span class="n">proyectoid</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;proyectoid&#39;</span><span class="p">)</span>
        <span class="n">faseid</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;faseid&#39;</span><span class="p">)</span>
        <span class="n">fase</span> <span class="o">=</span> <span class="n">Fase</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">faseid</span><span class="p">)</span>
        <span class="n">proyecto</span> <span class="o">=</span> <span class="n">Proyecto</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">proyectoid</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">has_perm</span><span class="p">(</span><span class="s2">&quot;is_gerente&quot;</span><span class="p">,</span> <span class="n">proyecto</span><span class="p">)):</span>
            <span class="k">return</span> <span class="n">redirect</span><span class="p">(</span><span class="s1">&#39;/permissionError/&#39;</span><span class="p">)</span>
        <span class="n">tiposItem</span> <span class="o">=</span> <span class="n">proyecto</span><span class="o">.</span><span class="n">tipoItem</span><span class="o">.</span><span class="n">all</span><span class="p">()</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-135'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-135'>#</a>
      </div>
      <p>tiposItem = list(tiposItem)
Template a renderizar: ProyectoInicializadoConfig.html con parametro -&gt; proyectoid</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="n">tipositem_fase</span> <span class="o">=</span> <span class="n">fase</span><span class="o">.</span><span class="n">tipoItem</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
        <span class="n">tipositem_fase</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">tipositem_fase</span><span class="p">)</span>
        <span class="n">tipos_agregables</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">ti</span> <span class="ow">in</span> <span class="n">tiposItem</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">ti</span> <span class="ow">in</span> <span class="n">tipositem_fase</span><span class="p">:</span>
                <span class="n">tipos_agregables</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ti</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s1">&#39;fase/faseAddTipoItem.html&#39;</span><span class="p">,</span>
                      <span class="p">{</span><span class="s1">&#39;tiposItem&#39;</span><span class="p">:</span> <span class="n">tipos_agregables</span><span class="p">,</span> <span class="s1">&#39;fase&#39;</span><span class="p">:</span> <span class="n">fase</span><span class="p">,</span> <span class="s1">&#39;proyecto&#39;</span><span class="p">:</span> <span class="n">proyecto</span><span class="p">})</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">proyectoid</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">POST</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;proyectoid&#39;</span><span class="p">)</span>
        <span class="n">faseid</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">POST</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;faseid&#39;</span><span class="p">)</span>
        <span class="n">fase</span> <span class="o">=</span> <span class="n">Fase</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">faseid</span><span class="p">)</span>
        <span class="n">proyecto</span> <span class="o">=</span> <span class="n">Proyecto</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">proyectoid</span><span class="p">)</span>
        <span class="n">tipoItem</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">POST</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;tipoItem&#39;</span><span class="p">)</span>
        <span class="n">tipo</span> <span class="o">=</span> <span class="n">TipodeItem</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">tipoItem</span><span class="p">)</span>
        <span class="n">fase</span><span class="o">.</span><span class="n">tipoItem</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">tipo</span><span class="p">)</span>
        <span class="n">fase</span><span class="o">.</span><span class="n">_history_date</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
        <span class="n">fase</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">proyecto</span><span class="o">.</span><span class="n">estado</span> <span class="o">==</span> <span class="s2">&quot;pendiente&quot;</span><span class="p">:</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-136'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-136'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>            <span class="k">return</span> <span class="n">redirect</span><span class="p">(</span><span class="s1">&#39;faseTipoItem&#39;</span><span class="p">,</span> <span class="n">faseid</span><span class="o">=</span><span class="n">faseid</span><span class="p">,</span> <span class="n">proyectoid</span><span class="o">=</span><span class="n">proyectoid</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-137'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-137'>#</a>
      </div>
      <p>Remueve del proyecto actual los tipos de Item seleccionados.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">FaseRemoveTipoItem</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">proyectoid</span><span class="p">,</span> <span class="n">faseid</span><span class="p">,</span> <span class="n">tipoid</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;GET&#39;</span><span class="p">:</span>

        <span class="n">proyecto</span> <span class="o">=</span> <span class="n">Proyecto</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">proyectoid</span><span class="p">)</span>
        <span class="n">fase</span> <span class="o">=</span> <span class="n">Fase</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">faseid</span><span class="p">)</span>
        <span class="n">tipo_remover</span> <span class="o">=</span> <span class="n">TipodeItem</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">tipoid</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">has_perm</span><span class="p">(</span><span class="s2">&quot;is_gerente&quot;</span><span class="p">,</span> <span class="n">proyecto</span><span class="p">)):</span>
            <span class="k">return</span> <span class="n">redirect</span><span class="p">(</span><span class="s1">&#39;/permissionError/&#39;</span><span class="p">)</span>
        <span class="n">tipos_enla_fase</span> <span class="o">=</span> <span class="n">fase</span><span class="o">.</span><span class="n">tipoItem</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
        <span class="n">itemsFase</span> <span class="o">=</span> <span class="n">fase</span><span class="o">.</span><span class="n">items</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">itemsFase</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">i</span><span class="o">.</span><span class="n">tipoItem</span> <span class="o">==</span> <span class="n">tipo_remover</span> <span class="ow">and</span> <span class="n">i</span><span class="o">.</span><span class="n">estado</span> <span class="o">!=</span> <span class="s2">&quot;deshabilitado&quot;</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s2">&quot;fase/faseRemoveTipoItem.html&quot;</span><span class="p">,</span>
                              <span class="p">{</span><span class="s1">&#39;tipos&#39;</span><span class="p">:</span> <span class="n">tipo_remover</span><span class="p">,</span> <span class="s1">&#39;proyecto&#39;</span><span class="p">:</span> <span class="n">proyecto</span><span class="p">,</span> <span class="s1">&#39;fase&#39;</span><span class="p">:</span> <span class="n">fase</span><span class="p">,</span>
                               <span class="s1">&#39;mensaje&#39;</span><span class="p">:</span> <span class="s2">&quot;El tipo de item ya ha sido utilizado.No es posible removerlo.&quot;</span><span class="p">,</span> <span class="p">})</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-138'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-138'>#</a>
      </div>
      <p>Template a renderizar: ProyectoInicializadoConfig.html con parametro -&gt; proyectoid</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="n">fase</span><span class="o">.</span><span class="n">tipoItem</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">tipo_remover</span><span class="p">)</span>
        <span class="n">fase</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">proyecto</span><span class="o">.</span><span class="n">estado</span> <span class="o">==</span> <span class="s2">&quot;pendiente&quot;</span><span class="p">:</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-139'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-139'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>            <span class="k">return</span> <span class="n">redirect</span><span class="p">(</span><span class="s1">&#39;faseTipoItem&#39;</span><span class="p">,</span> <span class="n">faseid</span><span class="o">=</span><span class="n">faseid</span><span class="p">,</span> <span class="n">proyectoid</span><span class="o">=</span><span class="n">proyectoid</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-140'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-140'>#</a>
      </div>
      <p>Proyecto en el cual se encuentra la fase.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">fasesDeshabilitadas</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
    <span class="n">proyectoid</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;proyectoid&#39;</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-141'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-141'>#</a>
      </div>
      <p>Fases del proyecto para enviar al template que muestra la informacion</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">proyecto</span> <span class="o">=</span> <span class="n">Proyecto</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">proyectoid</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-142'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-142'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">fases</span> <span class="o">=</span> <span class="n">proyecto</span><span class="o">.</span><span class="n">fases</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
    <span class="n">fasesDes</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">fases</span><span class="p">:</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">has_perm</span><span class="p">(</span><span class="s2">&quot;view_fase&quot;</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span> <span class="ow">or</span> <span class="n">request</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">has_perm</span><span class="p">(</span><span class="s2">&quot;is_gerente&quot;</span><span class="p">,</span>
                                                                           <span class="n">proyecto</span><span class="p">))</span> <span class="ow">and</span> <span class="n">f</span><span class="o">.</span><span class="n">estado</span> <span class="o">==</span> <span class="s2">&quot;deshabilitada&quot;</span><span class="p">:</span>
            <span class="n">fasesDes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s1">&#39;fase/fasesDeshabilitadas.html&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;proyecto&#39;</span><span class="p">:</span> <span class="n">proyecto</span><span class="p">,</span> <span class="s1">&#39;fasesDes&#39;</span><span class="p">:</span> <span class="n">fasesDes</span><span class="p">,</span> <span class="p">})</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-143'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-143'>#</a>
      </div>
      <pre><code>       **itemCrear:**
        Vista utilizada para Crear Items.
        Solicita que el usuario que realiza el request
        cuente con los permisos para crear items o
         de gerente del proyecto y que
         (indirectamente) haya iniciado sesion.
</code></pre>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">itemCrear</span><span class="p">(</span><span class="n">request</span><span class="p">):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-144'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-144'>#</a>
      </div>
      <p>POST request, recibe los datos ingresados por el usuario para la creacion del item.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">seleccion</span> <span class="o">=</span> <span class="kc">None</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-145'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-145'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="s2">&quot;POST&quot;</span><span class="p">:</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-146'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-146'>#</a>
      </div>
      <p>doc = request.FILES.get(&lsquo;file&rsquo;)</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="n">doc</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">FILES</span><span class="o">.</span><span class="n">getlist</span><span class="p">(</span><span class="s2">&quot;file[]&quot;</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-147'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-147'>#</a>
      </div>
      <pre><code>Consulta si el post recibido es el de la seleccin de 
un Tipo de Item o el post para crear el item correspondiente.
</code></pre>
<p>ID del proyecto en el cual crear el item.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="k">if</span> <span class="s1">&#39;crear&#39;</span> <span class="ow">in</span> <span class="n">request</span><span class="o">.</span><span class="n">POST</span><span class="p">:</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-148'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-148'>#</a>
      </div>
      <p>ID de la fase en la cual crear el item.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>            <span class="n">proyectoid</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">POST</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;proyectoid&#39;</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-149'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-149'>#</a>
      </div>
      <p>Proyecto en el cual crear el item.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>            <span class="n">faseid</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">POST</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;faseid&#39;</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-150'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-150'>#</a>
      </div>
      <p>Fase en la cual crear el item.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>            <span class="n">proyecto</span> <span class="o">=</span> <span class="n">Proyecto</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">proyectoid</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-151'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-151'>#</a>
      </div>
      <p>Recibe el POST con los datos del formulario para la creacion del Item.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>            <span class="n">fase</span> <span class="o">=</span> <span class="n">Fase</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">faseid</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-152'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-152'>#</a>
      </div>
      <p>Tipo de item establecido para el item.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>            <span class="n">dato</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">POST</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-153'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-153'>#</a>
      </div>
      <p>Verifica que no exista otro item con el mismo nombre en la fase, 
excluyendo a los items
 deshabilitados.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>            <span class="n">obj</span> <span class="o">=</span> <span class="n">proyecto</span><span class="o">.</span><span class="n">tipoItem</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">dato</span><span class="p">[</span><span class="s1">&#39;tipodeitem_id&#39;</span><span class="p">])</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-154'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-154'>#</a>
      </div>
      <p>En el caso de que ya exista un item con el mismo nombre
 en la fase, se vuelve a mostrar el
formulario de creacion de item con un mensaje de error.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>            <span class="k">if</span> <span class="n">fase</span><span class="o">.</span><span class="n">items</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">nombre</span><span class="o">=</span><span class="n">dato</span><span class="p">[</span><span class="s1">&#39;nombre&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">exclude</span><span class="p">(</span><span class="n">estado</span><span class="o">=</span><span class="s2">&quot;deshabilitado&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-155'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-155'>#</a>
      </div>
      <p>Se obtiene todos los tios de item del proyecto.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>                <span class="n">tipos</span> <span class="o">=</span> <span class="n">proyecto</span><span class="o">.</span><span class="n">tipoItem</span><span class="o">.</span><span class="n">all</span><span class="p">()</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-156'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-156'>#</a>
      </div>
      <p>Template a renderizar: itemCrear.html 
con parametros -&gt; proyectoid, faseid, tipos de item, 
seleccion de tipo de item y mensaje de error.</p>
<p>Creacion del item con los datos proveidos por el usuario.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>                <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s2">&quot;item/itemCrear.html&quot;</span><span class="p">,</span>
                              <span class="p">{</span><span class="s1">&#39;proyectoid&#39;</span><span class="p">:</span> <span class="n">proyectoid</span><span class="p">,</span> <span class="s1">&#39;faseid&#39;</span><span class="p">:</span> <span class="n">faseid</span><span class="p">,</span> <span class="s1">&#39;tipos&#39;</span><span class="p">:</span> <span class="n">tipos</span><span class="p">,</span> <span class="s1">&#39;select&#39;</span><span class="p">:</span> <span class="n">seleccion</span><span class="p">,</span>
                               <span class="s1">&#39;mensaje&#39;</span><span class="p">:</span> <span class="s2">&quot;Lo sentimos, el nombre ya pertenece a otro item en la fase.&quot;</span><span class="p">})</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-157'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-157'>#</a>
      </div>
      <p>Almacenar la informacion de cada campo extra proveido por el usuario.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>            <span class="n">item</span> <span class="o">=</span> <span class="n">Item</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">tipoItem</span><span class="o">=</span><span class="n">obj</span><span class="p">,</span> <span class="n">nombre</span><span class="o">=</span><span class="n">dato</span><span class="p">[</span><span class="s1">&#39;nombre&#39;</span><span class="p">],</span> <span class="n">fecha</span><span class="o">=</span><span class="n">dato</span><span class="p">[</span><span class="s1">&#39;fecha&#39;</span><span class="p">],</span>
                                       <span class="n">observacion</span><span class="o">=</span><span class="n">dato</span><span class="p">[</span><span class="s1">&#39;observacion&#39;</span><span class="p">],</span> <span class="n">costo</span><span class="o">=</span><span class="n">dato</span><span class="p">[</span><span class="s1">&#39;costo&#39;</span><span class="p">],</span>
                                       <span class="n">_history_date</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">(),</span> <span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-158'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-158'>#</a>
      </div>
      <p>Guardar.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>            <span class="n">item</span><span class="o">.</span><span class="n">estado</span> <span class="o">=</span> <span class="s2">&quot;en desarrollo&quot;</span>
            <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">obj</span><span class="o">.</span><span class="n">campo_extra</span><span class="p">:</span>
                <span class="n">item</span><span class="o">.</span><span class="n">campo_extra_valores</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dato</span><span class="p">[</span><span class="n">c</span><span class="p">])</span>

            <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">doc</span><span class="p">:</span>
                <span class="n">archivo</span> <span class="o">=</span> <span class="n">Files</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">file</span><span class="o">=</span><span class="n">f</span><span class="p">,</span> <span class="n">item</span><span class="o">=</span><span class="n">item</span><span class="p">)</span>
                <span class="n">archivo</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
                <span class="n">item</span><span class="o">.</span><span class="n">archivos</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">f</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-159'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-159'>#</a>
      </div>
      <p>Agregar item a fase.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>            <span class="n">item</span><span class="o">.</span><span class="n">save</span><span class="p">()</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-160'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-160'>#</a>
      </div>
      <p>Redirigir a la vista de la fase correspondiente.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>            <span class="n">fase</span><span class="o">.</span><span class="n">items</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">item</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-161'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-161'>#</a>
      </div>
      <p>POST para seleccionar tipo de item</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>            <span class="k">return</span> <span class="n">redirect</span><span class="p">(</span><span class="s1">&#39;faseViewInicializado&#39;</span><span class="p">,</span> <span class="n">faseid</span><span class="o">=</span><span class="n">faseid</span> <span class="p">,</span><span class="n">proyectoid</span><span class="o">=</span><span class="n">proyectoid</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-162'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-162'>#</a>
      </div>
      <p>ID del proyecto correspondiente.
ID de fase correspondiente.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>            <span class="n">proyectoid</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">POST</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;proyectoid&#39;</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-163'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-163'>#</a>
      </div>
      <p>Proyeto en el cual crear el item.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>            <span class="n">faseid</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">POST</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;faseid&#39;</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-164'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-164'>#</a>
      </div>
      <p>Se asigna a la variable &ldquo;tipos&rdquo; todos los Tipos de Item 
con los que cuenta el proyecto en el cual se encuentra el usuario</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>            <span class="n">proyecto</span> <span class="o">=</span> <span class="n">Proyecto</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">proyectoid</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-165'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-165'>#</a>
      </div>
      <p>Guarda en la variable seleccion el tipo de Item seleccionado por el usuario.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>            <span class="n">tipos</span> <span class="o">=</span> <span class="n">proyecto</span><span class="o">.</span><span class="n">tipoItem</span><span class="o">.</span><span class="n">all</span><span class="p">()</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-166'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-166'>#</a>
      </div>
      <p>Template a renderizar: itemCrear.html 
con parametros -&gt; proyectoid, 
faseid, tipos de item, 
seleccion de tipo de item.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>            <span class="n">seleccion</span> <span class="o">=</span> <span class="n">TipodeItem</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">POST</span><span class="p">[</span><span class="s1">&#39;tipo&#39;</span><span class="p">])</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-167'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-167'>#</a>
      </div>
      <p>GET request, muestra el template correspondiente para la creacion de items.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>            <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s2">&quot;item/itemCrear.html&quot;</span><span class="p">,</span>
                          <span class="p">{</span><span class="s1">&#39;proyectoid&#39;</span><span class="p">:</span> <span class="n">proyectoid</span><span class="p">,</span> <span class="s1">&#39;faseid&#39;</span><span class="p">:</span> <span class="n">faseid</span><span class="p">,</span> <span class="s1">&#39;tipos&#39;</span><span class="p">:</span> <span class="n">tipos</span><span class="p">,</span> <span class="s1">&#39;select&#39;</span><span class="p">:</span> <span class="n">seleccion</span><span class="p">})</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-168'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-168'>#</a>
      </div>
      <p>ID del proyecto correspondiente.
ID de fase correspondiente.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">proyectoid</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;proyectoid&#39;</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-169'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-169'>#</a>
      </div>
      <p>Proyecto en el cual crear el item.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">faseid</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;faseid&#39;</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-170'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-170'>#</a>
      </div>
      <p>Fase en la cual crear el item.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">proyecto</span> <span class="o">=</span> <span class="n">Proyecto</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">proyectoid</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-171'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-171'>#</a>
      </div>
      <p>Verificar que el usuario cuente 
con los permisos necesarios.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">fase</span> <span class="o">=</span> <span class="n">Fase</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">faseid</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-172'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-172'>#</a>
      </div>
      <p>Al no contar con los permisos, niega el acceso, redirigiendo.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">has_perm</span><span class="p">(</span><span class="s2">&quot;create_item&quot;</span><span class="p">,</span> <span class="n">fase</span><span class="p">))</span> <span class="ow">and</span> <span class="ow">not</span> <span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">has_perm</span><span class="p">(</span><span class="s2">&quot;is_gerente&quot;</span><span class="p">,</span> <span class="n">proyecto</span><span class="p">)):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-173'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-173'>#</a>
      </div>
      <p>Verificar que el estado del proyecto sea inicializado.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="k">return</span> <span class="n">redirect</span><span class="p">(</span><span class="s1">&#39;/permissionError/&#39;</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-174'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-174'>#</a>
      </div>
      <p>En caso contrario, no permite la creacion de items y redirige a la vista de fase.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">if</span> <span class="n">proyecto</span><span class="o">.</span><span class="n">estado</span> <span class="o">!=</span> <span class="s2">&quot;inicializado&quot;</span><span class="p">:</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-175'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-175'>#</a>
      </div>
      <p>Se asigna a la variable &ldquo;tipos&rdquo; todos los Tipos de Item
con los que cuenta el proyecto en el 
cual se encuentra el usuario</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="k">return</span> <span class="n">redirect</span><span class="p">(</span><span class="s1">&#39;faseView&#39;</span><span class="p">,</span> <span class="n">faseid</span><span class="o">=</span><span class="n">faseid</span><span class="p">,</span> <span class="n">proyectoid</span><span class="o">=</span><span class="n">proyectoid</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-176'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-176'>#</a>
      </div>
      <p>Template a renderizar: itemCrear.html c
on parametros -&gt; proyectoid, faseid, tipos de item, 
seleccion de tipo de item.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">tipos</span> <span class="o">=</span> <span class="n">fase</span><span class="o">.</span><span class="n">tipoItem</span><span class="o">.</span><span class="n">all</span><span class="p">()</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-177'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-177'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s2">&quot;item/itemCrear.html&quot;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;proyectoid&#39;</span><span class="p">:</span> <span class="n">proyectoid</span><span class="p">,</span> <span class="s1">&#39;faseid&#39;</span><span class="p">:</span> <span class="n">faseid</span><span class="p">,</span>
                                                   <span class="s1">&#39;tipos&#39;</span><span class="p">:</span> <span class="n">tipos</span><span class="p">,</span> <span class="s1">&#39;select&#39;</span><span class="p">:</span> <span class="n">seleccion</span><span class="p">})</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-178'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-178'>#</a>
      </div>
      <p><strong>itemView:</strong>
    Vista utilizada para visualizar items.
    Solicita que el usuario que realiza el request
    cuente con el permiso para ver items en la fase
    correspondiente, o bien, sea el gerente del
    proyecto. Recibe el id de la fase y del proyecto
     en el que se encuentra ademas del id del item a ver.
    Tambien solicita que (indirectamente) el usuario
    haya iniciado sesion.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">itemView</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">itemid</span><span class="p">,</span> <span class="n">faseid</span><span class="p">,</span> <span class="n">proyectoid</span><span class="p">):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-179'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-179'>#</a>
      </div>
      <p>Fase en el cual se encuentra el item.
Proyecto en el cual se encuentra el item.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">fase</span> <span class="o">=</span> <span class="n">Fase</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">faseid</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-180'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-180'>#</a>
      </div>
      <p>Item a visualizar.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">proyecto</span> <span class="o">=</span> <span class="n">Proyecto</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">proyectoid</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-181'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-181'>#</a>
      </div>
      <p>Verificar que el usuario cuente con los permisos necesarios.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">item</span> <span class="o">=</span> <span class="n">Item</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">itemid</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-182'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-182'>#</a>
      </div>
      <p>Al no contar con los permisos, niega el acceso, redirigiendo.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">has_perm</span><span class="p">(</span><span class="s2">&quot;ver_item&quot;</span><span class="p">,</span> <span class="n">fase</span><span class="p">))</span> <span class="ow">and</span> <span class="ow">not</span> <span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">has_perm</span><span class="p">(</span><span class="s2">&quot;is_gerente&quot;</span><span class="p">,</span> <span class="n">proyecto</span><span class="p">)):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-183'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-183'>#</a>
      </div>
      <p>Template a renderizar: item.html con parametros -&gt; faseid, 
proyectoid, item, proyecto, campos extra de item,
permiso para establecer item como pendiente de aprobacion, 
permiso para establecer item como parobado y choices
con los distintos estados del item.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="k">return</span> <span class="n">redirect</span><span class="p">(</span><span class="s1">&#39;/permissionError/&#39;</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-184'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-184'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s1">&#39;item/item.html&#39;</span><span class="p">,</span>
                  <span class="p">{</span><span class="s1">&#39;faseid&#39;</span><span class="p">:</span> <span class="n">faseid</span><span class="p">,</span> <span class="s1">&#39;proyectoid&#39;</span><span class="p">:</span> <span class="n">proyectoid</span><span class="p">,</span> <span class="s1">&#39;item&#39;</span><span class="p">:</span> <span class="n">item</span><span class="p">,</span> <span class="s1">&#39;proyecto&#39;</span><span class="p">:</span> <span class="n">proyecto</span><span class="p">,</span>
                   <span class="s1">&#39;archivos&#39;</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">archivos</span><span class="p">),</span>
                   <span class="s1">&#39;campos&#39;</span><span class="p">:</span> <span class="nb">zip</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">tipoItem</span><span class="o">.</span><span class="n">campo_extra</span><span class="p">,</span> <span class="n">item</span><span class="o">.</span><span class="n">campo_extra_valores</span><span class="p">),</span>
                   <span class="s1">&#39;pendientePermiso&#39;</span><span class="p">:</span> <span class="n">request</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">has_perm</span><span class="p">(</span><span class="s2">&quot;establecer_itemPendienteAprob&quot;</span><span class="p">,</span> <span class="n">fase</span><span class="p">),</span>
                   <span class="s1">&#39;aprobadoPermiso&#39;</span><span class="p">:</span> <span class="n">request</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">has_perm</span><span class="p">(</span><span class="s2">&quot;aprove_item&quot;</span><span class="p">,</span> <span class="n">fase</span><span class="p">),</span>
                   <span class="s1">&#39;choices&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;en desarrollo&#39;</span><span class="p">,</span> <span class="s1">&#39;pendiente de aprobacion&#39;</span><span class="p">,</span> <span class="s1">&#39;aprobado&#39;</span><span class="p">,</span> <span class="p">],</span> <span class="p">})</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-185'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-185'>#</a>
      </div>
      <p><strong>gestionItem:</strong>
    Vista utilizada para visualizar Gestion del Item.
    Solicita que el usuario que realiza el request cuente
    con los permisos necesarios para ver el item correspondiente,
    o bien, los de gerente del proyecto y que (indirectamente)
     haya iniciado sesion.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">gestionItem</span><span class="p">(</span><span class="n">request</span><span class="p">):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-186'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-186'>#</a>
      </div>
      <p>ID del Proyecto</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-187'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-187'>#</a>
      </div>
      <p>Proyecto para el acceso a Gestion de Item</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">proyectoid</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;proyectoid&#39;</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-188'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-188'>#</a>
      </div>
      <p>ID de fase.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">proyecto</span> <span class="o">=</span> <span class="n">Proyecto</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">proyectoid</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-189'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-189'>#</a>
      </div>
      <p>Fase correspindiente.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">faseid</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;faseid&#39;</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-190'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-190'>#</a>
      </div>
      <p>Verificar que el usuario cuente con los permisos necesarios.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">fase</span> <span class="o">=</span> <span class="n">Fase</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">faseid</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-191'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-191'>#</a>
      </div>
      <p>Al no contar con los permisos, niega el acceso, redirigiendo.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">has_perm</span><span class="p">(</span><span class="s2">&quot;ver_item&quot;</span><span class="p">,</span> <span class="n">fase</span><span class="p">))</span> <span class="ow">and</span> <span class="ow">not</span> <span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">has_perm</span><span class="p">(</span><span class="s2">&quot;is_gerente&quot;</span><span class="p">,</span> <span class="n">proyecto</span><span class="p">)):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-192'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-192'>#</a>
      </div>
      <p>Verificar que el estado del proyecto sea inicializado.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="k">return</span> <span class="n">redirect</span><span class="p">(</span><span class="s1">&#39;/permissionError/&#39;</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-193'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-193'>#</a>
      </div>
      <p>En caso contrario, no permite la acceder a 
gestion de item y redirige a la vista de fase.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">if</span> <span class="n">proyecto</span><span class="o">.</span><span class="n">estado</span> <span class="o">!=</span> <span class="s2">&quot;inicializado&quot;</span><span class="p">:</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-194'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-194'>#</a>
      </div>
      <p>ID de item correspondiente.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="k">return</span> <span class="n">redirect</span><span class="p">(</span><span class="s1">&#39;faseView&#39;</span><span class="p">,</span> <span class="n">faseid</span><span class="o">=</span><span class="n">faseid</span><span class="p">,</span> <span class="n">proyectoid</span><span class="o">=</span><span class="n">proyectoid</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-195'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-195'>#</a>
      </div>
      <p>Template a renderizar: gestionItem.html 
con parametro -&gt; proyectoid, faseid, itemid</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">itemid</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;itemid&#39;</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-196'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-196'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s1">&#39;item/gestionItem.html&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;proyectoid&#39;</span><span class="p">:</span> <span class="n">proyectoid</span><span class="p">,</span> <span class="s1">&#39;faseid&#39;</span><span class="p">:</span> <span class="n">faseid</span><span class="p">,</span> <span class="s1">&#39;itemid&#39;</span><span class="p">:</span> <span class="n">itemid</span><span class="p">,</span> <span class="p">})</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-197'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-197'>#</a>
      </div>
      <p>Fase en el cual se encuentra el item.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">itemConfigurar</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">itemid</span><span class="p">,</span> <span class="n">faseid</span><span class="p">,</span> <span class="n">proyectoid</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="s2">&quot;GET&quot;</span><span class="p">:</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-198'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-198'>#</a>
      </div>
      <p>Proyecto en el cual se encuentra el item.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="n">fase</span> <span class="o">=</span> <span class="n">Fase</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">faseid</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-199'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-199'>#</a>
      </div>
      <p>Item a visualizar.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="n">proyecto</span> <span class="o">=</span> <span class="n">Proyecto</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">proyectoid</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-200'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-200'>#</a>
      </div>
      <p>Verificar que el usuario cuente con los permisos necesarios.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="n">item</span> <span class="o">=</span> <span class="n">Item</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">itemid</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-201'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-201'>#</a>
      </div>
      <p>Al no contar con los permisos, niega el acceso, redirigiendo.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">has_perm</span><span class="p">(</span><span class="s2">&quot;ver_item&quot;</span><span class="p">,</span> <span class="n">fase</span><span class="p">))</span> <span class="ow">and</span> <span class="ow">not</span> <span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">has_perm</span><span class="p">(</span><span class="s2">&quot;is_gerente&quot;</span><span class="p">,</span> <span class="n">proyecto</span><span class="p">)):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-202'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-202'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>            <span class="k">return</span> <span class="n">redirect</span><span class="p">(</span><span class="s1">&#39;/permissionError/&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s2">&quot;item/itemConfiguracion.html&quot;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;fase&#39;</span><span class="p">:</span> <span class="n">fase</span><span class="p">,</span> <span class="s1">&#39;item&#39;</span><span class="p">:</span> <span class="n">item</span><span class="p">,</span> <span class="s1">&#39;proyecto&#39;</span><span class="p">:</span> <span class="n">proyecto</span><span class="p">,</span> <span class="s1">&#39;archivos&#39;</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">archivos</span><span class="p">),</span>
                                                               <span class="s1">&#39;campos&#39;</span><span class="p">:</span> <span class="nb">zip</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">tipoItem</span><span class="o">.</span><span class="n">campo_extra</span><span class="p">,</span>
                                                                             <span class="n">item</span><span class="o">.</span><span class="n">campo_extra_valores</span><span class="p">),</span> <span class="p">})</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-203'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-203'>#</a>
      </div>
      <pre><code>   **itemModificar:**
    Vista utilizada para modificar Item.
    Solicita que el usuario que realiza el request
    cuente con los permisos para modificar items de
     fase, o bien, de gerente del proyecto
    y que (indirectamente) haya iniciado sesion.
</code></pre>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">itemModificar</span><span class="p">(</span><span class="n">request</span><span class="p">):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-204'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-204'>#</a>
      </div>
      <p>GET request, muestra el template correspondiente para modificar el item
ID del proyecto</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;GET&#39;</span><span class="p">:</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-205'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-205'>#</a>
      </div>
      <p>Proyecto en el cual se encuentra el item</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="n">proyectoid</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;proyectoid&#39;</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-206'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-206'>#</a>
      </div>
      <p>ID de fase</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="n">proyecto</span> <span class="o">=</span> <span class="n">Proyecto</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">proyectoid</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-207'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-207'>#</a>
      </div>
      <p>ID del item</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="n">faseid</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;faseid&#39;</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-208'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-208'>#</a>
      </div>
      <p>Item a modificar.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="n">itemid</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;itemid&#39;</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-209'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-209'>#</a>
      </div>
      <p>Fase en la cual se encuentra el item a modificar.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="n">item</span> <span class="o">=</span> <span class="n">Item</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">itemid</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-210'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-210'>#</a>
      </div>
      <p>Verificar que el usuario cuente con los permisos necesarios.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="n">fase</span> <span class="o">=</span> <span class="n">Fase</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">faseid</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-211'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-211'>#</a>
      </div>
      <p>Al no contar con los permisos, niega el acceso, redirigiendo.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">has_perm</span><span class="p">(</span><span class="s2">&quot;modify_item&quot;</span><span class="p">,</span> <span class="n">fase</span><span class="p">))</span> <span class="ow">and</span> <span class="ow">not</span> <span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">has_perm</span><span class="p">(</span><span class="s2">&quot;is_gerente&quot;</span><span class="p">,</span> <span class="n">proyecto</span><span class="p">)):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-212'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-212'>#</a>
      </div>
      <p>Verificar que el estado del proyecto sea inicializado.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>            <span class="k">return</span> <span class="n">redirect</span><span class="p">(</span><span class="s1">&#39;/permissionError/&#39;</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-213'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-213'>#</a>
      </div>
      <p>En caso contrario, no permite modificar el item y redirige a la vista de fase.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="k">if</span> <span class="n">proyecto</span><span class="o">.</span><span class="n">estado</span> <span class="o">!=</span> <span class="s2">&quot;inicializado&quot;</span><span class="p">:</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-214'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-214'>#</a>
      </div>
      <p>Verificar que el estado del item se 
encuentre en desarrollo, permitiendo modificaciones.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>            <span class="k">return</span> <span class="n">redirect</span><span class="p">(</span><span class="s1">&#39;proyectoView&#39;</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="n">proyectoid</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-215'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-215'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-216'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-216'>#</a>
      </div>
      <p>if item.estado == &ldquo;pendiente de aprobacion&rdquo; or item.estado == &ldquo;aprobado&rdquo; or item.estado == &ldquo;en linea base&rdquo;:
mensaje = &ldquo;El estado actual del item no permite la modificacion del mismo.&rdquo;</p>
<p>En caso contrario, no permite la modificacion del item y 
vuelve a gestion de Item con mensaje de error.
Template a renderizar: gestionItem.html con 
parametros -&gt; proyectoid, faseid, itemid y mensaje de error.</p>
<p>return redirect(&lsquo;proyectoView&rsquo;, id=proyectoid)</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-217'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-217'>#</a>
      </div>
      <p>Template a renderizar: itemModificar 
con parametros -&gt; proyectoid, faseid, item y campos extra.</p>
<p>POST request, captura la informacion para actualizar los datos del item</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s1">&#39;item/itemModificar.html&#39;</span><span class="p">,</span>
                      <span class="p">{</span><span class="s1">&#39;faseid&#39;</span><span class="p">:</span> <span class="n">faseid</span><span class="p">,</span> <span class="s1">&#39;proyectoid&#39;</span><span class="p">:</span> <span class="n">proyectoid</span><span class="p">,</span> <span class="s1">&#39;item&#39;</span><span class="p">:</span> <span class="n">item</span><span class="p">,</span>
                       <span class="s1">&#39;campos&#39;</span><span class="p">:</span> <span class="nb">zip</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">tipoItem</span><span class="o">.</span><span class="n">campo_extra</span><span class="p">,</span> <span class="n">item</span><span class="o">.</span><span class="n">campo_extra_valores</span><span class="p">),</span>
                       <span class="s1">&#39;archivos&#39;</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">archivos</span><span class="p">),</span><span class="s1">&#39;pendientePermiso&#39;</span><span class="p">:</span> <span class="n">request</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">has_perm</span><span class="p">(</span><span class="s2">&quot;establecer_itemPendienteAprob&quot;</span><span class="p">,</span> <span class="n">fase</span><span class="p">),</span>
                       <span class="s1">&#39;aprobadoPermiso&#39;</span><span class="p">:</span> <span class="n">request</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">has_perm</span><span class="p">(</span><span class="s2">&quot;aprove_item&quot;</span><span class="p">,</span> <span class="n">fase</span><span class="p">),</span>
                       <span class="s1">&#39;choices&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;en desarrollo&#39;</span><span class="p">,</span> <span class="s1">&#39;pendiente de aprobacion&#39;</span><span class="p">,</span> <span class="s1">&#39;aprobado&#39;</span><span class="p">,</span> <span class="p">],</span> <span class="p">})</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-218'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-218'>#</a>
      </div>
      <p>Captura toda la informacion proveida por el usuario.
Item a modificar.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">dato</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">POST</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-219'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-219'>#</a>
      </div>
      <p>Fase en el que sed encuentra el item.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">item</span> <span class="o">=</span> <span class="n">Item</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">dato</span><span class="p">[</span><span class="s1">&#39;itemid&#39;</span><span class="p">])</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-220'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-220'>#</a>
      </div>
      <p>Verifica que no exista otro item con el 
mismo nombre en la fase, excluyendo a los items
deshabilitados y al item a modificar en
caso de que el nombre se mantenga.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">fase</span> <span class="o">=</span> <span class="n">Fase</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">dato</span><span class="p">[</span><span class="s1">&#39;faseid&#39;</span><span class="p">])</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-221'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-221'>#</a>
      </div>
      <p>En el caso de que ya exista un item con el 
mismo nombre en la fase, se vuelve a mostrar el
formulario de modificacion de item con un mensaje de error.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">doc</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">FILES</span><span class="o">.</span><span class="n">getlist</span><span class="p">(</span><span class="s2">&quot;file[]&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">fase</span><span class="o">.</span><span class="n">items</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">nombre</span><span class="o">=</span><span class="n">dato</span><span class="p">[</span><span class="s1">&#39;nombre&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">exclude</span><span class="p">(</span><span class="n">estado</span><span class="o">=</span><span class="s2">&quot;deshabilitado&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">exclude</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">dato</span><span class="p">[</span><span class="s1">&#39;itemid&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-222'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-222'>#</a>
      </div>
      <p>Template a renderizar: itemModificar con 
parametros -&gt; proyectoid, faseid, item, campos extra
y mensaje de error.</p>
<p>Actualizar nombre del item.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="k">return</span> <span class="n">redirect</span><span class="p">(</span><span class="s1">&#39;proyectoView&#39;</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="n">dato</span><span class="p">[</span><span class="s1">&#39;proyectoid&#39;</span><span class="p">])</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-223'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-223'>#</a>
      </div>
      <p>Actualizar fecha del item.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">item</span><span class="o">.</span><span class="n">nombre</span> <span class="o">=</span> <span class="n">dato</span><span class="p">[</span><span class="s1">&#39;nombre&#39;</span><span class="p">]</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-224'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-224'>#</a>
      </div>
      <p>Actualizar observacion del item.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">item</span><span class="o">.</span><span class="n">fecha</span> <span class="o">=</span> <span class="n">dato</span><span class="p">[</span><span class="s1">&#39;fecha&#39;</span><span class="p">]</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-225'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-225'>#</a>
      </div>
      <p>Actualizar costo del item.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">item</span><span class="o">.</span><span class="n">observacion</span> <span class="o">=</span> <span class="n">dato</span><span class="p">[</span><span class="s1">&#39;observacion&#39;</span><span class="p">]</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-226'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-226'>#</a>
      </div>
      <p>Actualizar el numero de version del item</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">item</span><span class="o">.</span><span class="n">costo</span> <span class="o">=</span> <span class="n">dato</span><span class="p">[</span><span class="s1">&#39;costo&#39;</span><span class="p">]</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-227'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-227'>#</a>
      </div>
      <p>Actualizar campos extra del item.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">num</span> <span class="o">=</span> <span class="n">Item</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">last</span><span class="p">()</span>
    <span class="n">item</span><span class="o">.</span><span class="n">version</span> <span class="o">=</span> <span class="n">num</span><span class="o">.</span><span class="n">version</span> <span class="o">+</span> <span class="mi">1</span>

    <span class="n">cont</span> <span class="o">=</span> <span class="mi">0</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-228'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-228'>#</a>
      </div>
      <p>Guardar</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">item</span><span class="o">.</span><span class="n">tipoItem</span><span class="o">.</span><span class="n">campo_extra</span><span class="p">:</span>
        <span class="n">item</span><span class="o">.</span><span class="n">campo_extra_valores</span><span class="p">[</span><span class="n">cont</span><span class="p">]</span> <span class="o">=</span> <span class="n">dato</span><span class="p">[</span><span class="n">c</span><span class="p">]</span>
        <span class="n">cont</span> <span class="o">=</span> <span class="n">cont</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="s2">&quot;Actualizar Archivos del item&quot;</span>
    <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">doc</span><span class="p">:</span>
        <span class="n">archivo</span> <span class="o">=</span> <span class="n">Files</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">file</span><span class="o">=</span><span class="n">f</span><span class="p">,</span> <span class="n">item</span><span class="o">=</span><span class="n">item</span><span class="p">)</span>
        <span class="n">item</span><span class="o">.</span><span class="n">archivos</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>

    <span class="n">item</span><span class="o">.</span><span class="n">_history_date</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-229'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-229'>#</a>
      </div>
      <p>Template a renderizar: gestionItem con 
parametro -&gt; proyectoid, faseid, itemid</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">item</span><span class="o">.</span><span class="n">save</span><span class="p">()</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-230'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-230'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">return</span> <span class="n">redirect</span><span class="p">(</span><span class="s1">&#39;proyectoView&#39;</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="n">dato</span><span class="p">[</span><span class="s1">&#39;proyectoid&#39;</span><span class="p">])</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-231'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-231'>#</a>
      </div>
      <pre><code>       **itemCambiarEstado:**
        Vista utilizada para modificar el estado del Item.
        Solicita que el usuario que realiza el request
        cuente con los permisos para asignar el estado deseado
        a los item de fase, o bien, los de gerente del proyecto
        y que (indirectamente) haya iniciado sesion.
</code></pre>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">itemCambiarEstado</span><span class="p">(</span><span class="n">request</span><span class="p">):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-232'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-232'>#</a>
      </div>
      <p>Capturar datos proveidos por el usuario.
Fase en el que se encuentra el item.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">dato</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">GET</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-233'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-233'>#</a>
      </div>
      <p>Proyecto en e que se encuentra el item.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">fase</span> <span class="o">=</span> <span class="n">Fase</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">dato</span><span class="p">[</span><span class="s1">&#39;faseid&#39;</span><span class="p">])</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-234'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-234'>#</a>
      </div>
      <p>Item al cual modificar el estado.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">proyecto</span> <span class="o">=</span> <span class="n">Proyecto</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">dato</span><span class="p">[</span><span class="s1">&#39;proyectoid&#39;</span><span class="p">])</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-235'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-235'>#</a>
      </div>
      <pre><code>Template a renderizar: item.html 
con parametros -&gt; faseid, proyectoid, item, proyecto, campos extra de item,
permiso para establecer item como pendiente de aprobacion, 
permiso para establecer item como parobado, choices
con los distintos estados del item y el mensaje correspondiente.
</code></pre>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">item</span> <span class="o">=</span> <span class="n">Item</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">dato</span><span class="p">[</span><span class="s1">&#39;itemid&#39;</span><span class="p">])</span>

    <span class="s2">&quot;Verificar que si el item esta aprobado, no debe cambiar su estado si este ya posee relaciones.&quot;</span>
    <span class="k">if</span> <span class="n">item</span><span class="o">.</span><span class="n">estado</span> <span class="o">==</span> <span class="s2">&quot;aprobado&quot;</span><span class="p">:</span>
        <span class="n">relaciones</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">relaciones</span><span class="o">.</span><span class="n">exclude</span><span class="p">(</span><span class="n">estado</span><span class="o">=</span><span class="s2">&quot;deshabilitado&quot;</span><span class="p">)</span>
        <span class="n">cambiar_estado</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">relaciones</span><span class="p">:</span>
            <span class="n">relacion</span> <span class="o">=</span> <span class="n">Relacion</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">item_from</span><span class="o">=</span><span class="n">item</span><span class="p">,</span> <span class="n">item_to</span><span class="o">=</span><span class="n">r</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">relacion</span><span class="o">.</span><span class="n">tipo</span> <span class="o">==</span> <span class="s2">&quot;padre&quot;</span> <span class="ow">or</span> <span class="n">relacion</span><span class="o">.</span><span class="n">tipo</span> <span class="o">==</span> <span class="s2">&quot;antecesor&quot;</span><span class="p">:</span>
                <span class="n">cambiar_estado</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="k">break</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">cambiar_estado</span><span class="p">:</span>
            <span class="n">mensaje_error</span> <span class="o">=</span> <span class="s2">&quot;No es posible cambiar el estado del item ya que este cuenta con relaciones.&quot;</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-236'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-236'>#</a>
      </div>
      <p>Verificar que el estado no sea el mismo que ya poseia.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>            <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s1">&#39;item/item.html&#39;</span><span class="p">,</span>
                          <span class="p">{</span><span class="s1">&#39;faseid&#39;</span><span class="p">:</span> <span class="n">dato</span><span class="p">[</span><span class="s1">&#39;faseid&#39;</span><span class="p">],</span> <span class="s1">&#39;proyectoid&#39;</span><span class="p">:</span> <span class="n">dato</span><span class="p">[</span><span class="s1">&#39;proyectoid&#39;</span><span class="p">],</span> <span class="s1">&#39;item&#39;</span><span class="p">:</span> <span class="n">item</span><span class="p">,</span>
                           <span class="s1">&#39;campos&#39;</span><span class="p">:</span> <span class="nb">zip</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">tipoItem</span><span class="o">.</span><span class="n">campo_extra</span><span class="p">,</span> <span class="n">item</span><span class="o">.</span><span class="n">campo_extra_valores</span><span class="p">),</span>
                           <span class="s1">&#39;pendientePermiso&#39;</span><span class="p">:</span> <span class="n">request</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">has_perm</span><span class="p">(</span><span class="s2">&quot;establecer_itemPendienteAprob&quot;</span><span class="p">,</span> <span class="n">fase</span><span class="p">),</span>
                           <span class="s1">&#39;aprobadoPermiso&#39;</span><span class="p">:</span> <span class="n">request</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">has_perm</span><span class="p">(</span><span class="s2">&quot;aprove_item&quot;</span><span class="p">,</span> <span class="n">fase</span><span class="p">),</span>
                           <span class="s1">&#39;choices&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;en desarrollo&#39;</span><span class="p">,</span> <span class="s1">&#39;pendiente de aprobacion&#39;</span><span class="p">,</span> <span class="s1">&#39;aprobado&#39;</span><span class="p">,</span> <span class="p">],</span>
                           <span class="s1">&#39;mensaje_error&#39;</span><span class="p">:</span> <span class="n">mensaje_error</span><span class="p">,</span> <span class="p">})</span>

    <span class="n">mensaje</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="n">mensaje_error</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-237'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-237'>#</a>
      </div>
      <p>Si el nuevo estado es pendiente de aprobacion.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">if</span> <span class="n">item</span><span class="o">.</span><span class="n">estado</span> <span class="o">!=</span> <span class="n">dato</span><span class="p">[</span><span class="s1">&#39;estado&#39;</span><span class="p">]:</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-238'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-238'>#</a>
      </div>
      <p>Verificar que el usuario cuente con los permisos para asignar ese estado.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="k">if</span> <span class="n">dato</span><span class="p">[</span><span class="s1">&#39;estado&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;pendiente de aprobacion&quot;</span><span class="p">:</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-239'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-239'>#</a>
      </div>
      <p>Al no contar con los permisos, niega el acceso, redirigiendo.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>            <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">has_perm</span><span class="p">(</span><span class="s2">&quot;establecer_itemPendienteAprob&quot;</span><span class="p">,</span> <span class="n">fase</span><span class="p">))</span> <span class="ow">and</span> <span class="ow">not</span> <span class="p">(</span>
                    <span class="n">request</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">has_perm</span><span class="p">(</span><span class="s2">&quot;is_gerente&quot;</span><span class="p">,</span> <span class="n">proyecto</span><span class="p">)):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-240'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-240'>#</a>
      </div>
      <p>Si el nuevo estado es en desarrollo.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>                <span class="k">return</span> <span class="n">redirect</span><span class="p">(</span><span class="s1">&#39;/permissionError/&#39;</span><span class="p">)</span>

            <span class="s2">&quot;Envio de correo a los usuarios que cuentan con el permiso de aprobar item&quot;</span>
            <span class="n">fuser</span><span class="o">=</span> <span class="n">FaseUser</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">fase</span><span class="o">=</span><span class="n">fase</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">u</span> <span class="ow">in</span> <span class="n">fuser</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">u</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">has_perm</span><span class="p">(</span><span class="s2">&quot;aprove_item&quot;</span><span class="p">,</span><span class="n">fase</span><span class="p">):</span>
                    <span class="n">mail</span><span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">email</span>
                    <span class="n">name</span><span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">username</span>
                    <span class="n">sendEmailView</span><span class="p">(</span><span class="n">mail</span><span class="p">,</span><span class="n">name</span><span class="p">,</span><span class="n">item</span><span class="o">.</span><span class="n">nombre</span><span class="p">,</span><span class="n">fase</span><span class="o">.</span><span class="n">nombre</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-241'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-241'>#</a>
      </div>
      <p>Verificar que el usuario cuente con los permisos para asignar ese estado.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="k">if</span> <span class="n">dato</span><span class="p">[</span><span class="s1">&#39;estado&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;en desarrollo&quot;</span><span class="p">:</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-242'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-242'>#</a>
      </div>
      <p>Al no contar con los permisos, niega el acceso, redirigiendo.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>            <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">has_perm</span><span class="p">(</span><span class="s2">&quot;establecer_itemDesarrollo&quot;</span><span class="p">,</span> <span class="n">fase</span><span class="p">))</span> <span class="ow">and</span> <span class="ow">not</span> <span class="p">(</span>
                    <span class="n">request</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">has_perm</span><span class="p">(</span><span class="s2">&quot;is_gerente&quot;</span><span class="p">,</span> <span class="n">proyecto</span><span class="p">)):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-243'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-243'>#</a>
      </div>
      <p>Si el nuevo estado es aprobado.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>                <span class="k">return</span> <span class="n">redirect</span><span class="p">(</span><span class="s1">&#39;/permissionError/&#39;</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-244'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-244'>#</a>
      </div>
      <p>Verificar que el usuario cuente con los permisos para asignar ese estado.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="k">if</span> <span class="n">dato</span><span class="p">[</span><span class="s1">&#39;estado&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;aprobado&quot;</span><span class="p">:</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-245'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-245'>#</a>
      </div>
      <p>Al no contar con los permisos, niega el acceso, redirigiendo.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>            <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">has_perm</span><span class="p">(</span><span class="s2">&quot;aprove_item&quot;</span><span class="p">,</span> <span class="n">fase</span><span class="p">))</span> <span class="ow">and</span> <span class="ow">not</span> <span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">has_perm</span><span class="p">(</span><span class="s2">&quot;is_gerente&quot;</span><span class="p">,</span> <span class="n">proyecto</span><span class="p">)):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-246'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-246'>#</a>
      </div>
      <p>Para aprobar el item es necesario identificar que tenga alguna relacion con un antecesor</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>                <span class="k">return</span> <span class="n">redirect</span><span class="p">(</span><span class="s1">&#39;/permissionError/&#39;</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-247'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-247'>#</a>
      </div>
      <p>Inicializar contador.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>            <span class="n">que</span> <span class="n">se</span> <span class="n">encuentre</span> <span class="n">en</span> <span class="n">una</span> <span class="n">linea</span> <span class="n">base</span> <span class="n">cerrada</span><span class="p">,</span> <span class="n">o</span> <span class="n">bien</span> <span class="n">con</span> <span class="n">un</span> <span class="n">padre</span><span class="p">(</span><span class="n">o</span> <span class="n">hijo</span><span class="p">)</span> <span class="n">que</span> <span class="n">este</span> <span class="n">aprobado</span><span class="o">.</span><span class="s2">&quot;&quot;&quot;</span>

<span class="s2">            &quot;&quot;&quot;</span><span class="n">Filtrar</span> <span class="n">fases</span> <span class="n">no</span> <span class="n">deshabilitadas</span> <span class="k">del</span> <span class="n">proyecto</span><span class="o">.</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">            fasesProyecto = proyecto.fases.exclude(estado=&quot;deshabilitada&quot;).order_by(&#39;id&#39;)</span>
<span class="s2">#DIVIDER</span>
<span class="s2">            cont = 0</span>
<span class="s2">#DIVIDER</span>
<span class="s2">            esPrimeraFase = False</span>
<span class="s2">#DIVIDER</span>
<span class="s2">            for fp in fasesProyecto:</span>
<span class="s2">#DIVIDER</span>
<span class="s2">                cont = cont + 1</span>
<span class="s2">#DIVIDER</span>
<span class="s2">                if fp == fase:</span>
<span class="s2">#DIVIDER</span>
<span class="s2">                    if cont == 1:</span>
<span class="s2">#DIVIDER</span>
<span class="s2">                        esPrimeraFase = True</span>
<span class="s2">#DIVIDER</span>
<span class="s2">                        break</span>

<span class="s2">            &quot;Solo verificar si son items posteriores a la primera fase.&quot;</span>
<span class="s2">            if esPrimeraFase == False:</span>
<span class="s2">#DIVIDER</span>
<span class="s2">                anterior = None</span>
<span class="s2">#DIVIDER</span>
<span class="s2">                for fp in fasesProyecto:</span>
<span class="s2">#DIVIDER</span>
<span class="s2">                    if fp == fase:</span>
<span class="s2">#DIVIDER</span>
<span class="s2">                        break</span>
<span class="s2">#DIVIDER</span>
<span class="s2">                    anterior = fp</span>
<span class="s2">#DIVIDER</span>
<span class="s2">                listoAprobacion = False</span>
<span class="s2">#DIVIDER</span>
<span class="s2">                itemsRelacionados = item.relaciones.all()</span>
<span class="s2">#DIVIDER</span>
<span class="s2">                for ir in itemsRelacionados:</span>
<span class="s2">#DIVIDER</span>
<span class="s2">                    relacion = Relacion.objects.get(item_from=item, item_to=ir)</span>
<span class="s2">#DIVIDER</span>
<span class="s2">                    if relacion.fase_item_to == anterior and ir.estado == &quot;en linea base&quot;:</span>
<span class="s2">#DIVIDER</span>
<span class="s2">                        lineaBaseItem = LineaBase.objects.get(items__id=ir.id)</span>
<span class="s2">#DIVIDER</span>
<span class="s2">                        if lineaBaseItem.estado == &quot;cerrada&quot;:</span>
<span class="s2">#DIVIDER</span>
<span class="s2">                            listoAprobacion = True</span>
<span class="s2">#DIVIDER</span>
<span class="s2">                            break</span>
<span class="s2">#DIVIDER</span>
<span class="s2">                    if relacion.fase_item_to == fase and (ir.estado == &quot;aprobado&quot; or ir.estado == &quot;en linea base&quot;):</span>
<span class="s2">#DIVIDER</span>
<span class="s2">                        listoAprobacion = True</span>
<span class="s2">                        break</span>
<span class="s2">#DIVIDER</span>
<span class="s2">                if listoAprobacion == False:</span>
<span class="s2">                    mensaje_error = &quot;No es posible aprobar el item ya que este no posee una relacion con un item antecesor&quot; </span><span class="se">\</span>
<span class="s2">                                    &quot;en linea base cerrada, o bien, con un item padre aprobado.&quot;</span>
<span class="s2">#DIVIDER</span>
<span class="s2">                    return render(request, &#39;item/item.html&#39;,</span>
<span class="s2">                                  {&#39;faseid&#39;: dato[&#39;faseid&#39;], &#39;proyectoid&#39;: dato[&#39;proyectoid&#39;], &#39;item&#39;: item,</span>
<span class="s2">                                   &#39;campos&#39;: zip(item.tipoItem.campo_extra, item.campo_extra_valores),</span>
<span class="s2">                                   &#39;pendientePermiso&#39;: request.user.has_perm(&quot;establecer_itemPendienteAprob&quot;, fase),</span>
<span class="s2">                                   &#39;aprobadoPermiso&#39;: request.user.has_perm(&quot;aprove_item&quot;, fase),</span>
<span class="s2">                                   &#39;choices&#39;: [&#39;en desarrollo&#39;, &#39;pendiente de aprobacion&#39;, &#39;aprobado&#39;, ],</span>
<span class="s2">                                   &#39;mensaje_error&#39;: mensaje_error, })</span>
<span class="s2">#DIVIDER</span>
<span class="s2">        if proyecto.estado != &quot;inicializado&quot;:</span>
<span class="s2">#DIVIDER</span>
<span class="s2">            return redirect(&#39;faseView&#39;, faseid=dato[&#39;faseid&#39;], proyectoid=dato[&#39;proyectoid&#39;])</span>

<span class="s2">        mensaje = &quot;Estado actualizado correctamente.&quot;</span>
<span class="s2">#DIVIDER</span>
<span class="s2">        item.estado = dato[&#39;estado&#39;]</span>
<span class="s2">        item._history_date = datetime.now()</span>
<span class="s2">#DIVIDER</span>
<span class="s2">        item.save()</span>
<span class="s2">#DIVIDER</span>
<span class="s2">    return render(request, &#39;item/itemModificar.html&#39;,</span>
<span class="s2">                  {&#39;faseid&#39;: dato[&#39;faseid&#39;], &#39;proyectoid&#39;: dato[&#39;proyectoid&#39;], &#39;item&#39;: item,</span>
<span class="s2">                   &#39;campos&#39;: zip(item.tipoItem.campo_extra, item.campo_extra_valores),</span>
<span class="s2">                   &#39;pendientePermiso&#39;: request.user.has_perm(&quot;establecer_itemPendienteAprob&quot;, fase),</span>
<span class="s2">                   &#39;aprobadoPermiso&#39;: request.user.has_perm(&quot;aprove_item&quot;, fase),</span>
<span class="s2">                   &#39;choices&#39;: [&#39;en desarrollo&#39;, &#39;pendiente de aprobacion&#39;, &#39;aprobado&#39;, ],</span>
<span class="s2">                   &#39;mensaje_error&#39;: mensaje_error, })</span>
<span class="s2">#DIVIDER</span>
<span class="s2">def itemDeshabilitar(request):</span>
<span class="s2">#DIVIDER</span>
<span class="s2">    proyectoid = request.GET.get(&#39;proyectoid&#39;)</span>
<span class="s2">#DIVIDER</span>
<span class="s2">    proyecto = Proyecto.objects.get(id=proyectoid)</span>
<span class="s2">#DIVIDER</span>
<span class="s2">    faseid = request.GET.get(&#39;faseid&#39;)</span>
<span class="s2">#DIVIDER</span>
<span class="s2">    fase = Fase.objects.get(id=faseid)</span>
<span class="s2">#DIVIDER</span>
<span class="s2">    itemid = request.GET.get(&#39;itemid&#39;)</span>
<span class="s2">#DIVIDER</span>
<span class="s2">    item = Item.objects.get(id=itemid)</span>
<span class="s2">#DIVIDER</span>
<span class="s2">    if not (request.user.has_perm(&quot;unable_item&quot;, fase)) and not (request.user.has_perm(&quot;is_gerente&quot;, proyecto)):</span>
<span class="s2">#DIVIDER</span>
<span class="s2">        return redirect(&#39;/permissionError/&#39;)</span>
<span class="s2">#DIVIDER</span>
<span class="s2">    if proyecto.estado != &quot;inicializado&quot;:</span>
<span class="s2">#DIVIDER</span>
<span class="s2">        return redirect(&#39;proyectoView&#39;, id=proyectoid)</span>
<span class="s2">#DIVIDER</span>
<span class="s2">    if item.estado == &quot;pendiente de aprobacion&quot; or item.estado == &quot;aprobado&quot; or item.estado == &quot;en linea base&quot;:</span>
<span class="s2">        mensaje = &quot;El estado actual del item no permite la deshabilitacion del mismo.&quot;</span>
<span class="s2">#DIVIDER</span>
<span class="s2">        return render(request, &#39;home.html&#39;,</span>
<span class="s2">                      {&#39;proyectoid&#39;: proyectoid, &#39;faseid&#39;: faseid, &#39;itemid&#39;: itemid, &#39;mensaje&#39;: mensaje, })</span>
<span class="s2">#DIVIDER</span>
<span class="s2">    relaciones_item_deshabilitar = item.relaciones.all()</span>
<span class="s2">#DIVIDER</span>
<span class="s2">    ok_deshabilitar = True</span>
<span class="s2">#DIVIDER</span>
<span class="s2">    for rd in relaciones_item_deshabilitar:</span>
<span class="s2">#DIVIDER</span>
<span class="s2">        if rd.estado == &quot;aprobado&quot; or rd.estado == &quot;en linea base&quot;:</span>
<span class="s2">            &quot;Debe verificar que el item no quede sin al menos una relacion a otro item aprobado o antecesor en linea base.&quot;</span>
<span class="s2">            relaciones_item_afectado = rd.relaciones.exclude(id=item.id)</span>
<span class="s2">#DIVIDER</span>
<span class="s2">            ok_sobrevivir = False</span>
<span class="s2">            for r in relaciones_item_afectado:</span>
<span class="s2">                relacion = Relacion.objects.get(item_from=r, item_to=rd)</span>
<span class="s2">                if relacion.tipo == &quot;padre&quot; and (r.estado == &quot;aprobado&quot; or r.estado == &quot;en linea base&quot;):</span>
<span class="s2">                    ok_sobrevivir = True</span>
<span class="s2">                    break</span>
<span class="s2">                if relacion.tipo == &quot;antecesor&quot; and r.estado == &quot;en linea base&quot;:</span>
<span class="s2">                    lineaBaseItem = LineaBase.objects.get(items__id=r.id)</span>
<span class="s2">                    if lineaBaseItem.estado == &quot;cerrada&quot;:</span>
<span class="s2">                        ok_sobrevivir = True</span>
<span class="s2">                        break</span>

<span class="s2">            &quot;Si un item afectado no sobrevive ya no es posible deshabilitar el item deseado.&quot;</span>
<span class="s2">            if not ok_sobrevivir:</span>
<span class="s2">                ok_deshabilitar = False</span>

<span class="s2">    if ok_deshabilitar:</span>
<span class="s2">        for rd in relaciones_item_deshabilitar:</span>
<span class="s2">            relaciones_uno = Relacion.objects.get(item_from=item, item_to=rd)</span>
<span class="s2">            relaciones_uno.delete()</span>
<span class="s2">            relaciones_dos = Relacion.objects.get(item_from=rd, item_to=item)</span>
<span class="s2">            relaciones_dos.delete()</span>
<span class="s2">#DIVIDER</span>
<span class="s2">        item.estado = &quot;deshabilitado&quot;</span>
<span class="s2">        item._history_date = datetime.now()</span>
<span class="s2">#DIVIDER</span>
<span class="s2">        item.save()</span>
<span class="s2">#DIVIDER</span>
<span class="s2">        return redirect(&#39;proyectoView&#39;, id=proyectoid)</span>
<span class="s2">#DIVIDER</span>
<span class="s2">    return redirect(&#39;proyectoView&#39;, id=proyectoid)</span>
<span class="s2">#DIVIDER</span>
<span class="s2">def itemVerRelaciones(request, itemid, faseid, proyectoid, mensaje):</span>
<span class="s2">    if request.method == &#39;GET&#39;:</span>

<span class="s2">        proyecto = Proyecto.objects.get(id=proyectoid)</span>
<span class="s2">        fase = Fase.objects.get(id=faseid)</span>
<span class="s2">        fasesProyecto = proyecto.fases.exclude(estado=&quot;deshabilitada&quot;).order_by(&#39;id&#39;)</span>
<span class="s2">        varias_fases = False</span>

<span class="s2">        anterior = None</span>
<span class="s2">        siguiente = None</span>
<span class="s2">        if len(fasesProyecto) &gt; 1:</span>
<span class="s2">            varias_fases = True</span>
<span class="s2">            for fp in fasesProyecto:</span>
<span class="s2">                if fp == fase:</span>
<span class="s2">                    break</span>
<span class="s2">                anterior = fp</span>

<span class="s2">            actual = False</span>
<span class="s2">            for fp in fasesProyecto:</span>
<span class="s2">                if actual == True:</span>
<span class="s2">                    siguiente = fp</span>
<span class="s2">                    break</span>
<span class="s2">                if fp == fase:</span>
<span class="s2">                    actual = True</span>

<span class="s2">        item_recibido = Item.objects.get(id=itemid)</span>
<span class="s2">#DIVIDER</span>
<span class="s2">        items_antecesores = list(Relacion.objects.filter(tipo=&quot;sucesor&quot;, item_from=item_recibido))</span>
<span class="s2">#DIVIDER</span>

<span class="s2">#DIVIDER</span>
<span class="s2">        items_sucesores = list(Relacion.objects.filter(tipo=&quot;antecesor&quot;, item_from=item_recibido))</span>
<span class="s2">#DIVIDER</span>

<span class="s2">#DIVIDER</span>
<span class="s2">        items_padres = list(Relacion.objects.filter(tipo=&quot;hijo&quot;, item_from=item_recibido))</span>
<span class="s2">#DIVIDER</span>
<span class="s2">        fase_padre_hijo = fase</span>
<span class="s2">#DIVIDER</span>
<span class="s2">        items_hijos = list(Relacion.objects.filter(tipo=&quot;padre&quot;, item_from=item_recibido))</span>
<span class="s2">#DIVIDER</span>
<span class="s2">        puede_relacionarse = False</span>
<span class="s2">        if item_recibido.estado == &quot;aprobado&quot; or item_recibido.estado == &quot;en linea base&quot;:</span>
<span class="s2">            puede_relacionarse = True</span>
<span class="s2">#DIVIDER</span>
<span class="s2">        habilitar_Add_relacion = False</span>
<span class="s2">        &quot;Todos los id de las relaciones del item.&quot;</span>
<span class="s2">        relaciones = item_recibido.relaciones.all()</span>
<span class="s2">        relacionesId = []</span>
<span class="s2">        for r in relaciones:</span>
<span class="s2">            relacionesId.append(r.id)</span>
<span class="s2">        &quot;Solo si esta en linea base puede avanzar de fase.&quot;</span>
<span class="s2">        siguiente = None</span>
<span class="s2">        itemsFaseSiguiente = None</span>
<span class="s2">        if item_recibido.estado == &quot;en linea base&quot;:</span>
<span class="s2">            linea_base_item = LineaBase.objects.filter(items=item_recibido)</span>
<span class="s2">            if linea_base_item.get().estado == &quot;cerrada&quot;:</span>
<span class="s2">                fasesProyecto = proyecto.fases.exclude(estado=&quot;deshabilitada&quot;).order_by(&#39;id&#39;)</span>
<span class="s2">                actual = False</span>
<span class="s2">                for fp in fasesProyecto:</span>
<span class="s2">                    if actual == True:</span>
<span class="s2">                        siguiente = fp</span>
<span class="s2">                        break</span>
<span class="s2">                    if fp == fase:</span>
<span class="s2">                        actual = True</span>

<span class="s2">                if siguiente is not None:</span>
<span class="s2">                    itemsFaseSiguiente = siguiente.items.exclude(</span>
<span class="s2">                        Q(estado=&quot;deshabilitado&quot;) | Q(id__in=relaciones)).order_by(</span>
<span class="s2">                        &#39;id&#39;)</span>
<span class="s2">            else:</span>
<span class="s2">                itemsFaseSiguiente = None</span>
<span class="s2">        itemsFaseActual = fase.items.exclude(</span>
<span class="s2">            Q(estado=&quot;deshabilitado&quot;) | Q(id=itemid) | Q(id__in=relaciones)).order_by(&#39;id&#39;)</span>

<span class="s2">        &quot;Verifica si hay al menos un tem con el cual establecer relaciones&quot;</span>
<span class="s2">        if itemsFaseActual or itemsFaseSiguiente:</span>
<span class="s2">            habilitar_Add_relacion = True</span>

<span class="s2">        return render(request, &quot;item/ItemVerRelacion.html&quot;, {&#39;proyecto&#39;: proyecto, &#39;fase&#39;: fase, &#39;item&#39;: item_recibido,</span>
<span class="s2">                                                             &#39;antecesores&#39;: items_antecesores,</span>
<span class="s2">                                                             &#39;sucesores&#39;: items_sucesores,</span>
<span class="s2">                                                             &#39;padres&#39;: items_padres, &#39;hijos&#39;: items_hijos,</span>
<span class="s2">                                                             &#39;faseAnterior&#39;: anterior,</span>
<span class="s2">                                                             &#39;faseSiguiente&#39;: siguiente, &#39;varias_fases&#39;: varias_fases,</span>
<span class="s2">                                                             &#39;puede_relacionarse&#39;: puede_relacionarse,</span>
<span class="s2">                                                             &#39;habilitar_Add_relacion&#39;: habilitar_Add_relacion, &#39;mensaje&#39;:mensaje})</span>
<span class="s2">#DIVIDER</span>
<span class="s2">def itemRelacionesRemover(request,itemid,item_rm, faseid, proyectoid):</span>
<span class="s2">#DIVIDER</span>
<span class="s2">    if request.method ==&#39;GET&#39;:</span>
<span class="s2">#DIVIDER</span>
<span class="s2">        proyecto = Proyecto.objects.get(id=proyectoid)</span>
<span class="s2">#DIVIDER</span>
<span class="s2">        fase = Fase.objects.get(id=faseid)</span>
<span class="s2">#DIVIDER</span>
<span class="s2">        item_inicio = Item.objects.get(id=itemid)</span>
<span class="s2">        item_final_remover = Item.objects.get(id=item_rm)</span>
<span class="s2">        ok_remover_final = False</span>
<span class="s2">#DIVIDER</span>
<span class="s2">        ok_remover_inicio = False</span>
<span class="s2">        fasesProyecto = proyecto.fases.exclude(estado=&quot;deshabilitada&quot;).order_by(&#39;id&#39;)</span>
<span class="s2">        cont = 0</span>
<span class="s2">        esPrimeraFase = False</span>
<span class="s2">        for fp in fasesProyecto:</span>
<span class="s2">            cont = cont + 1</span>
<span class="s2">            if fp == fase:</span>
<span class="s2">                if cont == 1:</span>
<span class="s2">                    esPrimeraFase = True</span>
<span class="s2">                    break</span>
<span class="s2">        if not esPrimeraFase:</span>
<span class="s2">#DIVIDER</span>
<span class="s2">            if item_final_remover.estado == &quot;aprobado&quot; or item_final_remover.estado == &quot;en linea base&quot;:</span>
<span class="s2">                &quot;Debe verificar que el item no quede sin al menos una relacion a otro item aprobado o antecesor en linea base.&quot;</span>
<span class="s2">                relaciones_item_remover = item_final_remover.relaciones.exclude(id=item_inicio.id)</span>
<span class="s2">#DIVIDER</span>
<span class="s2">                for r in relaciones_item_remover:</span>
<span class="s2">#DIVIDER</span>
<span class="s2">                    relacion = Relacion.objects.get(item_from=r, item_to=item_final_remover)</span>
<span class="s2">#DIVIDER</span>
<span class="s2">                    if relacion.tipo == &quot;padre&quot; and (r.estado == &quot;aprobado&quot; or r.estado == &quot;en linea base&quot;):</span>
<span class="s2">#DIVIDER</span>
<span class="s2">                        ok_remover_final = True</span>
<span class="s2">#DIVIDER</span>
<span class="s2">                        break</span>
<span class="s2">#DIVIDER</span>
<span class="s2">                    if relacion.tipo == &quot;antecesor&quot; and r.estado == &quot;en linea base&quot;:</span>
<span class="s2">#DIVIDER</span>
<span class="s2">                        lineaBaseItem = LineaBase.objects.get(items__id=r.id)</span>
<span class="s2">#DIVIDER</span>
<span class="s2">                        if lineaBaseItem.estado == &quot;cerrada&quot;:</span>
<span class="s2">#DIVIDER</span>
<span class="s2">                            ok_remover_final = True</span>
<span class="s2">#DIVIDER</span>
<span class="s2">                            break</span>
<span class="s2">            else:</span>
<span class="s2">#DIVIDER</span>
<span class="s2">                ok_remover_final = True</span>

<span class="s2">            &quot;El mismo testeo para el item del cual queremos remover la relacion.&quot;</span>

<span class="s2">            &quot;Debe verificar que el item no quede sin al menos una relacion a otro item aprobado o antecesor en linea base.&quot;</span>
<span class="s2">            relaciones_item_inicio = item_inicio.relaciones.exclude(id=item_final_remover.id)</span>
<span class="s2">#DIVIDER</span>
<span class="s2">            for r in relaciones_item_inicio:</span>
<span class="s2">#DIVIDER</span>
<span class="s2">                relacion = Relacion.objects.get(item_from=r, item_to=item_inicio)</span>
<span class="s2">#DIVIDER</span>
<span class="s2">                if relacion.tipo == &quot;padre&quot; and (r.estado == &quot;aprobado&quot; or r.estado == &quot;en linea base&quot;):</span>
<span class="s2">#DIVIDER</span>
<span class="s2">                    ok_remover_inicio = True</span>
<span class="s2">#DIVIDER</span>
<span class="s2">                    break</span>
<span class="s2">#DIVIDER</span>
<span class="s2">                if relacion.tipo == &quot;antecesor&quot; and r.estado == &quot;en linea base&quot;:</span>
<span class="s2">#DIVIDER</span>
<span class="s2">                    lineaBaseItem = LineaBase.objects.get(items__id=r.id)</span>
<span class="s2">#DIVIDER</span>
<span class="s2">                    if lineaBaseItem.estado == &quot;cerrada&quot;:</span>
<span class="s2">#DIVIDER</span>
<span class="s2">                        ok_remover_inicio = True</span>
<span class="s2">#DIVIDER</span>
<span class="s2">                        break</span>
<span class="s2">        else:</span>
<span class="s2">            ok_remover_inicio = True</span>
<span class="s2">            ok_remover_final = True</span>
<span class="s2">#DIVIDER</span>
<span class="s2">        if ok_remover_inicio and ok_remover_final:</span>
<span class="s2">#DIVIDER</span>
<span class="s2">            relaciones_uno = Relacion.objects.get(item_from=item_inicio, item_to=item_final_remover)</span>
<span class="s2">#DIVIDER</span>
<span class="s2">            relaciones_uno.delete()</span>
<span class="s2">#DIVIDER</span>
<span class="s2">            relaciones_dos = Relacion.objects.get(item_from=item_final_remover, item_to=item_inicio)</span>
<span class="s2">#DIVIDER</span>
<span class="s2">            relaciones_dos.delete()</span>
<span class="s2">#DIVIDER</span>
<span class="s2">            return redirect(&#39;itemVerRelaciones&#39;, itemid=item_inicio.id, faseid=faseid, proyectoid=proyectoid, mensaje=&#39; &#39;)</span>
<span class="s2">#DIVIDER</span>
<span class="s2">        return redirect(&#39;itemVerRelaciones&#39;, itemid=item_inicio.id, faseid=faseid, proyectoid=proyectoid, mensaje=&#39; &#39;)</span>
<span class="s2">#DIVIDER</span>
<span class="s2">def itemAddRelacion(request):</span>
<span class="s2">#DIVIDER</span>

<span class="s2">    if request.method == &#39;GET&#39;:</span>
<span class="s2">#DIVIDER</span>
<span class="s2">        proyectoid = request.GET.get(&#39;proyectoid&#39;)</span>
<span class="s2">#DIVIDER</span>
<span class="s2">        proyecto = Proyecto.objects.get(id=proyectoid)</span>
<span class="s2">#DIVIDER</span>
<span class="s2">        faseid = request.GET.get(&#39;faseid&#39;)</span>
<span class="s2">#DIVIDER</span>
<span class="s2">        fase = Fase.objects.get(id=faseid)</span>
<span class="s2">#DIVIDER</span>
<span class="s2">        itemid = request.GET.get(&#39;itemid&#39;)</span>
<span class="s2">#DIVIDER</span>
<span class="s2">        item = Item.objects.get(id=itemid)</span>
<span class="s2">#DIVIDER</span>
<span class="s2">        if not (request.user.has_perm(&quot;relacionar_item&quot;, fase)) and not (request.user.has_perm(&quot;is_gerente&quot;, proyecto)):</span>
<span class="s2">#DIVIDER</span>
<span class="s2">            return redirect(&#39;/permissionError/&#39;)</span>
<span class="s2">        if item.estado != &quot;aprobado&quot; and item.estado != &quot;en linea base&quot;:</span>
<span class="s2">            return redirect(&#39;itemVerRelaciones&#39;, itemid=itemid, faseid=faseid, proyectoid=proyectoid, mensaje=&#39; &#39;)</span>

<span class="s2">        &quot;Todos los id de las relaciones del item.&quot;</span>
<span class="s2">        relaciones = item.relaciones.all()</span>
<span class="s2">#DIVIDER</span>
<span class="s2">        relacionesId = []</span>
<span class="s2">#DIVIDER</span>
<span class="s2">        for r in relaciones:</span>
<span class="s2">#DIVIDER</span>
<span class="s2">            relacionesId.append(r.id)</span>
<span class="s2">        &quot;Solo si esta en linea base puede avanzar de fase.&quot;</span>
<span class="s2">#DIVIDER</span>
<span class="s2">        siguiente = None</span>
<span class="s2">#DIVIDER</span>
<span class="s2">        itemsFaseSiguiente = None</span>
<span class="s2">#DIVIDER</span>
<span class="s2">        if item.estado == &quot;en linea base&quot;:</span>
<span class="s2">#DIVIDER</span>
<span class="s2">            linea_base_item = LineaBase.objects.filter(items=item)</span>
<span class="s2">#DIVIDER</span>
<span class="s2">            if linea_base_item.get().estado == &quot;cerrada&quot;:</span>
<span class="s2">#DIVIDER</span>
<span class="s2">                fasesProyecto = proyecto.fases.exclude(estado=&quot;deshabilitada&quot;).order_by(&#39;id&#39;)</span>
<span class="s2">#DIVIDER</span>
<span class="s2">                actual = False</span>
<span class="s2">#DIVIDER</span>
<span class="s2">                for fp in fasesProyecto:</span>
<span class="s2">#DIVIDER</span>
<span class="s2">                    if actual == True:</span>
<span class="s2">#DIVIDER</span>
<span class="s2">                        siguiente = fp</span>
<span class="s2">#DIVIDER</span>
<span class="s2">                        break</span>
<span class="s2">#DIVIDER</span>
<span class="s2">                    if fp == fase:</span>
<span class="s2">#DIVIDER</span>
<span class="s2">                        actual = True</span>
<span class="s2">#DIVIDER</span>
<span class="s2">                if siguiente is not None:</span>
<span class="s2">#DIVIDER</span>
<span class="s2">                    itemsFaseSiguiente = siguiente.items.exclude(Q(estado=&quot;deshabilitado&quot;) | Q(id__in=relaciones)).order_by(&#39;id&#39;)</span>
<span class="s2">            else:</span>
<span class="s2">#DIVIDER</span>
<span class="s2">                itemsFaseSiguiente = None</span>
<span class="s2">#DIVIDER</span>
<span class="s2">        itemsFaseActual = fase.items.exclude(</span>
<span class="s2">            Q(estado=&quot;deshabilitado&quot;) | Q(id=itemid) | Q(id__in=relaciones)).order_by(&#39;id&#39;)</span>
<span class="s2">#DIVIDER</span>
<span class="s2">        return render(request, &#39;item/itemAddRelacion.html&#39;,</span>
<span class="s2">                      {&#39;proyecto&#39;: proyecto, &#39;fase&#39;: fase, &#39;item&#39;: item,</span>
<span class="s2">                       &#39;itemsFaseSiguiente&#39;: itemsFaseSiguiente, &#39;itemsFaseActual&#39;: itemsFaseActual,</span>
<span class="s2">                       &#39;faseSiguiente&#39;: siguiente, })</span>

<span class="s2">    else:</span>
<span class="s2">#DIVIDER</span>

<span class="s2">#DIVIDER</span>
<span class="s2">        proyectoid = request.POST.get(&#39;proyectoid&#39;)</span>
<span class="s2">#DIVIDER</span>
<span class="s2">        proyecto = Proyecto.objects.get(id=proyectoid)</span>
<span class="s2">#DIVIDER</span>
<span class="s2">        faseid = request.POST.get(&#39;faseid&#39;)</span>
<span class="s2">#DIVIDER</span>
<span class="s2">        fase = Fase.objects.get(id=faseid)</span>
<span class="s2">#DIVIDER</span>
<span class="s2">        itemIdActual = request.POST.get(&#39;itemIdActual&#39;)</span>
<span class="s2">#DIVIDER</span>
<span class="s2">        itemActual = Item.objects.get(id=itemIdActual)</span>
<span class="s2">#DIVIDER</span>
<span class="s2">        itemIdRelacion = request.POST.get(&#39;itemIdRelacion&#39;)</span>
<span class="s2">#DIVIDER</span>
<span class="s2">        itemRelacion = Item.objects.get(id=itemIdRelacion)</span>
<span class="s2">#DIVIDER</span>
<span class="s2">        faseSiguiente = request.POST.get(&#39;siguiente&#39;)</span>
<span class="s2">#DIVIDER</span>
<span class="s2">        fasesProyecto = proyecto.fases.exclude(estado=&quot;deshabilitada&quot;).order_by(&#39;id&#39;)</span>
<span class="s2">#DIVIDER</span>
<span class="s2">        for fp in fasesProyecto:</span>
<span class="s2">#DIVIDER</span>
<span class="s2">            items = fp.items.all()</span>
<span class="s2">#DIVIDER</span>
<span class="s2">            for i in items:</span>
<span class="s2">#DIVIDER</span>
<span class="s2">                if i == itemRelacion:</span>
<span class="s2">#DIVIDER</span>
<span class="s2">                    if faseSiguiente != &quot;no&quot;:</span>
<span class="s2">#DIVIDER</span>
<span class="s2">                        if int(fp.id) == int(faseSiguiente):</span>
<span class="s2">#DIVIDER</span>
<span class="s2">                            Relacion.objects.create(tipo=&quot;antecesor&quot;, item_from=itemActual, item_to=itemRelacion, fase_item_to=fp)</span>
<span class="s2">#DIVIDER</span>
<span class="s2">                            Relacion.objects.create(tipo=&quot;sucesor&quot;, item_from=itemRelacion, item_to=itemActual,</span>
<span class="s2">                                                    fase_item_to=fase)</span>
<span class="s2">#DIVIDER</span>
<span class="s2">                    if fp == fase:</span>
<span class="s2">#DIVIDER</span>
<span class="s2">                        Relacion.objects.create(tipo=&quot;padre&quot;, item_from=itemActual, item_to=itemRelacion,fase_item_to=fp)</span>
<span class="s2">#DIVIDER</span>
<span class="s2">                        Relacion.objects.create(tipo=&quot;hijo&quot;, item_from=itemRelacion, item_to=itemActual,</span>
<span class="s2">                                                fase_item_to=fase )</span>
<span class="s2">#DIVIDER</span>
<span class="s2">        cantidad_items_proyecto = 0</span>
<span class="s2">        for fp in fasesProyecto:</span>
<span class="s2">            cantidad_items_proyecto = cantidad_items_proyecto + int(fp.items.exclude(estado=&quot;deshabilitado&quot;).count())</span>

<span class="s2">        V = cantidad_items_proyecto</span>
<span class="s2">        adj = </span><span class="si">{}</span><span class="s2"></span>
<span class="s2">        for fp in fasesProyecto:</span>
<span class="s2">            itemsFase = fp.items.exclude(estado=&quot;deshabilitado&quot;)</span>
<span class="s2">            for iF in itemsFase:</span>
<span class="s2">                relaciones_por_item = []</span>
<span class="s2">                relaciones = Relacion.objects.filter((Q(tipo=&quot;antecesor&quot;) | Q(tipo=&quot;padre&quot;)) &amp; Q(item_from=iF))</span>
<span class="s2">                for r in relaciones:</span>
<span class="s2">                    relaciones_por_item.append(int(r.item_to.id))</span>

<span class="s2">                adj[int(iF.id)] = relaciones_por_item</span>
<span class="s2">#DIVIDER</span>
<span class="s2">        if isCyclicDisconnected(adj, V):</span>
<span class="s2">            relaciones_uno = Relacion.objects.get(item_from=itemActual, item_to=itemRelacion)</span>
<span class="s2">            relaciones_uno.delete()</span>
<span class="s2">            relaciones_dos = Relacion.objects.get(item_from=itemRelacion, item_to=itemActual)</span>
<span class="s2">            relaciones_dos.delete(),</span>
<span class="s2">            return redirect(&#39;itemVerRelaciones&#39;, itemid=itemIdActual, faseid=faseid, proyectoid=proyectoid,</span>
<span class="s2">                            mensaje=&quot;Error! No se puede relacionar porque genera un ciclo.&quot;)</span>
<span class="s2">#DIVIDER</span>
<span class="s2">        return redirect(&#39;itemVerRelaciones&#39;, itemid=itemActual.id, faseid=faseid, proyectoid=proyectoid,</span>
<span class="s2">                        mensaje=&#39; &#39;)</span>
<span class="s2">#DIVIDER</span>
<span class="s2">def addEdge(adj: dict, u, v):</span>
<span class="s2">    adj[u].append(v)</span>
<span class="s2">    adj[v].append(u)</span>
<span class="s2">#DIVIDER</span>
<span class="s2">def isCyclicConnected(adj: dict, s, V,</span>
<span class="s2">                      visited: dict):</span>
<span class="s2">#DIVIDER</span>
<span class="s2">    parent = </span><span class="si">{}</span><span class="s2"></span>
<span class="s2">    for key, value in adj.items():</span>
<span class="s2">        parent[key] = -1</span>
<span class="s2">#DIVIDER</span>
<span class="s2">    q = []</span>
<span class="s2">#DIVIDER</span>
<span class="s2">    visited[s] = True</span>
<span class="s2">    q.append(s)</span>

<span class="s2">    while q != []:</span>
<span class="s2">#DIVIDER</span>
<span class="s2">        u = q.pop()</span>
<span class="s2">#DIVIDER</span>
<span class="s2">        for v in adj[u]:</span>
<span class="s2">            if not visited[v]:</span>
<span class="s2">                visited[v] = True</span>
<span class="s2">                q.append(v)</span>
<span class="s2">                parent[v] = u</span>
<span class="s2">            elif parent[u] != v:</span>
<span class="s2">                return True</span>

<span class="s2">    return False</span>
<span class="s2">#DIVIDER</span>
<span class="s2">def isCyclicDisconnected(adj: dict, V):</span>
<span class="s2">#DIVIDER</span>
<span class="s2">    visited = </span><span class="si">{}</span><span class="s2"></span>
<span class="s2">    for key, value in adj.items():</span>
<span class="s2">        visited[key] = False</span>

<span class="s2">    for key, value in adj.items():</span>
<span class="s2">        if not visited[key] and </span><span class="se">\</span>
<span class="s2">                isCyclicConnected(adj, key, V, visited):</span>
<span class="s2">            return True</span>
<span class="s2">    return False</span>
<span class="s2">#DIVIDER</span>
<span class="s2">def faseGestionLineaBase(request):</span>
<span class="s2">#DIVIDER</span>
<span class="s2">    if request.method == &#39;GET&#39;:</span>
<span class="s2">#DIVIDER</span>
<span class="s2">        proyectoid = request.GET.get(&#39;proyectoid&#39;)</span>
<span class="s2">#DIVIDER</span>
<span class="s2">        faseid = request.GET.get(&#39;faseid&#39;)</span>
<span class="s2">#DIVIDER</span>
<span class="s2">        fase = Fase.objects.get(id=faseid)</span>
<span class="s2">#DIVIDER</span>
<span class="s2">        proyecto = Proyecto.objects.get(id=proyectoid)</span>
<span class="s2">#DIVIDER</span>
<span class="s2">        if not (request.user.has_perm(&quot;ver_lineaBase&quot;, fase)) and not (request.user.has_perm(&quot;is_gerente&quot;, proyecto)):</span>
<span class="s2">#DIVIDER</span>
<span class="s2">            return redirect(&#39;/permissionError/&#39;)</span>
<span class="s2">#DIVIDER</span>
<span class="s2">        lineasBase = fase.lineasBase.exclude(estado=&quot;rota&quot;)</span>
<span class="s2">#DIVIDER</span>
<span class="s2">        items_disponibles = fase.items.filter(estado=&quot;aprobado&quot;)</span>
<span class="s2">#DIVIDER</span>
<span class="s2">        if items_disponibles:</span>
<span class="s2">#DIVIDER</span>
<span class="s2">            crear_lb = True</span>
<span class="s2">        else:</span>
<span class="s2">#DIVIDER</span>
<span class="s2">            crear_lb = False</span>
<span class="s2">#DIVIDER</span>
<span class="s2">        return render(request, &quot;fase/faseGestionLineaBase.html&quot;,</span>
<span class="s2">                      {&#39;fase&#39;: fase, &#39;proyecto&#39;: proyecto, &#39;lineasBase&#39;: lineasBase, &#39;crear_lb&#39;: crear_lb})</span>
<span class="s2">#DIVIDER</span>
<span class="s2">def consultarLineaBase(request,proyectoid,faseid,lineaBaseid):</span>
<span class="s2">#DIVIDER</span>
<span class="s2">    if request.method == &quot;GET&quot;:</span>
<span class="s2">#DIVIDER</span>
<span class="s2">        proyecto = Proyecto.objects.get(id=proyectoid)</span>
<span class="s2">#DIVIDER</span>
<span class="s2">        fase = Fase.objects.get(id=faseid)</span>
<span class="s2">#DIVIDER</span>
<span class="s2">        lineaBase = LineaBase.objects.get(id=lineaBaseid)</span>
<span class="s2">#DIVIDER</span>
<span class="s2">        items_lb = lineaBase.items.all() #probablemente hace falta excluir deshabilitados</span>
<span class="s2">#DIVIDER</span>
<span class="s2">        return render(request, &quot;fase/lineaBaseConsultar.html&quot;, {&#39;proyecto&#39;: proyecto, &#39;fase&#39;: fase,</span>
<span class="s2">                                                                &#39;items&#39;: items_lb, &#39;lineaBase&#39;: lineaBase, })</span>
<span class="s2">#DIVIDER</span>
<span class="s2">def faseAddLineaBase(request):</span>
<span class="s2">#DIVIDER</span>
<span class="s2">    if request.method == &quot;POST&quot;:</span>
<span class="s2">#DIVIDER</span>
<span class="s2">        proyecto = Proyecto.objects.get(id=request.POST.get(&#39;proyectoid&#39;))</span>
<span class="s2">#DIVIDER</span>
<span class="s2">        fase = Fase.objects.get(id=request.POST.get(&#39;faseid&#39;))</span>
<span class="s2">#DIVIDER</span>
<span class="s2">        nombre = request.POST.get(&#39;nombre&#39;)</span>
<span class="s2">#DIVIDER</span>
<span class="s2">        items = request.POST.getlist(&#39;items&#39;)</span>
<span class="s2">#DIVIDER</span>
<span class="s2">        lineaBase = LineaBase.objects.create(nombre=nombre, estado=&quot;abierta&quot;, creador=request.user)</span>
<span class="s2">#DIVIDER</span>
<span class="s2">        for i in items:</span>
<span class="s2">#DIVIDER</span>
<span class="s2">            item = Item.objects.get(id=i)</span>
<span class="s2">#DIVIDER</span>
<span class="s2">            item.estado = &quot;en linea base&quot;</span>
<span class="s2">#DIVIDER</span>
<span class="s2">            item._history_date = datetime.now()</span>
<span class="s2">#DIVIDER</span>
<span class="s2">            item.save()</span>
<span class="s2">#DIVIDER</span>
<span class="s2">            lineaBase.items.add(item)</span>
<span class="s2">#DIVIDER</span>
<span class="s2">        lineaBase.save()</span>
<span class="s2">#DIVIDER</span>
<span class="s2">        fase.lineasBase.add(lineaBase)</span>
<span class="s2">#DIVIDER</span>
<span class="s2">        fase.save()</span>
<span class="s2">#DIVIDER</span>
<span class="s2">        lineasBase = fase.lineasBase.exclude(estado=&quot;rota&quot;)</span>
<span class="s2">#DIVIDER</span>
<span class="s2">        items_disponibles = fase.items.filter(estado=&quot;aprobado&quot;)</span>
<span class="s2">#DIVIDER</span>
<span class="s2">        if items_disponibles:</span>
<span class="s2">#DIVIDER</span>
<span class="s2">            crear_lb = True</span>
<span class="s2">        else:</span>
<span class="s2">#DIVIDER</span>
<span class="s2">            crear_lb = False</span>
<span class="s2">#DIVIDER</span>
<span class="s2">        return render(request, &quot;fase/faseGestionLineaBase.html&quot;,</span>
<span class="s2">                      {&#39;fase&#39;: fase, &#39;proyecto&#39;: proyecto, &#39;linea&#39;</span>
<span class="s2">                                                           &#39;sBase&#39;: lineasBase, &#39;crear_lb&#39;: crear_lb})</span>
<span class="s2">#DIVIDER</span>
<span class="s2">    proyecto = Proyecto.objects.get(id=request.GET.get(&#39;proyectoid&#39;))</span>
<span class="s2">    fase = Fase.objects.get(id=request.GET.get(&#39;faseid&#39;))</span>
<span class="s2">#DIVIDER</span>
<span class="s2">    if not (request.user.has_perm(&quot;create_lineaBase&quot;, fase)) and not (request.user.has_perm(&quot;is_gerente&quot;, proyecto)):</span>
<span class="s2">        return redirect(&#39;/permissionError/&#39;)</span>
<span class="s2">#DIVIDER</span>
<span class="s2">    if proyecto.estado != &quot;inicializado&quot;:</span>
<span class="s2">#DIVIDER</span>
<span class="s2">        return redirect(&#39;faseView&#39;, faseid=fase.id, proyectoid=proyecto.id)</span>
<span class="s2">#DIVIDER</span>
<span class="s2">    itemsAprobados = fase.items.filter(estado=&quot;aprobado&quot;)</span>
<span class="s2">#DIVIDER</span>
<span class="s2">    cantidad = fase.lineasBase.all().count()</span>
<span class="s2">#DIVIDER</span>
<span class="s2">    nombre = &quot;LineaBase&quot; + str(cantidad + 1) + &quot;-&quot; + fase.nombre</span>
<span class="s2">#DIVIDER</span>
<span class="s2">    return render(request, &quot;fase/faseAddLineaBase.html&quot;, {&#39;proyecto&#39;: proyecto, &#39;fase&#39;: fase,</span>
<span class="s2">                                                          &#39;items&#39;: itemsAprobados, &#39;nombre&#39;: nombre, })</span>
<span class="s2">#DIVIDER</span>
<span class="s2">def faseConfigLineaBase(request, proyectoid, faseid, lineaBaseid):</span>
<span class="s2">#DIVIDER</span>
<span class="s2">    if request.method == &#39;GET&#39;:</span>
<span class="s2">#DIVIDER</span>
<span class="s2">        fase = Fase.objects.get(id=faseid)</span>
<span class="s2">#DIVIDER</span>
<span class="s2">        proyecto = Proyecto.objects.get(id=proyectoid)</span>
<span class="s2">#DIVIDER</span>
<span class="s2">        lineaBase = LineaBase.objects.get(id=lineaBaseid)</span>
<span class="s2">#DIVIDER</span>
<span class="s2">        if not (request.user.has_perm(&quot;ver_lineaBase&quot;, fase)) and not (request.user.has_perm(&quot;is_gerente&quot;, proyecto)):</span>
<span class="s2">#DIVIDER</span>
<span class="s2">            return redirect(&#39;/permissionError/&#39;)</span>
<span class="s2">#DIVIDER</span>
<span class="s2">        items = lineaBase.items.all().order_by(&#39;id&#39;)</span>
<span class="s2">#DIVIDER</span>
<span class="s2">        items_disponibles = fase.items.filter(estado=&quot;aprobado&quot;)</span>
<span class="s2">#DIVIDER</span>
<span class="s2">        if items_disponibles:</span>
<span class="s2">#DIVIDER</span>
<span class="s2">            crear_lb = True</span>
<span class="s2">        else:</span>
<span class="s2">#DIVIDER</span>
<span class="s2">            crear_lb = False</span>
<span class="s2">#DIVIDER</span>
<span class="s2">        return render(request, &quot;fase/faseConfigLineaBase.html&quot;,</span>
<span class="s2">                      {&#39;fase&#39;: fase, &#39;proyecto&#39;: proyecto, &#39;items&#39;: items, &#39;lineaBase&#39;: lineaBase,</span>
<span class="s2">                       &#39;crear_lb&#39;: crear_lb})</span>
<span class="s2">#DIVIDER</span>
<span class="s2">def lineaBaseAddItem(request):</span>
<span class="s2">#DIVIDER</span>
<span class="s2">    if request.method == &#39;GET&#39;:</span>
<span class="s2">#DIVIDER</span>
<span class="s2">        proyectoid = request.GET.get(&#39;proyectoid&#39;)</span>
<span class="s2">#DIVIDER</span>
<span class="s2">        faseid = request.GET.get(&#39;faseid&#39;)</span>
<span class="s2">#DIVIDER</span>
<span class="s2">        lineaBaseid = request.GET.get(&#39;lineaBaseid&#39;)</span>
<span class="s2">#DIVIDER</span>
<span class="s2">        fase = Fase.objects.get(id=faseid)</span>
<span class="s2">#DIVIDER</span>
<span class="s2">        proyecto = Proyecto.objects.get(id=proyectoid)</span>
<span class="s2">#DIVIDER</span>
<span class="s2">        lineaBase = LineaBase.objects.get(id=lineaBaseid)</span>
<span class="s2">#DIVIDER</span>
<span class="s2">        if not (request.user.has_perm(&quot;modify_lineaBase&quot;, fase)) and not (request.user.has_perm(&quot;is_gerente&quot;, proyecto)):</span>
<span class="s2">#DIVIDER</span>
<span class="s2">            return redirect(&#39;/permissionError/&#39;)</span>

<span class="s2">        &quot;No se pueden agregar en una linea base cerrada o rota&quot;</span>
<span class="s2">        if lineaBase.estado != &quot;abierta&quot;:</span>
<span class="s2">#DIVIDER</span>
<span class="s2">            itemsLineaBase = lineaBase.items.all().order_by(&#39;id&#39;)</span>
<span class="s2">#DIVIDER</span>
<span class="s2">            return render(request, &quot;fase/faseConfigLineaBase.html&quot;,</span>
<span class="s2">                          {&#39;fase&#39;: fase, &#39;proyecto&#39;: proyecto, &#39;items&#39;: itemsLineaBase, &#39;lineaBase&#39;: lineaBase, })</span>
<span class="s2">#DIVIDER</span>
<span class="s2">        items_disponibles = fase.items.filter(estado=&quot;aprobado&quot;)</span>
<span class="s2">#DIVIDER</span>
<span class="s2">        return render(request, &#39;fase/lineaBaseAddItem.html&#39;,</span>
<span class="s2">                      {&#39;proyecto&#39;: proyecto, &#39;fase&#39;: fase, &#39;lineaBase&#39;: lineaBase, &#39;items&#39;: items_disponibles, })</span>

<span class="s2">    else:</span>
<span class="s2">#DIVIDER</span>
<span class="s2">        proyectoid = request.POST.get(&#39;proyectoid&#39;)</span>
<span class="s2">#DIVIDER</span>
<span class="s2">        faseid = request.POST.get(&#39;faseid&#39;)</span>
<span class="s2">#DIVIDER</span>
<span class="s2">        lineaBaseid = request.POST.get(&#39;lineaBaseid&#39;)</span>
<span class="s2">#DIVIDER</span>
<span class="s2">        fase = Fase.objects.get(id=faseid)</span>
<span class="s2">#DIVIDER</span>
<span class="s2">        proyecto = Proyecto.objects.get(id=proyectoid)</span>
<span class="s2">#DIVIDER</span>
<span class="s2">        lineaBase = LineaBase.objects.get(id=lineaBaseid)</span>
<span class="s2">#DIVIDER</span>
<span class="s2">        items = request.POST.getlist(&#39;items&#39;)</span>
<span class="s2">#DIVIDER</span>
<span class="s2">        for i in items:</span>
<span class="s2">#DIVIDER</span>
<span class="s2">            item = Item.objects.get(id=i)</span>
<span class="s2">#DIVIDER</span>
<span class="s2">            item.estado = &quot;en linea base&quot;</span>
<span class="s2">#DIVIDER</span>
<span class="s2">            item._history_date = datetime.now()</span>
<span class="s2">#DIVIDER</span>
<span class="s2">            item.save()</span>
<span class="s2">#DIVIDER</span>
<span class="s2">            lineaBase.items.add(item)</span>
<span class="s2">#DIVIDER</span>
<span class="s2">        lineaBase.save()</span>
<span class="s2">#DIVIDER</span>
<span class="s2">        itemsLineaBase = lineaBase.items.all().order_by(&#39;id&#39;)</span>
<span class="s2">#DIVIDER</span>
<span class="s2">        return render(request, &quot;fase/faseConfigLineaBase.html&quot;,</span>
<span class="s2">                      {&#39;fase&#39;: fase, &#39;proyecto&#39;: proyecto, &#39;items&#39;: itemsLineaBase, &#39;lineaBase&#39;: lineaBase, })</span>
<span class="s2">#DIVIDER</span>
<span class="s2">def lineaBaseRemoveItem(request, proyectoid, faseid, lineaBaseid, itemid):</span>
<span class="s2">#DIVIDER</span>
<span class="s2">    if request.method == &#39;GET&#39;:</span>
<span class="s2">#DIVIDER</span>
<span class="s2">        proyecto = Proyecto.objects.get(id=proyectoid)</span>
<span class="s2">#DIVIDER</span>
<span class="s2">        fase = Fase.objects.get(id=faseid)</span>
<span class="s2">#DIVIDER</span>
<span class="s2">        lineaBase = LineaBase.objects.get(id=lineaBaseid)</span>
<span class="s2">#DIVIDER</span>
<span class="s2">        item_remover = Item.objects.get(id=itemid)</span>
<span class="s2">#DIVIDER</span>
<span class="s2">        if not (request.user.has_perm(&quot;modify_lineaBase&quot;, fase)) and not (</span>
<span class="s2">                request.user.has_perm(&quot;is_gerente&quot;, proyecto)):</span>
<span class="s2">#DIVIDER</span>
<span class="s2">            return redirect(&#39;/permissionError/&#39;)</span>


<span class="s2">        &quot;No se pueden agregar en una linea base cerrada o rota&quot;</span>
<span class="s2">        if lineaBase.estado != &quot;abierta&quot;:</span>
<span class="s2">#DIVIDER</span>
<span class="s2">            itemsLineaBase = lineaBase.items.all().order_by(&#39;id&#39;)</span>
<span class="s2">#DIVIDER</span>
<span class="s2">            return render(request, &quot;fase/faseConfigLineaBase.html&quot;,</span>
<span class="s2">                          {&#39;fase&#39;: fase, &#39;proyecto&#39;: proyecto, &#39;items&#39;: itemsLineaBase, &#39;lineaBase&#39;: lineaBase, })</span>
<span class="s2">#DIVIDER</span>
<span class="s2">        lineaBase.items.remove(item_remover)</span>
<span class="s2">#DIVIDER</span>
<span class="s2">        lineaBase.save()</span>
<span class="s2">#DIVIDER</span>
<span class="s2">        item_remover.estado = &quot;aprobado&quot;</span>
<span class="s2">#DIVIDER</span>
<span class="s2">        item_remover._history_date = datetime.now()</span>
<span class="s2">#DIVIDER</span>
<span class="s2">        item_remover.save()</span>
<span class="s2">#DIVIDER</span>
<span class="s2">        itemsLineaBase = lineaBase.items.all().order_by(&#39;id&#39;)</span>
<span class="s2">#DIVIDER</span>
<span class="s2">        return render(request, &quot;fase/faseConfigLineaBase.html&quot;,</span>
<span class="s2">                      {&#39;fase&#39;: fase, &#39;proyecto&#39;: proyecto, &#39;items&#39;: itemsLineaBase, &#39;lineaBase&#39;: lineaBase, })</span>
<span class="s2">#DIVIDER</span>
<span class="s2">def faseCerrarLineaBase(request,proyectoid,faseid,lineaBaseid):</span>
<span class="s2">#DIVIDER</span>
<span class="s2">    if request.method == &#39;GET&#39;:</span>
<span class="s2">#DIVIDER</span>
<span class="s2">        proyecto = Proyecto.objects.get(id=proyectoid)</span>
<span class="s2">#DIVIDER</span>
<span class="s2">        fase = Fase.objects.get(id=faseid)</span>
<span class="s2">#DIVIDER</span>
<span class="s2">        lineaBase = LineaBase.objects.get(id=lineaBaseid)</span>
<span class="s2">#DIVIDER</span>
<span class="s2">        if not (request.user == lineaBase.creador):</span>
<span class="s2">#DIVIDER</span>
<span class="s2">            return redirect(&#39;/permissionError/&#39;)</span>
<span class="s2">#DIVIDER</span>
<span class="s2">        if not lineaBase.items.all():</span>
<span class="s2">#DIVIDER</span>
<span class="s2">            itemsLineaBase = lineaBase.items.all().order_by(&#39;id&#39;)</span>
<span class="s2">#DIVIDER</span>
<span class="s2">            return render(request, &quot;fase/faseConfigLineaBase.html&quot;,</span>
<span class="s2">                          {&#39;fase&#39;: fase, &#39;proyecto&#39;: proyecto, &#39;items&#39;: itemsLineaBase, &#39;lineaBase&#39;: lineaBase, })</span>
<span class="s2">#DIVIDER</span>
<span class="s2">        lineaBase.estado = &quot;cerrada&quot;</span>
<span class="s2">#DIVIDER</span>
<span class="s2">        lineaBase.save()</span>
<span class="s2">#DIVIDER</span>
<span class="s2">        lineasBase = fase.lineasBase.exclude(estado=&quot;rota&quot;)</span>
<span class="s2">#DIVIDER</span>
<span class="s2">        return render(request, &quot;fase/faseGestionLineaBase.html&quot;,</span>
<span class="s2">                      {&#39;fase&#39;: fase, &#39;proyecto&#39;: proyecto, &#39;lineasBase&#39;: lineasBase, })</span>
<span class="s2">#DIVIDER</span>
<span class="s2">def itemHistorial(request):</span>
<span class="s2">    if request.method == &#39;GET&#39;:</span>
<span class="s2">        proyectoid = request.GET.get(&#39;proyectoid&#39;)</span>
<span class="s2">        proyecto = Proyecto.objects.get(id=proyectoid)</span>
<span class="s2">        faseid = request.GET.get(&#39;faseid&#39;)</span>
<span class="s2">        itemid = request.GET.get(&#39;itemid&#39;)</span>
<span class="s2">        item = Item.objects.get(id=itemid)</span>
<span class="s2">        fase = Fase.objects.get(id=faseid)</span>
<span class="s2">        &quot;Creacion de una lista con los historiales de cambios del item&quot;</span>
<span class="s2">        lista_historial = []</span>
<span class="s2">        lista_historial = item.history.all()</span>
<span class="s2">        lista_historial = list(lista_historial)</span>
<span class="s2">        lista_historial.pop()</span>
<span class="s2">        prueba = </span><span class="si">{}</span><span class="s2"></span>
<span class="s2">        &quot;Obtiene los campos extras del item con sus respectivos valores&quot;</span>
<span class="s2">        p2 = zip(item.tipoItem.campo_extra, item.campo_extra_valores)</span>
<span class="s2">        for p, k in p2:</span>
<span class="s2">            prueba[p] = k</span>
<span class="s2">        return render(request, &#39;item/historialitem.html&#39;,</span>
<span class="s2">                      {&#39;faseid&#39;: faseid, &#39;proyectoid&#39;: proyectoid,</span>
<span class="s2">                       &#39;item&#39;: item, &#39;lista&#39;: lista_historial,</span>
<span class="s2">                       &#39;campos&#39;: prueba})</span>
<span class="s2">#DIVIDER</span>
<span class="s2">def itemReversionar(request, proyectoid, faseid, itemid, history_date):</span>
<span class="s2">#DIVIDER</span>

<span class="s2">    if request.method == &#39;GET&#39;:</span>

<span class="s2">        fase = Fase.objects.get(id=faseid)</span>
<span class="s2">        proyecto = Proyecto.objects.get(id=proyectoid)</span>
<span class="s2">        item = Item.objects.get(id=itemid)</span>
<span class="s2">#DIVIDER</span>
<span class="s2">        if not (request.user.has_perm(&quot;reversionar_item&quot;, fase)) and not (</span>
<span class="s2">                request.user.has_perm(&quot;is_gerente&quot;, proyecto)):</span>
<span class="s2">#DIVIDER</span>
<span class="s2">            return redirect(&#39;/permissionError/&#39;)</span>
<span class="s2">#DIVIDER</span>
<span class="s2">        if (item.estado == &#39;en desarrollo&#39;):</span>
<span class="s2">#DIVIDER</span>
<span class="s2">            rever = item.history.as_of(history_date)</span>
<span class="s2">#DIVIDER</span>
<span class="s2">            num = Item.objects.last()</span>
<span class="s2">#DIVIDER</span>
<span class="s2">            item = rever</span>
<span class="s2">            item._history_date = datetime.now()</span>
<span class="s2">            &quot;Asigna el numero de version al item reversionado&quot;</span>
<span class="s2">            item.version = num.version + 1</span>
<span class="s2">            item.save()</span>
<span class="s2">            return redirect(&#39;itemConfigurar&#39;,itemid=itemid, faseid=faseid, proyectoid=proyectoid )</span>
<span class="s2">        else:</span>
<span class="s2">            return redirect(&#39;itemConfigurar&#39;,itemid=itemid, faseid=faseid, proyectoid=proyectoid )</span>
<span class="s2">#DIVIDER</span>
<span class="s2">def downloadFile(request, filename, itemid, faseid, proyectoid):</span>
<span class="s2">    path = &#39;/var/www/item/descargas/&#39;</span>
<span class="s2">    s3 = boto3.client(&#39;s3&#39;,</span>
<span class="s2">                        aws_access_key_id=&#39;AKIAUWIIW4ARQQQA4TLN&#39;,</span>
<span class="s2">                        aws_secret_access_key=&#39;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&#39; )</span>
<span class="s2">#DIVIDER</span>
<span class="s2">    s3.download_file(&#39;archivositem&#39;, filename, path + filename)</span>
<span class="s2">    return redirect(&#39;itemConfigurar&#39;, itemid= itemid, faseid= faseid, proyectoid= proyectoid)</span>
<span class="s2">#DIVIDER</span>
<span class="s2">def cerrarFase(request, proyectoid, faseid):</span>
<span class="s2">#DIVIDER</span>

<span class="s2">    if request.method == &#39;GET&#39;:</span>
<span class="s2">#DIVIDER</span>
<span class="s2">        fase = Fase.objects.get(id=faseid)</span>
<span class="s2">#DIVIDER</span>
<span class="s2">        proyecto = Proyecto.objects.get(id=proyectoid)</span>

<span class="s2">        cerrar = True</span>
<span class="s2">        if not (request.user.has_perm(&quot;cerrar_fase&quot;, fase)) and not (request.user.has_perm(&quot;is_gerente&quot;, proyecto)):</span>
<span class="s2">#DIVIDER</span>
<span class="s2">            return redirect(&#39;/permissionError/&#39;)</span>
<span class="s2">#DIVIDER</span>
<span class="s2">        itemsFase = fase.items.exclude(estado=&quot;deshabilitado&quot;)</span>
<span class="s2">        for i in itemsFase:</span>
<span class="s2">            if i.estado == &quot;en linea base&quot;:</span>
<span class="s2">                lineaBaseItem = LineaBase.objects.exclude(estado=&quot;rota&quot;).get(items__id=i.id)</span>
<span class="s2">                if lineaBaseItem.estado != &quot;cerrada&quot;:</span>
<span class="s2">                    cerrar = False</span>
<span class="s2">                    break</span>
<span class="s2">            else:</span>
<span class="s2">                cerrar = False</span>
<span class="s2">                break</span>
<span class="s2">#DIVIDER</span>
<span class="s2">                    que se encuentre en una linea base cerrada, o bien con un padre(o hijo) que este aprobado.&quot;&quot;&quot;</span>
        <span class="n">fasesProyecto</span> <span class="o">=</span> <span class="n">proyecto</span><span class="o">.</span><span class="n">fases</span><span class="o">.</span><span class="n">exclude</span><span class="p">(</span><span class="n">estado</span><span class="o">=</span><span class="s2">&quot;deshabilitada&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">order_by</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">)</span>
        <span class="n">cont</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">esPrimeraFase</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">for</span> <span class="n">fp</span> <span class="ow">in</span> <span class="n">fasesProyecto</span><span class="p">:</span>
            <span class="n">cont</span> <span class="o">=</span> <span class="n">cont</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="n">fp</span> <span class="o">==</span> <span class="n">fase</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">cont</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">esPrimeraFase</span> <span class="o">=</span> <span class="kc">True</span>
                    <span class="k">break</span>
        <span class="s2">&quot;Solo verificar si son items posteriores a la primera fase.&quot;</span>
        <span class="n">bandera</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="k">if</span> <span class="n">esPrimeraFase</span> <span class="o">==</span> <span class="kc">False</span><span class="p">:</span>

            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">itemsFase</span><span class="p">:</span>
                <span class="n">relaciones</span> <span class="o">=</span> <span class="n">i</span><span class="o">.</span><span class="n">relaciones</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>

                <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">relaciones</span><span class="p">:</span>
                    <span class="n">relacion</span> <span class="o">=</span> <span class="n">Relacion</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">item_from</span><span class="o">=</span><span class="n">i</span><span class="p">,</span> <span class="n">item_to</span><span class="o">=</span><span class="n">r</span><span class="p">)</span>

                    <span class="k">if</span> <span class="n">relacion</span><span class="o">.</span><span class="n">tipo</span> <span class="o">==</span> <span class="s2">&quot;sucesor&quot;</span><span class="p">:</span>
                        <span class="n">bandera</span> <span class="o">=</span> <span class="kc">True</span>
                        <span class="k">break</span>

        <span class="k">if</span> <span class="n">esPrimeraFase</span> <span class="o">==</span> <span class="kc">False</span><span class="p">:</span>

            <span class="k">if</span> <span class="n">cerrar</span> <span class="o">==</span> <span class="kc">True</span> <span class="ow">and</span> <span class="n">bandera</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
                <span class="n">fase</span><span class="o">.</span><span class="n">estado</span> <span class="o">=</span> <span class="s2">&quot;cerrada&quot;</span>
                <span class="n">fase</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
                <span class="k">return</span> <span class="n">redirect</span><span class="p">(</span><span class="s1">&#39;faseViewInicializado&#39;</span><span class="p">,</span> <span class="n">faseid</span><span class="o">=</span><span class="n">faseid</span><span class="p">,</span> <span class="n">proyectoid</span><span class="o">=</span><span class="n">proyectoid</span><span class="p">)</span>

            <span class="k">return</span> <span class="n">redirect</span><span class="p">(</span><span class="s1">&#39;faseConfinicializada&#39;</span><span class="p">,</span> <span class="n">proyectoid</span><span class="o">=</span><span class="n">proyectoid</span><span class="p">,</span><span class="n">faseid</span><span class="o">=</span><span class="n">faseid</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">cerrar</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">fase</span><span class="o">.</span><span class="n">estado</span> <span class="o">=</span> <span class="s2">&quot;cerrada&quot;</span>
            <span class="n">fase</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
            <span class="k">return</span> <span class="n">redirect</span><span class="p">(</span><span class="s1">&#39;faseViewInicializado&#39;</span><span class="p">,</span> <span class="n">faseid</span><span class="o">=</span><span class="n">faseid</span><span class="p">,</span> <span class="n">proyectoid</span><span class="o">=</span><span class="n">proyectoid</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">redirect</span><span class="p">(</span><span class="s1">&#39;faseConfinicializada&#39;</span><span class="p">,</span>  <span class="n">proyectoid</span><span class="o">=</span><span class="n">proyectoid</span><span class="p">,</span> <span class="n">faseid</span><span class="o">=</span><span class="n">faseid</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-248'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-248'>#</a>
      </div>
      <p>Inicializar bandera para validar si un item pertenece a la primera fase.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">sendEmailView</span><span class="p">(</span><span class="n">mail</span><span class="p">,</span><span class="n">name</span><span class="p">,</span><span class="n">item</span><span class="p">,</span><span class="n">fase</span><span class="p">):</span>

    <span class="n">context</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="n">name</span><span class="p">,</span> <span class="s1">&#39;item&#39;</span><span class="p">:</span><span class="n">item</span><span class="p">,</span> <span class="s1">&#39;fase&#39;</span><span class="p">:</span><span class="n">fase</span><span class="p">}</span>

    <span class="n">template</span> <span class="o">=</span> <span class="n">get_template</span><span class="p">(</span><span class="s1">&#39;fase/correoSolicitudAprobacion.html&#39;</span><span class="p">)</span>
    <span class="n">content</span> <span class="o">=</span> <span class="n">template</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="n">context</span><span class="p">)</span>

    <span class="n">email</span> <span class="o">=</span> <span class="n">EmailMultiAlternatives</span><span class="p">(</span>
        <span class="s1">&#39;Solicitud de aprobacion de Item&#39;</span><span class="p">,</span>
        <span class="s1">&#39;item&#39;</span><span class="p">,</span>
        <span class="n">settings</span><span class="o">.</span><span class="n">EMAIL_HOST_USER</span><span class="p">,</span>
        <span class="p">[</span><span class="n">mail</span><span class="p">]</span>
    <span class="p">)</span>
    <span class="n">email</span><span class="o">.</span><span class="n">attach_alternative</span><span class="p">(</span><span class="n">content</span><span class="p">,</span> <span class="s1">&#39;text/html&#39;</span><span class="p">)</span>
    <span class="n">email</span><span class="o">.</span><span class="n">send</span><span class="p">()</span>

</pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-249'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-249'>#</a>
      </div>
      <p>Recorrer las fases del proyecto.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-250'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-250'>#</a>
      </div>
      <p>Aumenta el contador por cada fase.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-251'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-251'>#</a>
      </div>
      <p>Si la fase encontrada es igual a la actual</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-252'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-252'>#</a>
      </div>
      <p>Si el contador es igual a 1.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-253'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-253'>#</a>
      </div>
      <p>Setear bandera en true.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-254'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-254'>#</a>
      </div>
      <p>ROmper ciclo.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-255'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-255'>#</a>
      </div>
      <p>Variable para verificar si se posee una fase anterior.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-256'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-256'>#</a>
      </div>
      <p>Recorrer fases del proyecto.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-257'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-257'>#</a>
      </div>
      <p>Si la fase encontrada es igual a la fase actual.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-258'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-258'>#</a>
      </div>
      <p>Romper ciclo</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-259'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-259'>#</a>
      </div>
      <p>Sino, actualizar variable de fase anterior.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-260'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-260'>#</a>
      </div>
      <p>Bandera para verificar si un item esta listo para ser aprobado.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-261'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-261'>#</a>
      </div>
      <p>Obtener las relaciones del item.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-262'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-262'>#</a>
      </div>
      <p>Recorrer las relaciones.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-263'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-263'>#</a>
      </div>
      <p>Obtener relacion objeto.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-264'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-264'>#</a>
      </div>
      <p>Si el item perteece a la fase anterior y su estado es en linea base.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-265'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-265'>#</a>
      </div>
      <p>Obtener linea base.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-266'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-266'>#</a>
      </div>
      <p>Si el estado de la linea base es cerrada.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-267'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-267'>#</a>
      </div>
      <p>Setear bandera en true.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-268'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-268'>#</a>
      </div>
      <p>Romper ciclo.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-269'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-269'>#</a>
      </div>
      <p>Si el item peretenece a la fase actual y su estado es aprobado, o bien en linea base.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-270'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-270'>#</a>
      </div>
      <p>Setear bandera en true.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-271'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-271'>#</a>
      </div>
      <p>Si el item no esta listo para aprobarse.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-272'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-272'>#</a>
      </div>
      <pre><code>Template a renderizar: item.html 
con parametros -&gt; faseid, proyectoid, item, proyecto, campos extra de item,
permiso para establecer item como pendiente de aprobacion, 
permiso para establecer item como parobado, choices
con los distintos estados del item y el mensaje correspondiente.
</code></pre>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-273'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-273'>#</a>
      </div>
      <p>Verificar que el estado del proyecto sea inicializado.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-274'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-274'>#</a>
      </div>
      <p>En caso contrario, no permite cambiar el estado del item y redirige a la vista de fase.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-275'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-275'>#</a>
      </div>
      <p>Actualiza estado del item.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-276'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-276'>#</a>
      </div>
      <p>Guardar.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-277'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-277'>#</a>
      </div>
      <p>Template a renderizar: item.html 
con parametros -&gt; faseid, proyectoid, item, proyecto, campos extra de item,
permiso para establecer item como pendiente de aprobacion, 
permiso para establecer item como parobado, choices
con los distintos estados del item y el mensaje correspondiente.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-278'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-278'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-279'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-279'>#</a>
      </div>
      <pre><code>**itemDeshabilitar:**
 Vista utilizada para deshabilitar Item.
  Solicita que el usuario que realiza el request
   cuente con los permisos para deshabilitar los
    items de fase, o bien, los permisos de gerente del proyecto
    y que (indirectamente) haya iniciado sesion.
</code></pre>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-280'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-280'>#</a>
      </div>
      <p>ID del proyecto
Proyecto en el cual se encuentra el item.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-281'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-281'>#</a>
      </div>
      <p>ID de fase.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-282'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-282'>#</a>
      </div>
      <p>Fase en la cual se encuentra el item.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-283'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-283'>#</a>
      </div>
      <p>ID de item.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-284'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-284'>#</a>
      </div>
      <p>Item a deshabilitar.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-285'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-285'>#</a>
      </div>
      <p>Verificar que el usuario cuente con los permisos necesarios.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-286'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-286'>#</a>
      </div>
      <p>Al no contar con los permisos, niega el acceso, redirigiendo.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-287'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-287'>#</a>
      </div>
      <p>Verificar que el estado del proyecto sea inicializado.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-288'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-288'>#</a>
      </div>
      <p>En caso contrario, no permite deshabilitar el item y redirige a la vista de fase.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-289'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-289'>#</a>
      </div>
      <p>Verificar que el estado del item sea en desarrollo.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-290'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-290'>#</a>
      </div>
      <p>En caso contrario niega la deshabilitacion del mismo y 
vuelve a gestion de item mostrando un mensaje de error.
Template a renderizar gestionItem.html con parametros -&gt; proyectoid, faseid, itemid y mensaje de error.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-291'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-291'>#</a>
      </div>
      <p>VERIFICAR SI ES POSIBLE DESHABILITAR EL ITEM TENIENDO EN CUENTA SUS RELACIONES.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-292'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-292'>#</a>
      </div>
      <p>Obtener relaciones.
Bandera para verificar si se puede deshabilitar el item.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-293'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-293'>#</a>
      </div>
      <p>Recorrer relaciones.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-294'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-294'>#</a>
      </div>
      <p>Si el estado del item es aprobado o bien, en linea base.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-295'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-295'>#</a>
      </div>
      <p>Bandera para identificar si el item puede seguir sin la relacion con el item a deshabilitar.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-296'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-296'>#</a>
      </div>
      <p>Establece estado de item como deshabilitado.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-297'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-297'>#</a>
      </div>
      <p>Guardar.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-298'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-298'>#</a>
      </div>
      <p>Redirige a la vista de la fase correspondiente.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-299'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-299'>#</a>
      </div>
      <p>Redirige a la vista de la fase correspondiente.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-300'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-300'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-301'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-301'>#</a>
      </div>
      <p>Recupera la lista de items antecesores a l de la tabla de relaciones</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-302'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-302'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-303'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-303'>#</a>
      </div>
      <p>if items_antecesores:
Se encuentra la fase en donde estn sus tems antecesores
fase_antecesora = items_antecesores[0].fase
Recupera la lista de items sucesores a l de la tabla de relaciones</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-304'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-304'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-305'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-305'>#</a>
      </div>
      <p>if items_sucesores:
Se encuentra la fase en donde estn sus tems antecesores
fase_sucesora = items_sucesores[0].fase
Recupera la lista de items padres de l de la tabla de relaciones</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-306'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-306'>#</a>
      </div>
      <p>Sus padres e hijos son de su misma fase</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-307'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-307'>#</a>
      </div>
      <p>Recupera la lista de items hijos de l de la tabla de relaciones</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-308'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-308'>#</a>
      </div>
      <p>Verificar si el tem puede establecer relaciones, considerando su estado</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-309'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-309'>#</a>
      </div>
      <p>Verificar si el tem puede establecer relaciones, verificando que existan tems disponibles</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-310'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-310'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-311'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-311'>#</a>
      </div>
      <pre><code>          **itemRelacionesRemover:**
           Vista utilizada para remover relaciones del Item.
           Solicita que el usuario que realiza el request
           cuente con los permisos para remover relaciones de
           items en la fase, o bien, los de gerente del proyecto
           y que (indirectamente) haya iniciado sesion.
</code></pre>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-312'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-312'>#</a>
      </div>
      <p>ID del proyecto</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-313'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-313'>#</a>
      </div>
      <p>proyectoid = request.GET.get(&lsquo;proyectoid&rsquo;)
Proyecto en el cual se encuentra el item.
ID de fase.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-314'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-314'>#</a>
      </div>
      <p>faseid = request.GET.get(&lsquo;faseid&rsquo;)
Fase en la cual se encuentra el item.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-315'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-315'>#</a>
      </div>
      <p>itemid = request.GET.get(&lsquo;itemid&rsquo;)
itemid_final = request.GET.get(&lsquo;itemid_final&rsquo;)
Bandera para verificar si se puede remover la relacion.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-316'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-316'>#</a>
      </div>
      <p>Si el item cuenta con un estado aprobado o bien, en linea base.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-317'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-317'>#</a>
      </div>
      <p>Recorrer relaciones.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-318'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-318'>#</a>
      </div>
      <p>Obtener relacion objeto.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-319'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-319'>#</a>
      </div>
      <p>Si la relacion es de tipo padre y el estado del item es aprobado o en linea base.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-320'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-320'>#</a>
      </div>
      <p>Setear bandera en true.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-321'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-321'>#</a>
      </div>
      <p>Romper ciclo.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-322'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-322'>#</a>
      </div>
      <p>Si la relacion es de tipo antecesor y el estado del item es en linea base</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-323'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-323'>#</a>
      </div>
      <p>Obtener linea base.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-324'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-324'>#</a>
      </div>
      <p>Si el estado de la linea base es cerrada.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-325'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-325'>#</a>
      </div>
      <p>Setear bandera en true.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-326'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-326'>#</a>
      </div>
      <p>ROmper ciclo.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-327'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-327'>#</a>
      </div>
      <p>Si no cuenta con estado aprobado o en linea base</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-328'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-328'>#</a>
      </div>
      <p>Setear bandera en true.
Recorrer relaciones.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-329'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-329'>#</a>
      </div>
      <p>Obtener relacion objeto.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-330'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-330'>#</a>
      </div>
      <p>Si la relacion es de tipo padre y el estado del item es aprobado o en linea base.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-331'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-331'>#</a>
      </div>
      <p>Setear bandera en true.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-332'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-332'>#</a>
      </div>
      <p>Romper ciclo.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-333'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-333'>#</a>
      </div>
      <p>Si la relacion es de tipo antecesor y el estado del item es en linea base</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-334'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-334'>#</a>
      </div>
      <p>Obtener linea base.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-335'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-335'>#</a>
      </div>
      <p>Si el estado de la linea base es cerrada.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-336'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-336'>#</a>
      </div>
      <p>Setear bandera en true.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-337'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-337'>#</a>
      </div>
      <p>Romper ciclo.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-338'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-338'>#</a>
      </div>
      <p>Si ambas banderas son true, se rompe la relacion.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-339'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-339'>#</a>
      </div>
      <p>Obtener relacion objeto.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-340'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-340'>#</a>
      </div>
      <p>Eliminar relacion objeto.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-341'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-341'>#</a>
      </div>
      <p>Obtener relacion objeto.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-342'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-342'>#</a>
      </div>
      <p>Eliminar relacion objeto.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-343'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-343'>#</a>
      </div>
      <p>Redirigir a la vista itemVerRelaciones.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-344'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-344'>#</a>
      </div>
      <p>Redirigir a la vista itemVerRelaciones sin romper la relacion.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-345'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-345'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-346'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-346'>#</a>
      </div>
      <pre><code>           **itemAddRelacion:**
            Vista utilizada para agregar relaciones al Item.
            Solicita que el usuario que realiza el request
            cuente con los permisos para agregar relaciones
            a items en la fase, o bien, los de gerente del proyecto
            y que (indirectamente) haya iniciado sesion.
</code></pre>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-347'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-347'>#</a>
      </div>
      <p>ID del proyecto</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-348'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-348'>#</a>
      </div>
      <p>Obtener proyecto.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-349'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-349'>#</a>
      </div>
      <p>ID de la fase</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-350'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-350'>#</a>
      </div>
      <p>Obtener fase.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-351'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-351'>#</a>
      </div>
      <p>ID del item</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-352'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-352'>#</a>
      </div>
      <p>Obtener el item</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-353'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-353'>#</a>
      </div>
      <p>Verificar que el usuario cuente con los permisos necesarios.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-354'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-354'>#</a>
      </div>
      <p>Al no contar con los permisos, niega el acceso, redirigiendo.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-355'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-355'>#</a>
      </div>
      <p>Array auxiliar.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-356'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-356'>#</a>
      </div>
      <p>Recorrer relaciones.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-357'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-357'>#</a>
      </div>
      <p>Almacenar id de relaciones.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-358'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-358'>#</a>
      </div>
      <p>Variable correspondiente a la fase siguiente.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-359'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-359'>#</a>
      </div>
      <p>Items de la fase siguiente.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-360'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-360'>#</a>
      </div>
      <p>Si el estado del item es en linea base.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-361'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-361'>#</a>
      </div>
      <p>Filtrar linea base que aloja al item.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-362'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-362'>#</a>
      </div>
      <p>Si el estsado de la linea base es cerrada.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-363'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-363'>#</a>
      </div>
      <p>Obtener las fases del proyecto.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-364'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-364'>#</a>
      </div>
      <p>Bandera para detectar fase actual.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-365'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-365'>#</a>
      </div>
      <p>Recorrer fases del proyecto.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-366'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-366'>#</a>
      </div>
      <p>Si ya aparecio la fase actual..</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-367'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-367'>#</a>
      </div>
      <p>Almacenar fase siguiente.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-368'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-368'>#</a>
      </div>
      <p>Romper ciclo.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-369'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-369'>#</a>
      </div>
      <p>Si encontramos a la fase actual.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-370'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-370'>#</a>
      </div>
      <p>Setear bandera en true.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-371'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-371'>#</a>
      </div>
      <p>Si fase siguiente no es None.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-372'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-372'>#</a>
      </div>
      <p>Obtener items fase siguiente</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-373'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-373'>#</a>
      </div>
      <p>SI linea base no esta cerrada no cargar items de la fase siguiente.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-374'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-374'>#</a>
      </div>
      <p>Obtener items de la fase actual.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-375'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-375'>#</a>
      </div>
      <p>Renderizar item/itemAddRelacion/html.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-376'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-376'>#</a>
      </div>
      <p>POST REQUEST</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-377'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-377'>#</a>
      </div>
      <p>ID del proyecto</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-378'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-378'>#</a>
      </div>
      <p>Obtener proyecto.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-379'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-379'>#</a>
      </div>
      <p>ID de fase</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-380'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-380'>#</a>
      </div>
      <p>Obtener fase.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-381'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-381'>#</a>
      </div>
      <p>ID de item_from</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-382'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-382'>#</a>
      </div>
      <p>Obtener item.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-383'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-383'>#</a>
      </div>
      <p>ID de item_to</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-384'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-384'>#</a>
      </div>
      <p>Obtener item.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-385'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-385'>#</a>
      </div>
      <p>IDde fase siguiente.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-386'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-386'>#</a>
      </div>
      <p>FIltrar fases del proyecto apropiadas.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-387'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-387'>#</a>
      </div>
      <p>Recorrer Fases del proyecto.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-388'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-388'>#</a>
      </div>
      <p>Obtener items de fase.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-389'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-389'>#</a>
      </div>
      <p>Recorrer items.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-390'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-390'>#</a>
      </div>
      <p>Si el item corresponde al item_to</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-391'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-391'>#</a>
      </div>
      <p>Si existe fase siguiente.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-392'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-392'>#</a>
      </div>
      <p>Si fase encontrada igual a fase siguiente.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-393'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-393'>#</a>
      </div>
      <p>Crear relacion.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-394'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-394'>#</a>
      </div>
      <p>Crear relacion.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-395'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-395'>#</a>
      </div>
      <p>SI se encuentra a la fase actual.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-396'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-396'>#</a>
      </div>
      <p>Crear relacion.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-397'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-397'>#</a>
      </div>
      <p>Crear relacion.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-398'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-398'>#</a>
      </div>
      <p>CONTROL DE CICLO EN EL GRAFO</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-399'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-399'>#</a>
      </div>
      <p>SI TIENE UN CICLO ELIMINAR RELACIONES Y REDIRIGIR A VISUALIZACION DE RELACIONES</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-400'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-400'>#</a>
      </div>
      <p>SINO MANTENER RELACIONES Y REDIRIGIR A LA VISTA DE RELACIONES.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-401'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-401'>#</a>
      </div>
      <p>Funcion para agregar Edge</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-402'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-402'>#</a>
      </div>
      <p>FUncion auxiliar del algoritmo.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-403'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-403'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-404'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-404'>#</a>
      </div>
      <p>Set parent vertex for every vertex as -1.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-405'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-405'>#</a>
      </div>
      <p>Create a queue for BFS</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-406'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-406'>#</a>
      </div>
      <p>Mark the current node as
visited and enqueue it</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-407'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-407'>#</a>
      </div>
      <p>Dequeue a vertex from queue and print it</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-408'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-408'>#</a>
      </div>
      <p>Get all adjacent vertices of the dequeued
vertex u. If a adjacent has not been visited,
then mark it visited and enqueue it. We also
mark parent so that parent is not considered
for cycle.
Algoritmo BFS para control de ciclos.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-409'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-409'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-410'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-410'>#</a>
      </div>
      <p>Mark all the vertices as not visited</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-411'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-411'>#</a>
      </div>
      <pre><code>       **itemAddRelacion:**
        Vista utilizada para gestion de lineas base en Fase.
        Solicita que el usuario que realiza el request
        cuente con los permisos para ver lineas base en la fase,
         o bien, los de gerente del proyecto y que
         (indirectamente) haya iniciado sesion.
</code></pre>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-412'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-412'>#</a>
      </div>
      <p>ID de pryecto.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-413'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-413'>#</a>
      </div>
      <p>ID de fase.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-414'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-414'>#</a>
      </div>
      <p>Obtener fase.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-415'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-415'>#</a>
      </div>
      <p>Obtener proyecto.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-416'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-416'>#</a>
      </div>
      <p>&ldquo;Controla que el usuario cuente con los permisos necesarios.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-417'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-417'>#</a>
      </div>
      <p>Al no contar con los permisos, niega el acceso, redirigiendo.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-418'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-418'>#</a>
      </div>
      <p>Obtener lineas base de la fase, excluyendo las rotas.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-419'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-419'>#</a>
      </div>
      <p>Items disponibles para linea base.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-420'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-420'>#</a>
      </div>
      <p>SI existen items.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-421'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-421'>#</a>
      </div>
      <p>Setear bandera en true.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-422'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-422'>#</a>
      </div>
      <p>Sino, setear bandera en false.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-423'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-423'>#</a>
      </div>
      <p>Renderizar fase/faseGestionLineaBase.html</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-424'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-424'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-425'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-425'>#</a>
      </div>
      <pre><code>       **consultarLineaBase:**
        Vista utilizada para consultar de lineas base en Fase.
        Solicita que el usuario que realiza el request
        cuente con los permisos para ver lineas base en la fase,
         o bien, los de gerente del proyecto y que
         (indirectamente) haya iniciado sesion.
</code></pre>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-426'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-426'>#</a>
      </div>
      <p>Obtener proyecto.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-427'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-427'>#</a>
      </div>
      <p>Obtener fase.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-428'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-428'>#</a>
      </div>
      <p>Obtener linea base.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-429'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-429'>#</a>
      </div>
      <p>Obtener items de linea base.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-430'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-430'>#</a>
      </div>
      <p>Renderizar fase/lineaBaseConsultar.html</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-431'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-431'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-432'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-432'>#</a>
      </div>
      <pre><code>           **faseAddLineaBase:**
            Vista utilizada para agregar lineas base en Fase.
            Solicita que el usuario que realiza el request
            cuente con los permisos para crear lineas base en la fase,
             o bien, los de gerente del proyecto y que
             (indirectamente) haya iniciado sesion.
</code></pre>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-433'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-433'>#</a>
      </div>
      <p>POST REQUEST.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-434'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-434'>#</a>
      </div>
      <p>ID de proyecto.
ID de fase</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-435'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-435'>#</a>
      </div>
      <p>Nombre generado para la linea base</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-436'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-436'>#</a>
      </div>
      <p>Lista de IDs de items para la linea base</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-437'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-437'>#</a>
      </div>
      <p>Crear Linea Base.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-438'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-438'>#</a>
      </div>
      <p>Recorerr los IDs de items</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-439'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-439'>#</a>
      </div>
      <p>Obtener item.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-440'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-440'>#</a>
      </div>
      <p>Actualizar estado de item.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-441'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-441'>#</a>
      </div>
      <p>Actualizar history date de item, para version.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-442'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-442'>#</a>
      </div>
      <p>Guardar item.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-443'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-443'>#</a>
      </div>
      <p>Agregar item a linea base.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-444'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-444'>#</a>
      </div>
      <p>GUardar Linea Base.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-445'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-445'>#</a>
      </div>
      <p>Agregar linea base a fase.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-446'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-446'>#</a>
      </div>
      <p>Guardar fase.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-447'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-447'>#</a>
      </div>
      <p>Obtener lineas base, excluyendo las rotas.(necesario para el template a renderizar)</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-448'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-448'>#</a>
      </div>
      <p>Obtener items aprobados en la fase.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-449'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-449'>#</a>
      </div>
      <p>Si existen items disponibles</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-450'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-450'>#</a>
      </div>
      <p>Se puede crear linea base.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-451'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-451'>#</a>
      </div>
      <p>Si no existen items disponibles, ya no se podra crear linea base.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-452'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-452'>#</a>
      </div>
      <p>Renderizar fase/faseGestionLineaBase.html</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-453'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-453'>#</a>
      </div>
      <p>Se recibe el ID del proyecto en el cual se encuentra actualmente el Usuario</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-454'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-454'>#</a>
      </div>
      <p>Recupera de la BD el proyecto en el que se encuentra el usuario.
Verificar permiso necesario en el proyecto correspondiente</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-455'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-455'>#</a>
      </div>
      <p>Si el proyecto no se encuentra inicializado.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-456'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-456'>#</a>
      </div>
      <p>Redireccionar a la vista de fase, interrumpiendo el proceso.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-457'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-457'>#</a>
      </div>
      <p>Obtener items aprobados.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-458'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-458'>#</a>
      </div>
      <p>Cantidad de lineas base en fase.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-459'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-459'>#</a>
      </div>
      <p>Generar nombre para la linea base</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-460'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-460'>#</a>
      </div>
      <p>Renderizar fase/faseAddLineaBase.html</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-461'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-461'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-462'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-462'>#</a>
      </div>
      <pre><code>               **faseConfigLineaBase:**
                Vista utilizada para configurar lineas base en Fase.
                Solicita que el usuario que realiza el request
                cuente con los permisos para ver lineas base en la fase,
                 o bien, los de gerente del proyecto y que
                 (indirectamente) haya iniciado sesion.
</code></pre>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-463'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-463'>#</a>
      </div>
      <p>Obtener fase.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-464'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-464'>#</a>
      </div>
      <p>Obtener proyecto.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-465'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-465'>#</a>
      </div>
      <p>Obtener Linea Base.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-466'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-466'>#</a>
      </div>
      <p>Verificar que el usuario cuente con los permisos necesarios para efectuar la accion.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-467'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-467'>#</a>
      </div>
      <p>Al no contar con los permisos, niega el acceso, redirigiendo.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-468'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-468'>#</a>
      </div>
      <p>Obtener todos los items de la linea base, ordenados por id.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-469'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-469'>#</a>
      </div>
      <p>Filtra items de la fase aprobados.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-470'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-470'>#</a>
      </div>
      <p>SI existen items disonibles en la fase.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-471'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-471'>#</a>
      </div>
      <p>Se puede crear una nueva linea base.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-472'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-472'>#</a>
      </div>
      <p>SI no existen items disponibles, no se podra crear linea base.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-473'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-473'>#</a>
      </div>
      <p>Renderizar fase/faseConfigLineaBase.html</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-474'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-474'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-475'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-475'>#</a>
      </div>
      <pre><code>                   **lineaBaseAddItem:**
                    Vista utilizada para agregar items a lineas base en Fase.
                    Solicita que el usuario que realiza el request
                    cuente con los permisos para modificar lineas base en la fase,
                     o bien, los de gerente del proyecto y que
                     (indirectamente) haya iniciado sesion.
</code></pre>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-476'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-476'>#</a>
      </div>
      <p>ID de proyecto</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-477'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-477'>#</a>
      </div>
      <p>ID de fase</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-478'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-478'>#</a>
      </div>
      <p>ID de linea base</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-479'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-479'>#</a>
      </div>
      <p>Obtener fase.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-480'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-480'>#</a>
      </div>
      <p>Obtener proyecto.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-481'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-481'>#</a>
      </div>
      <p>Obtener Linea Base.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-482'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-482'>#</a>
      </div>
      <p>Verificar que el usuario cuente con los permisos necesarios para efectuar la accion.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-483'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-483'>#</a>
      </div>
      <p>Al no contar con los permisos, niega el acceso, redirigiendo.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-484'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-484'>#</a>
      </div>
      <p>Obtener items de la linea base ordenadas por id.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-485'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-485'>#</a>
      </div>
      <p>Renderizar fase/faseConfigLineaBase.html interrumpiendo el proceso.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-486'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-486'>#</a>
      </div>
      <p>Filtrar items disponibles en la fase.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-487'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-487'>#</a>
      </div>
      <p>Renderizar fase/lienaBaseAddItem.html</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-488'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-488'>#</a>
      </div>
      <p>POST REQUEST.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-489'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-489'>#</a>
      </div>
      <p>ID de proyecto
ID de fase</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-490'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-490'>#</a>
      </div>
      <p>ID de linea base.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-491'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-491'>#</a>
      </div>
      <p>Obtener fase</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-492'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-492'>#</a>
      </div>
      <p>Obtener proyecto</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-493'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-493'>#</a>
      </div>
      <p>Obtener linea base.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-494'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-494'>#</a>
      </div>
      <p>Obtener IDs de items para la linea base.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-495'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-495'>#</a>
      </div>
      <p>Recorrer los IDs</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-496'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-496'>#</a>
      </div>
      <p>Obtener item</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-497'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-497'>#</a>
      </div>
      <p>Actualizar estado del item.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-498'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-498'>#</a>
      </div>
      <p>Actualizar history date del item.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-499'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-499'>#</a>
      </div>
      <p>Guardar item.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-500'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-500'>#</a>
      </div>
      <p>Agregar item a linea base.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-501'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-501'>#</a>
      </div>
      <p>Guardar linea base.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-502'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-502'>#</a>
      </div>
      <p>Obtener items de linea base ordenados por id</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-503'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-503'>#</a>
      </div>
      <p>Renderizar fase/faseCOnfigLineaBase.html</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-504'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-504'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-505'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-505'>#</a>
      </div>
      <pre><code>                       **lineaBaseRemoveItem:**
                        Vista utilizada para remover items de lineas base en Fase.
                        Solicita que el usuario que realiza el request
                        cuente con los permisos para modificar lineas base en la fase,
                         o bien, los de gerente del proyecto y que
                         (indirectamente) haya iniciado sesion.
</code></pre>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-506'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-506'>#</a>
      </div>
      <p>Obtener proyecto.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-507'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-507'>#</a>
      </div>
      <p>Obtener fase</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-508'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-508'>#</a>
      </div>
      <p>Obtener linea base.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-509'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-509'>#</a>
      </div>
      <p>Obtener item a remover de linea base</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-510'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-510'>#</a>
      </div>
      <p>Verificar que el usuario cuente con los permisos necesarios para efectuar la accion.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-511'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-511'>#</a>
      </div>
      <p>Al no contar con los permisos, niega el acceso, redirigiendo.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-512'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-512'>#</a>
      </div>
      <p>Obtener items de la linea base ordenadas por id.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-513'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-513'>#</a>
      </div>
      <p>Renderizar fase/faseConfigLineaBase.html interrumpiendo el proceso.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-514'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-514'>#</a>
      </div>
      <p>Remover item de linea base</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-515'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-515'>#</a>
      </div>
      <p>Guardar LInea Base</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-516'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-516'>#</a>
      </div>
      <p>Actualizar estado de item.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-517'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-517'>#</a>
      </div>
      <p>Actualizar history date de item para version.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-518'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-518'>#</a>
      </div>
      <p>Guardar item.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-519'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-519'>#</a>
      </div>
      <p>Obtener items de la linea base ordenados por id.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-520'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-520'>#</a>
      </div>
      <p>Renderizar fase/faseConfigLineaBase.html.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-521'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-521'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-522'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-522'>#</a>
      </div>
      <pre><code>                           **faseCerrarLineaBase:**
                            Vista utilizada para cerrar lineas base en Fase.
                            Solicita que el usuario que realiza el request
                            sea el creador de la linea base y que
                             (indirectamente) haya iniciado sesion.
</code></pre>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-523'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-523'>#</a>
      </div>
      <p>Obtener proyecto.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-524'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-524'>#</a>
      </div>
      <p>Obtener fase.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-525'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-525'>#</a>
      </div>
      <p>Obtener Linea Base.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-526'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-526'>#</a>
      </div>
      <p>Verificar que el usuario que desea realizar la accion sea el creador de la linea base.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-527'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-527'>#</a>
      </div>
      <p>EN caso de no ser el creador, interrumpir el proceso, redirigiendo.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-528'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-528'>#</a>
      </div>
      <p>Si la linea base no tiene items no se puede cerrar la linea base..</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-529'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-529'>#</a>
      </div>
      <p>Obtener items de linea base.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-530'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-530'>#</a>
      </div>
      <p>Renderizar fase/faseConfigLineaBase.html interrumpiendo el proceso.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-531'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-531'>#</a>
      </div>
      <p>Actualizar el estado de la linea base.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-532'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-532'>#</a>
      </div>
      <p>Guardar Linea Base</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-533'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-533'>#</a>
      </div>
      <p>Obtener lineas base de fase, exluyendo las rotas (ncesario en el template a renderizar)</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-534'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-534'>#</a>
      </div>
      <p>Renderizar fase/faseGestionLineaBase.html</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-535'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-535'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-536'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-536'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-537'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-537'>#</a>
      </div>
      <pre><code>          **itemReversiona:**
           Vista utilizada para volver a una version anterior del Item.
           Solicita que el usuario que realiza el request
           cuente con los permisos para reversionar y que el
           estado del item sea "en desarrollo"
</code></pre>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-538'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-538'>#</a>
      </div>
      <p>Verificar que el usuario cuente con los permisos necesarios.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-539'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-539'>#</a>
      </div>
      <p>Al no contar con los permisos, niega el acceso, redirigiendo.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-540'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-540'>#</a>
      </div>
      <p>Se podra reversionar el item si este se encuentra en estado de desarrollo</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-541'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-541'>#</a>
      </div>
      <p>Obtiene la version del item seleccionada por el usuario</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-542'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-542'>#</a>
      </div>
      <p>Obtiene el numero de la ultima version para incrementar el contador de versiones</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-543'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-543'>#</a>
      </div>
      <p>Reversiona el item</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-544'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-544'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-545'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-545'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-546'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-546'>#</a>
      </div>
      <p>s3 = boto3.resource(&lsquo;s3&rsquo;,
                  aws_access_key_id=&rsquo;AKIAUWIIW4ARQQQA4TLN&rsquo;,
                 aws_secret_access_key=&rsquo;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&rsquo;)</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-547'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-547'>#</a>
      </div>
      <pre><code>  **cerrarFase:**
    Vista utilizada para cerrar una Fase.
    Solicita que el usuario que realiza el request cuente
    con el permiso para cerrar la fase correspondiente
    y que (indirectamente) haya iniciado sesion
</code></pre>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-548'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-548'>#</a>
      </div>
      <p>Fase que se desea cerrar.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-549'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-549'>#</a>
      </div>
      <p>Proyecto en el cual se encuentra la fase.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-550'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-550'>#</a>
      </div>
      <p>Al no contar con los permisos, niega el acceso, redirigiendo.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-551'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-551'>#</a>
      </div>
      <p>Se obtinen los items que no se encuentren en estado deshabilitado</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-552'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-552'>#</a>
      </div>
      <p>Para aprobar el item es necesario identificar que tenga alguna relacion con un antecesor</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-553'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-553'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-554'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-554'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
</div>
</body>
